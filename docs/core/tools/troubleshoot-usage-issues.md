---
title: Устранение неполадок при использовании средств .NET
description: Ознакомьтесь с распространенными проблемами, возникающими при использовании средств .NET, и возможными решениями.
author: kdollard
ms.topic: troubleshooting
ms.date: 02/14/2020
ms.openlocfilehash: 9cf0320ec5b5d6f317a4ef7f9052c0068b3ad8e5
ms.sourcegitcommit: 42d436ebc2a7ee02fc1848c7742bc7d80e13fc2f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/04/2021
ms.locfileid: "102104093"
---
# <a name="troubleshoot-net-tool-usage-issues"></a>Устранение неполадок при использовании средств .NET

При попытке установить или запустить глобальное или локальное средство .NET могут возникнуть проблемы. В этой статье описываются их типичные первопричины и возможные решения.

## <a name="installed-net-tool-fails-to-run"></a>Установленное средство .NET не запускается

Если средство .NET не запускается, наиболее вероятной причиной является одна из следующих:

* Исполняемый файл средства не найден.
* Не найдена правильная версия среды выполнения .NET.

### <a name="executable-file-not-found"></a>Исполняемый файл не найден

Если исполняемый файл не найден, появляется примерно следующее сообщение.

```console
Could not execute because the specified command or file was not found.
Possible reasons for this include:
  * You misspelled a built-in dotnet command.
  * You intended to execute a .NET program, but dotnet-xyz does not exist.
  * You intended to run a global tool, but a dotnet-prefixed executable with this name could not be found on the PATH.
```

Имя исполняемого файла определяет то, как вызывается средство. Формат описывается в приведенной ниже таблице.

| Формат имени исполняемого файла  | Формат вызова   |
|-------------------------|---------------------|
| `dotnet-<toolName>.exe` | `dotnet <toolName>` |
| `<toolName>.exe`        | `<toolName>`        |

* Глобальные средства

  Глобальные средства можно установить в каталоге по умолчанию или в выбранном вами расположении. Каталоги по умолчанию:

  | Операционная система          | Path                          |
  |-------------|-------------------------------|
  | Linux/macOS | `$HOME/.dotnet/tools`         |
  | Windows     | `%USERPROFILE%\.dotnet\tools` |

  Если вы пытаетесь запустить глобальное средство, убедитесь в том, что переменная среды `PATH` на компьютере содержит путь, по которому установлено глобальное средство, и что исполняемый файл находится по этому пути.

  Интерфейс .NET CLI пытается добавить расположение по умолчанию в переменную среды PATH при первом использовании. Однако есть определенные ситуации, когда расположение не удается добавить в переменную PATH автоматически:

  * используется ОС Linux, и пакет SDK для .NET установлен с помощью файлов *.tar.gz*, а не apt-get или rpm;
  * используется ОС macOS 10.15 "Catalina" или более поздней версии;
  * используется ОС macOS 10.14 "Mojave" или более ранней версии, и пакет SDK для .NET установлен с помощью файлов *.tar.gz*, а не *.pkg*;
  * установлен пакет SDK для .NET Core 3.0, и переменной среды `DOTNET_ADD_GLOBAL_TOOLS_TO_PATH` присвоено значение `false`;
  * установлен пакет SDK для пакет SDK.NET Core 2.2 или более ранней версии, и переменной среды `DOTNET_SKIP_FIRST_TIME_EXPERIENCE` присвоено значение `true`.

  В таких сценариях, а также если указан параметр `--tool-path`, в переменную среды `PATH` на вашем компьютере не будет автоматически добавляться путь, по которому было установлено глобальное средство. В этом случае необходимо добавить в переменную среды `PATH` расположение этого средства (например, `$HOME/.dotnet/tools`) с использованием любого метода обновления переменных среды, предусмотренного в вашей оболочке. Дополнительные сведения см. в разделе о [средствах .NET](global-tools.md).

* Локальные средства

  Если вы пытаетесь запустить локальное средство, убедитесь в наличии файла манифеста с именем *dotnet-tools.json* в текущем каталоге или в любом из его родительских каталогов. Этот файл также может находиться в папке *.config* где угодно в иерархии папок проекта, а не в корневой папке. Если файл *dotnet-tools.json* существует, откройте его и проверьте наличие средства, которое вы пытаетесь запустить. Если в файле нет записи для `"isRoot": true`, также проверьте наличие дополнительных файлов манифестов средств выше в иерархии файлов.

  Если вы пытаетесь запустить средство .NET, которое было установлено по указанному пути, необходимо включить этот путь при использовании средства. Пример средства, установленного по определенному пути:

  ```console
  ..\<toolDirectory>\dotnet-<toolName>
  ```

### <a name="runtime-not-found"></a>Среда выполнения не найдена

Средства .NET — это [приложения, зависящие от платформы](../deploying/index.md#publish-framework-dependent), то есть от среды выполнения .NET, установленной на компьютере. Если ожидаемая среда выполнения не найдена, они следуют обычным правилам наката среды выполнения .NET:

* Накат выполняется к последнему номеру выпуска исправления указанной основной и дополнительной версии.
* Если соответствующая среда выполнения с соответствующими номерами основной и дополнительной версий отсутствует, используется следующий последний дополнительный номер версии.
* Накат не выполняется между предварительными версиями среды выполнения или между предварительной версией и версией выпуска. Таким образом, средства .NET, созданные с помощью предварительных версий, должны быть перестроены и повторно опубликованы автором, а затем переустановлены.

Накат не выполняется по умолчанию в двух распространенных сценариях:

* доступны только более ранние версии среды выполнения; при накате выбираются только более поздние версии среды выполнения;
* доступны только более поздние основные версии среды выполнения. При накате границы основной версии не пересекаются.

Если приложению не удается найти подходящую среду выполнения, оно не запускается и сообщает об ошибке.

Узнать, какие среды выполнения .NET установлены на компьютере, можно с помощью следующих команд:

```dotnetcli
dotnet --list-runtimes
dotnet --info
```

Если вы считаете, что средство должно поддерживать версию среды выполнения, установленную в настоящее время, обратитесь к автору средства и узнайте, может ли он обновить номер версии или перенацелить средство на несколько версий. После того как автор перекомпилирует и повторно опубликует пакет средства в NuGet с обновленным номером версии, вы можете обновить свою копию. Пока же этого не произошло, проще всего установить версию среды выполнения, совместимую со средством, которое вы пытаетесь запустить. Чтобы скачать определенную версию среды выполнения .NET, перейдите на [страницу скачиваемых файлов .NET](https://dotnet.microsoft.com/download/dotnet).

Если пакет SDK для .NET устанавливается в месте, отличном от расположения по умолчанию, необходимо присвоить переменной среды `DOTNET_ROOT` каталог, содержащий исполняемый файл `dotnet`.

## <a name="net-tool-installation-fails"></a>Не удается установить средство .NET

Установка глобального или локального средства .NET может завершиться сбоем по ряду причин. Если при установке средства происходит сбой, появляется примерно следующее сообщение:

```console
Tool '{0}' failed to install. This failure may have been caused by:

* You are attempting to install a preview release and did not use the --version option to specify the version.
* A package by this name was found, but it was not a .NET tool.
* The required NuGet feed cannot be accessed, perhaps because of an Internet connection problem.
* You mistyped the name of the tool.

For more reasons, including package naming enforcement, visit https://aka.ms/failure-installing-tool
```

Помимо предыдущего сообщения, пользователю также выводятся сообщения NuGet, помогающие диагностировать эти сбои. Сообщение NuGet может помочь определить причину проблемы.

### <a name="package-naming-enforcement"></a>Изменение имен пакетов

Корпорация Майкрософт изменила правила в отношении идентификаторов пакетов для средств, из-за чего некоторые средства теперь невозможно найти по прежним именам. Согласно новым правилам имена средств Майкрософт должны иметь префикс "Microsoft.". Этот префикс зарезервирован и может использоваться только для пакетов, подписанных с помощью авторизованного сертификата Майкрософт.

Во время перехода некоторые средства Майкрософт будут иметь старую форму идентификатора пакета, а другие — новую форму:

```dotnetcli
dotnet tool install -g Microsoft.<toolName>
dotnet tool install -g <toolName>
```

По мере обновления идентификаторов пакетов необходимо будет перейти на новый идентификатор, чтобы получить последние обновления. Пакеты с упрощенными именами средств станут нерекомендуемыми.

### <a name="preview-releases"></a>Предварительные выпуски

* Вы пытаетесь установить предварительный выпуск и не использовали параметр `--version` для указания версии.

Если средство .NET находится на стадии предварительной версии, это должно быть указано в части имени. Указывать предварительную версию полностью не нужно. Если номера версий имеют ожидаемый формат, можно использовать нечто подобное:

```dotnetcli
dotnet tool install -g --version 1.1.0-pre <toolName>
```

### <a name="package-isnt-a-net-tool"></a>Пакет не является средством .NET

* Пакет NuGet с таким именем найден, но не является средством .NET.

При попытке установить пакет NuGet, который является обычным пакетом NuGet, а не средством .NET, вы увидите такое сообщение об ошибке:

> NU1212: недопустимое сочетание проекта и пакета для `<ToolName>`. Стиль проекта DotnetToolReference допускает только ссылки типа DotnetTool.

### <a name="nuget-feed-cant-be-accessed"></a>Веб-канал NuGet недоступен

* Не удается получить доступ к требуемому веб-каналу NuGet, возможно, из-за проблемы с подключением к Интернету.

Для установки средства требуется доступ к веб-каналу NuGet, содержащему пакет средства. Установка завершается сбоем, если этот веб-канал недоступен. Вы можете изменить веб-каналы с помощью `nuget.config`, запросить определенный файл `nuget.config` или указать дополнительные веб-каналы с помощью параметра `--add-source`. По умолчанию NuGet выдает ошибку для каждого веб-канала, к которому не удается подключиться. Флаг `--ignore-failed-sources` позволяет пропускать недоступные источники.

### <a name="package-id-incorrect"></a>Неправильный идентификатор пакета

* Вы неправильно ввели имя средства.

Распространенной причиной ошибок является неправильное имя средства. Такое может случаться из-за ошибок при вводе или из-за того, что средство было перемещено либо устарело. Если средство размещено на сайте NuGet.org, один из способов гарантировать правильность имени — выполнить поиск средства на сайте NuGet.org и скопировать команду установки.

## <a name="see-also"></a>См. также

* [Средства .NET](global-tools.md)
