---
description: 'Дополнительные сведения: оператор Const (Visual Basic)'
title: Оператор Const
ms.date: 05/12/2018
f1_keywords:
- vb.Const
helpviewer_keywords:
- Const statement [Visual Basic]
ms.assetid: 495b318d-b7c5-4198-94f8-0790a541b07a
ms.openlocfilehash: 61d898823c7697c91b207a502417b49cdeaf5eea
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/06/2021
ms.locfileid: "99673860"
---
# <a name="const-statement-visual-basic"></a>Оператор Const (Visual Basic)

Объявляет и определяет одну или несколько констант.

## <a name="syntax"></a>Синтаксис

```vb
[ <attributelist> ] [ accessmodifier ] [ Shadows ]
Const constantlist
```

## <a name="parts"></a>Компоненты

`attributelist`  
Необязательный элемент. Список атрибутов, которые применяются ко всем константам, объявленным в этой инструкции. См. [список атрибутов](attribute-list.md) в угловых скобках (" `<` " и " `>` ").

`accessmodifier`  
Необязательный элемент. Используйте его, чтобы указать, какой код может получить доступ к этим константам. Может быть [общедоступным](../modifiers/public.md), [защищенным](../modifiers/protected.md), [дружественным](../modifiers/friend.md), [защищенным дружественным](../modifiers/protected-friend.md), [частным](../modifiers/private.md)или [частным](../modifiers/private-protected.md).

`Shadows`  
Необязательный элемент. Используйте его для повторного объявления и скрытия программного элемента в базовом классе. См. раздел [Shadows](../modifiers/shadows.md).

`constantlist`  
Обязательный элемент. Список констант, объявляемых в этой инструкции.

`constant` `[ ,` `constant` `... ]`

Каждый элемент `constant` имеет перечисленные ниже синтаксис и компоненты.

`constantname` `[ As` `datatype` `] =` `initializer`

|Отделение|Описание|
|----------|-----------------|
|`constantname`|Обязательный элемент. Имя константы. См. раздел [Declared Element Names](../../programming-guide/language-features/declared-elements/declared-element-names.md).|
|`datatype`|Обязательный `Option Strict` , если имеет значение `On` . Тип данных константы.|
|`initializer`|Обязательный элемент. Выражение, которое вычисляется во время компиляции и присваивается константе.|

## <a name="remarks"></a>Remarks

Если у вас есть значение, которое никогда не изменяется в приложении, можно определить именованную константу и использовать ее вместо литерального значения. Имя проще запомнить, чем значение. Вы можете определить константу только один раз и использовать ее во многих местах кода. Если в более поздней версии необходимо переопределить значение, то единственным местом, которое необходимо `Const` внести в изменение, является только инструкция.

Можно использовать `Const` только на уровне модуля или процедуры. Это означает, что *контекст объявления* для переменной должен быть классом, структурой, модулем, процедурой или блоком и не может быть исходным файлом, пространством имен или интерфейсом. Дополнительные сведения см. в разделе [Контексты объявления и уровни доступа по умолчанию](declaration-contexts-and-default-access-levels.md).

Локальные константы (внутри процедуры) по умолчанию имеют открытый доступ, и в них нельзя использовать какие-либо модификаторы доступа. Константы класса и члена модуля (вне любой процедуры) по умолчанию имеют частный доступ, а константы членов структуры по умолчанию имеют открытый доступ. Уровни доступа можно изменить с помощью модификаторов доступа.

## <a name="rules"></a>Правила

- **Контекст объявления.** Константа, объявленная на уровне модуля вне любой процедуры, является *константой-членом*; Он является членом класса, структуры или модуля, объявляющего его.

  Константа, объявленная на уровне процедуры, является *локальной константой*; Он является локальным для процедуры или блока, объявляющего ее.

- **Атрибута.** Атрибуты можно применять только к константам членов, а не к локальным константам. Атрибут вносит сведения в метаданные сборки, что не имеет смысла для временного хранения, например локальных констант.

- **Модификаторы.** По умолчанию все константы имеют значение `Shared` , `Static` и `ReadOnly` . При объявлении константы нельзя использовать какие-либо из этих ключевых слов.

  На уровне процедуры нельзя использовать `Shadows` модификаторы доступа или для объявления локальных констант.

- **Несколько констант.** Можно объявить несколько констант в одном операторе объявления, указав `constantname` часть для каждого из них. Несколько констант разделяются запятыми.

## <a name="data-type-rules"></a>Правила типов данных

- **Типы данных.** `Const`Оператор может объявлять тип данных переменной. Можно указать любой тип данных или имя перечисления.

- **Тип по умолчанию.** Если не указать `datatype` , константа принимает тип данных `initializer` . Если заданы оба параметра `datatype` и `initializer` , тип данных `initializer` должен быть преобразован в `datatype` . Если оба `datatype` `initializer` параметра и не указаны, по умолчанию используется тип данных `Object` .

- **Различные типы.** Можно указать различные типы данных для разных констант, используя отдельное `As` предложение для каждой объявляемой переменной. Однако нельзя объявить несколько констант, имеющих один и тот же тип, с помощью общего `As` предложения.

- **Инициализации.** Необходимо инициализировать значение каждой константы в `constantlist` . Используется `initializer` для предоставления выражения, присваиваемого константе. Выражение может быть любым сочетанием литералов, других уже определенных констант и уже определенных элементов перечисления. Для объединения таких элементов можно использовать арифметические и логические операторы.

  В нельзя использовать переменные или функции `initializer` . Однако можно использовать ключевые слова преобразования, такие как `CByte` и `CShort` . Можно также использовать `AscW` , если вы вызываете его с константой `String` или `Char` аргументом, так как это может быть вычислено во время компиляции.

## <a name="behavior"></a>Поведение

- **Которых.** Локальные константы доступны только в пределах их процедуры или блока. Константы членов доступны из любого места в своем классе, структуре или модуле.

- **Квалификацию.** Код за пределами класса, структуры или модуля должен уточнять имя константы-члена именем этого класса, структуры или модуля. Код за пределами процедуры или блока не может ссылаться на любые локальные константы в этой процедуре или блоке.

## <a name="example"></a>Пример

В следующем примере оператор используется `Const` для объявления констант для использования вместо литеральных значений.

[!code-vb[VbVbalrStatements#13](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/Class1.vb#13)]

## <a name="example"></a>Пример

При определении константы с типом данных `Object` компилятор Visual Basic присваивает ему тип `initializer` , а не `Object` . В следующем примере константа `naturalLogBase` имеет тип времени выполнения `Decimal` .

[!code-vb[VbVbalrStatements#87](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/Class1.vb#87)]

В предыдущем примере метод используется <xref:System.Type.ToString%2A> для <xref:System.Type> объекта, возвращаемого [оператором GetType](../operators/gettype-operator.md), поскольку <xref:System.Type> не может быть преобразован в `String` using `CStr` .

## <a name="see-also"></a>См. также

- <xref:Microsoft.VisualBasic.Strings.Asc%2A>
- <xref:Microsoft.VisualBasic.Strings.AscW%2A>
- [Оператор Enum](enum-statement.md)
- [Директива #Const](../directives/const-directive.md)
- [Оператор Dim](dim-statement.md)
- [Оператор reDim](redim-statement.md)
- [Явные и неявные преобразования](../../programming-guide/language-features/data-types/implicit-and-explicit-conversions.md)
- [Константы и перечисления](../../programming-guide/language-features/constants-enums/index.md)
- [Константы и перечисления](../constants-and-enumerations.md)
- [Type Conversion Functions](../functions/type-conversion-functions.md)
