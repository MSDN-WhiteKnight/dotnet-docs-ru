---
description: Дополнительные сведения о операторе Delegate
title: Оператор Delegate
ms.date: 07/20/2015
f1_keywords:
- vb.Delegate
helpviewer_keywords:
- delegate keyword [Visual Basic]
- Delegate statement [Visual Basic]
ms.assetid: f799c518-0817-40cc-ad0b-4da846fdba57
ms.openlocfilehash: 3fbf3d7b47b465fd0850f01170e02b19b7b93b4e
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/06/2021
ms.locfileid: "99673821"
---
# <a name="delegate-statement"></a>Оператор Delegate

Используется для объявления делегата. Делегат — это ссылочный тип, который ссылается на `Shared` метод типа или на метод экземпляра объекта. Для создания экземпляра этого класса делегата можно использовать любую процедуру с соответствующими параметрами и типами возвращаемых данных. Затем процедуру можно вызвать позже с помощью экземпляра делегата.  
  
## <a name="syntax"></a>Синтаксис  
  
```vb  
[ <attrlist> ] [ accessmodifier ] _  
[ Shadows ] Delegate [ Sub | Function ] name [( Of typeparamlist )] [([ parameterlist ])] [ As type ]  
```  
  
## <a name="parts"></a>Компоненты  
  
|Термин|Определение|  
|---|---|  
|`attrlist`|Необязательный элемент. Список атрибутов, применяемых к этому делегату. Несколько атрибутов разделяются запятыми. [Список атрибутов](attribute-list.md) необходимо заключить в угловые скобки (" `<` " и " `>` ").|  
|`accessmodifier`|Необязательный элемент. Указывает, какой код может получить доступ к делегату. Может принимать следующие значения:<br /><br /> - [Общедоступная](../modifiers/public.md). Любой код, который может получить доступ к элементу, который объявляет делегат, может получить к нему доступ.<br />-   [Защищено](../modifiers/protected.md). Доступ к нему могут получить только код внутри класса делегата или производного класса.<br />-   [Дружественный](../modifiers/friend.md). Доступ к делегату могут получить только код в той же сборке.<br />- [Частный](../modifiers/private.md). Только код внутри элемента, объявляющего делегат, может получить к нему доступ.<br /><br /> - [Защищенный дружественный](../modifiers/protected-friend.md) Доступ к делегату могут получить только код внутри класса делегата, производного класса или той же сборки. <br />- [Частный защищенный](../modifiers/private-protected.md) Доступ к делегату могут получить только код внутри класса делегата или в производном классе в той же сборке. |  
|`Shadows`|Необязательный элемент. Указывает, что этот делегат повторно объявляет и скрывает идентично именованный элемент программирования или набор перегруженных элементов в базовом классе. Можно скрыть любой тип объявленного элемента, используя любой другой тип.<br /><br /> Скрытый элемент недоступен из производного класса, который его скрывает, за исключением тех классов, из которых недоступен скрывающий элемент. Например, если `Private` элемент затеняет элемент базового класса, код, который не имеет разрешения на доступ к `Private` элементу, обращается к элементу базового класса.|  
|`Sub`|Необязательный, `Sub` но `Function` должен быть либо. Объявляет эту процедуру как процедуру-делегат `Sub` , которая не возвращает значение.|  
|`Function`|Необязательный, `Sub` но `Function` должен быть либо. Объявляет эту процедуру как процедуру-делегат `Function` , которая возвращает значение.|  
|`name`|Обязательный элемент. Имя типа делегата; соответствует стандартным соглашениям об именовании переменных.|  
|`typeparamlist`|Необязательный элемент. Список параметров типа для этого делегата. Несколько параметров типа разделяются запятыми. При необходимости каждый параметр типа можно объявить как Variant с помощью `In` `Out` модификаторов и. Необходимо заключить [список типов](type-list.md) в круглые скобки и ввести его с помощью `Of` ключевого слова.|  
|`parameterlist`|Необязательный элемент. Список параметров, которые передаются в процедуру при ее вызове. [Список параметров](parameter-list.md) необходимо заключить в круглые скобки.|  
|`type`|Требуется, если указана `Function` процедура. Тип данных возвращаемого значения.|  
  
## <a name="remarks"></a>Remarks  

 `Delegate`Оператор определяет параметры и возвращаемые типы класса делегата. Для создания экземпляра этого класса делегата можно использовать любую процедуру с соответствующими параметрами и типами возвращаемых данных. Затем процедуру можно вызвать с помощью экземпляра делегата, вызвав метод делегата `Invoke` .  
  
 Делегаты могут быть объявлены на уровне пространства имен, модуля, класса или структуры, но не внутри процедуры.  
  
 Каждый класс делегата определяет конструктор, которому передается спецификация метода объекта. Аргумент конструктора делегата должен быть ссылкой на метод или лямбда-выражение.  
  
 Чтобы указать ссылку на метод, используйте следующий синтаксис:  
  
 `AddressOf` [`expression`.]`methodname`  
  
 Тип `expression` во время компиляции должен представлять собой имя класса или интерфейса, который содержит метод с указанным именем, сигнатура которого соответствует сигнатуре класса делегата. `methodname` должен быть общим методом или методом экземпляра. `methodname` всегда является обязательным, даже если делегат создается для метода по умолчанию в классе.  
  
 Чтобы указать лямбда-выражение, используйте следующий синтаксис:  
  
 `Function` ([`parm` As `type`, `parm2` As `type2`, ...]) `expression`  
  
 Сигнатура функции должна соответствовать сигнатуре типа делегата. Дополнительные сведения о лямбда-выражениях см. в разделе [лямбда-выражения](../../programming-guide/language-features/procedures/lambda-expressions.md).  
  
 и [делегатах](../../programming-guide/language-features/delegates/index.md).  
  
## <a name="example"></a>Пример  

 В следующем примере оператор используется `Delegate` для объявления делегата для работы с двумя числами и возвращения числа. `DelegateTest`Метод принимает экземпляр делегата этого типа и использует его для работы с парами чисел.  
  
 [!code-vb[VbVbalrDelegates#14](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDelegates/VB/Class1.vb#14)]  
  
## <a name="see-also"></a>См. также

- [Оператор AddressOf](../operators/addressof-operator.md)
- [Окна](of-clause.md)
- [Делегаты](../../programming-guide/language-features/delegates/index.md)
- [Практическое руководство. Использование универсального класса](../../programming-guide/language-features/data-types/how-to-use-a-generic-class.md)
- [Generic Types in Visual Basic](../../programming-guide/language-features/data-types/generic-types.md)
- [Ковариация и контрвариантность](../../programming-guide/concepts/covariance-contravariance/index.md)
- [Где](../modifiers/in-generic-modifier.md)
- [Out](../modifiers/out-generic-modifier.md)
