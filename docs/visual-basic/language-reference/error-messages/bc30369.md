---
description: 'Дополнительные сведения о: BC30369: не может ссылаться на член экземпляра класса из общего метода или общего инициализатора члена без явного указания экземпляра класса'
title: Не удается обратиться к члену экземпляра класса из совместно используемого метода или совместно используемого инициализатора без явного указания экземпляра этого класса
ms.date: 07/20/2015
f1_keywords:
- vbc30369
- bc30369
helpviewer_keywords:
- Shared
- BC30369
ms.assetid: 39d9466b-c1f3-4406-91a5-3d6c52d23a3d
ms.openlocfilehash: 7fd7f15f3d7e8c05609618411a3ce390800cced2
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/06/2021
ms.locfileid: "99797007"
---
# <a name="bc30369-cannot-refer-to-an-instance-member-of-a-class-from-within-a-shared-method-or-shared-member-initializer-without-an-explicit-instance-of-the-class"></a>BC30369: не может ссылаться на член экземпляра класса из общего метода или общего инициализатора члена без явного указания экземпляра класса

Предпринята попытка ссылки на член класса, не являющийся общим, в рамках общей процедуры. В следующем примере демонстрируется такая ситуация:

```vb
Class Sample
    Public x as Integer
    Public Shared Sub SetX()
        x = 10
    End Sub
End Class
```

 В предыдущем примере оператор присваивания `x = 10` выдает это сообщение об ошибке. Это связано с тем, что общая процедура пытается получить доступ к переменной экземпляра.

 Переменная `x` является членом экземпляра, так как она не объявлена как [Shared](../modifiers/shared.md). Каждый экземпляр класса `Sample` содержит собственную отдельную переменную `x` . Когда один экземпляр задает или изменяет значение `x` , он не влияет на значение `x` в любом другом экземпляре.

 Однако процедура `SetX` относится `Shared` ко всем экземплярам класса `Sample` . Это означает, что он не связан с каким-либо экземпляром класса, а работает независимо от отдельных экземпляров. Так как он не имеет соединения с определенным экземпляром, `setX` не может получить доступ к переменной экземпляра. Он должен обрабатывать только `Shared` переменные. Если `SetX` задает или изменяет значение общей переменной, новое значение доступно для всех экземпляров класса.

 **Идентификатор ошибки:** BC30369

## <a name="to-correct-this-error"></a>Исправление ошибки

1. Решите, должен ли элемент быть общим для всех экземпляров класса или сохранен отдельно для каждого экземпляра.

2. Если необходимо, чтобы одна копия члена была общей для всех экземпляров, добавьте `Shared` ключевое слово в объявление члена. Оставьте `Shared` ключевое слово в объявлении процедуры.

3. Если требуется, чтобы каждый экземпляр имел собственную отдельную копию элемента, не указывайте `Shared` для объявления члена. Удалите `Shared` ключевое слово из объявления процедуры.

## <a name="see-also"></a>См. также

- [Общий](../modifiers/shared.md)
