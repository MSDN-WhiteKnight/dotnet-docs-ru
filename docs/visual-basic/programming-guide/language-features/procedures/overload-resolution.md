---
description: Дополнительные сведения см. в статье разрешение перегрузки (Visual Basic).
title: Overload Resolution
ms.date: 07/20/2015
helpviewer_keywords:
- Visual Basic code, procedures
- overload resolution
- procedures [Visual Basic], overloading
- procedures [Visual Basic], calling
- procedure overloading [Visual Basic], overload resolution
- signatures [Visual Basic], procedure
- overloads [Visual Basic], resolution
ms.assetid: 766115d1-4352-45fb-859f-6063e0de0ec0
ms.openlocfilehash: 71375083e661ee156339abf13e1a5b8da21b9358
ms.sourcegitcommit: 10e719780594efc781b15295e499c66f316068b8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/14/2021
ms.locfileid: "100480041"
---
# <a name="overload-resolution-visual-basic"></a>Разрешение перегрузки (Visual Basic)

Когда компилятор Visual Basic встречает вызов процедуры, определенной в нескольких перегруженных версиях, компилятор должен решить, какую из перегруженных версий вызывать. Это достигается путем выполнения следующих действий.  
  
1. **Специальные возможности.** Он устраняет все перегрузки с уровнем доступа, который не позволяет вызывающему коду вызывать его.  
  
2. **Число параметров.** Он исключает все перегрузки, которые определяют разное количество параметров, чем указано в вызове.  
  
3. **Типы данных параметров.** Компилятор передает предпочтение методам экземпляра по методам расширения. Если найден любой метод экземпляра, требующий только расширяющего преобразования для сопоставления с вызовом процедуры, все методы расширения удаляются, а компилятор переходит только к методам экземпляра. Если такой метод экземпляра не найден, он продолжится как для экземпляра, так и для методов расширения.  
  
     На этом шаге удаляется любая перегрузка, для которой типы данных вызывающих аргументов не могут быть преобразованы в типы параметров, определенные в перегрузке.  
  
4. **Сужающие преобразования.** Он устраняет все перегрузки, требующие сужения преобразования из типов вызывающих аргументов в определенные типы параметров. Это верно, если параметр проверки типа ([оператор Option строго](../../../language-reference/statements/option-strict-statement.md)) имеет значение `On` или `Off` .  
  
5. **Минимальное расширение.** Компилятор рассматривает оставшиеся перегрузки парами. Для каждой пары он сравнивает типы данных определенных параметров. Если типы в одной из перегрузок расширены до соответствующих типов в другом, компилятор исключает второй. То есть он удерживает перегрузку, для которой требуется наименьший размер расширения.  
  
6. **Один кандидат.** Он продолжает рассматривать перегрузки парами до тех пор, пока не останется только одна перегрузка и разрешается вызов этой перегрузки. Если компилятор не может уменьшить перегрузки для одного кандидата, возникает ошибка.  
  
 На следующем рисунке показан процесс, который определяет, какой из наборов перегруженных версий необходимо вызвать.  
  
 ![Схема потока перегруженного процесса разрешения](./media/overload-resolution/determine-overloaded-version.gif "Разрешение между перегруженными версиями")
  
 В следующем примере показан этот процесс разрешения перегрузки.  
  
 [!code-vb[VbVbcnProcedures#62](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#62)]  
  
 [!code-vb[VbVbcnProcedures#63](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#63)]  
  
 При первом вызове компилятор устраняет первую перегрузку, поскольку тип первого аргумента ( `Short` ) ограничивается типом соответствующего параметра ( `Byte` ). Затем он исключает третью перегрузку, так как каждый тип аргумента во второй перегрузке ( `Short` и `Single` ) расширяется до соответствующего типа в третьей перегрузке ( `Integer` и `Single` ). Вторая перегрузка требует меньшего расширения, поэтому компилятор использует его для вызова.  
  
 Во втором вызове компилятор не может исключить ни одну из перегрузок на основе понижающие. Он исключает третью перегрузку по той же причине, что и при первом вызове, так как она может вызвать вторую перегрузку с меньшим расширением типов аргументов. Однако компилятор не может выполнить разрешение между первой и второй перегрузками. Каждый из них имеет один определенный тип параметра, который расширяется до соответствующего типа в другом ( `Byte` в `Short` , но `Single` до `Double` ). Поэтому компилятор создает ошибку разрешения перегрузки.  
  
## <a name="overloaded-optional-and-paramarray-arguments"></a>Перегруженные аргументы необязательных аргументов и ParamArray  

 Если две перегрузки процедуры имеют идентичные сигнатуры, за исключением того, что последний параметр объявлен как [Optional](../../../language-reference/modifiers/optional.md) в одном и [ParamArray](../../../language-reference/modifiers/paramarray.md) в другой, компилятор разрешает вызов этой процедуры следующим образом:  
  
|Если вызов предоставляет последний аргумент как|Компилятор разрешает вызов перегрузки, объявляя последний аргумент как|  
|---|---|  
|Значение отсутствует (аргумент опущен)|`Optional`|  
|Одно значение|`Optional`|  
|Два или более значений в списке с разделителями-запятыми|`ParamArray`|  
|Массив любой длины (включая пустой массив)|`ParamArray`|  
  
## <a name="see-also"></a>См. также раздел

- [Необязательные параметры](./optional-parameters.md)
- [Массивы параметров](./parameter-arrays.md)
- [Перегрузка процедур](./procedure-overloading.md)
- [Рекомендации по устранению неполадок](./troubleshooting-procedures.md)
- [Практическое руководство. Определение различных версий процедуры](./how-to-define-multiple-versions-of-a-procedure.md)
- [Практическое руководство. Вызов перегруженной процедуры](./how-to-call-an-overloaded-procedure.md)
- [Практическое руководство. Перегрузка процедуры, которая принимает необязательные параметры](./how-to-overload-a-procedure-that-takes-optional-parameters.md)
- [Практическое руководство. Перегрузка процедуры, принимающей неопределенное число параметров](./how-to-overload-a-procedure-that-takes-an-indefinite-number-of-parameters.md)
- [Вопросы, связанные с перегрузкой процедур](./considerations-in-overloading-procedures.md)
- [Перегрузки](../../../language-reference/modifiers/overloads.md)
- [Методы расширения](./extension-methods.md)
