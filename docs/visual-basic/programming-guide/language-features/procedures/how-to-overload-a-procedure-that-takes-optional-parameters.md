---
description: Дополнительные сведения см. в разделе как перегрузить процедуру, принимающую необязательные параметры (Visual Basic).
title: Практическое руководство. Перегрузка процедуры, которая принимает необязательные параметры
ms.date: 07/20/2015
helpviewer_keywords:
- procedures [Visual Basic], parameters
- procedure overloading [Visual Basic], optional parameters
- procedures [Visual Basic], defining
- Visual Basic code, procedures
- procedure parameters
- procedures [Visual Basic], overloading
- procedures [Visual Basic], multiple versions
ms.assetid: 825f9d56-4cde-43fd-993a-b9171717e2eb
ms.openlocfilehash: dccef9d27c08ede2f35edc02c8bd5116aa6969b2
ms.sourcegitcommit: 10e719780594efc781b15295e499c66f316068b8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/14/2021
ms.locfileid: "100472947"
---
# <a name="how-to-overload-a-procedure-that-takes-optional-parameters-visual-basic"></a>Практическое руководство. Перегрузка процедуры, которая принимает один необязательный параметр (Visual Basic)

Если процедура имеет один или несколько [необязательных](../../../language-reference/modifiers/optional.md) параметров, нельзя определить перегруженную версию, соответствующую любой из ее неявных перегрузок. Дополнительные сведения см. в разделе "Неявные перегрузки для необязательных параметров" раздела [рекомендации по перегрузке процедур](./considerations-in-overloading-procedures.md).  
  
## <a name="one-optional-parameter"></a>Один необязательный параметр  
  
#### <a name="to-overload-a-procedure-that-takes-one-optional-parameter"></a>Перегрузка процедуры, принимающей один необязательный параметр  
  
1. Напишите `Sub` `Function` оператор объявления или, который содержит необязательный параметр в списке параметров. Не используйте `Optional` в этой перегруженной версии ключевое слово.  
  
2. Перед `Sub` `Function` ключевым словом или зарезервированным словом [Overloads](../../../language-reference/modifiers/overloads.md) .  
  
3. Напишите код процедуры, который должен выполняться, когда вызывающий код предоставляет необязательный аргумент.  
  
4. При необходимости завершите процедуру `End Sub` `End Function` оператором или.  
  
5. Напишите второй оператор объявления, идентичный первому объявлению, за исключением того, что он не включает необязательный параметр в список параметров.  
  
6. Напишите код процедуры, который должен выполняться, когда вызывающий код не предоставляет необязательный аргумент. При необходимости завершите процедуру `End Sub` `End Function` оператором или.  
  
     В следующем примере показана процедура, определенная с необязательным параметром, эквивалентным набором двух перегруженных процедур, и, наконец, примеры как недопустимых, так и допустимых перегруженных версий.  
  
     [!code-vb[VbVbcnProcedures#59](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#59)]  
  
     [!code-vb[VbVbcnProcedures#60](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#60)]  
  
     [!code-vb[VbVbcnProcedures#61](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnProcedures/VB/Class1.vb#61)]  
  
## <a name="multiple-optional-parameters"></a>Несколько необязательных параметров  

 Для процедуры с более чем одним необязательным параметром обычно требуется более двух перегруженных версий. Например, если имеется два необязательных параметра, и вызывающий код может указать или опустить каждый из них независимо друг от друга, необходимы четыре перегруженных версии, по одной для каждого возможного сочетания указанных аргументов.  
  
 По мере увеличения числа необязательных параметров увеличивается сложность перегрузки. Если некоторые сочетания передаваемых аргументов неприемлемы, для N необязательных параметров требуется 2 ^ N перегруженных версий. В зависимости от характера процедуры, возможно, вы обнаружите, что четко логика позволяет определить все перегруженные версии.  
  
#### <a name="to-overload-a-procedure-that-takes-more-than-one-optional-parameter"></a>Перегрузка процедуры, принимающей более одного необязательного параметра  
  
1. Определите, какие сочетания предоставляемых необязательных аргументов приемлемы для логики процедуры. Неприемлемое сочетание может возникнуть, если один необязательный параметр зависит от другого. Например, если один из параметров принимает имя человека, а другой принимает его возраст, сочетание аргументов, которые указывают возраст, но пропускают имя, неприемлемо.  
  
2. Для каждого допустимого сочетания указанных необязательных аргументов напишите `Sub` `Function` оператор объявления или, определяющий соответствующий список параметров. Не используйте `Optional` ключевое слово.  
  
3. В каждом объявлении перед `Sub` `Function` ключевым словом или зарезервированным словом [Overloads](../../../language-reference/modifiers/overloads.md) .  
  
4. После каждого объявления напишите код процедуры, который должен выполняться, когда вызывающий код предоставляет список аргументов, соответствующий списку параметров этого объявления.  
  
5. При необходимости Завершите каждую `End Sub` процедуру `End Function` оператором или.  
  
## <a name="see-also"></a>См. также раздел

- [Процедуры](./index.md)
- [Параметры и аргументы процедуры](./procedure-parameters-and-arguments.md)
- [Необязательные параметры](./optional-parameters.md)
- [Массивы параметров](./parameter-arrays.md)
- [Перегрузка процедур](./procedure-overloading.md)
- [Рекомендации по устранению неполадок](./troubleshooting-procedures.md)
- [Практическое руководство. Определение различных версий процедуры](./how-to-define-multiple-versions-of-a-procedure.md)
- [Практическое руководство. Вызов перегруженной процедуры](./how-to-call-an-overloaded-procedure.md)
- [Практическое руководство. Перегрузка процедуры, принимающей неопределенное число параметров](./how-to-overload-a-procedure-that-takes-an-indefinite-number-of-parameters.md)
- [Overload Resolution](./overload-resolution.md)
