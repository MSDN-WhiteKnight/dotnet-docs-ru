---
description: 'Дополнительные сведения: события (Visual Basic)'
title: События
ms.date: 07/20/2015
helpviewer_keywords:
- events [Visual Basic], about events
- events [Visual Basic]
ms.assetid: 8fb0353a-e41b-4e23-b78f-da65db832f70
ms.openlocfilehash: 6cd4a4b997ec13b394cae38e9d66c7dd9c283aaf
ms.sourcegitcommit: 10e719780594efc781b15295e499c66f316068b8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/14/2021
ms.locfileid: "100483681"
---
# <a name="events-visual-basic"></a>События (Visual Basic)

Хотя вы можете визуализировать проект Visual Studio как последовательность процедур, выполняемых в последовательности, на самом деле большинство программ управляются событиями, то есть поток выполнения определяется внешними *событиями*, которые называются событием.  
  
 Событие — это сигнал, который сообщает приложению, что произошло нечто важное. Например, когда пользователь щелкает элемент управления на форме, эта форма инициирует событие `Click` и вызывает процедуру обработки события. События позволяют отдельным задачам взаимодействовать друг с другом. Давайте представим, что приложение выполняет задачу по сортировке в отдельном процессе. Если пользователь отменит эту сортировку, приложение отправит событие отмены, по которому процесс сортировки завершит свою работу.  
  
## <a name="event-terms-and-concepts"></a>Термины и основные понятия для событий  

 В этом разделе описываются термины и понятия, используемые для событий в Visual Basic.  
  
### <a name="declaring-events"></a>Объявление событий  

 События объявляются внутри классов, структур, модулей и интерфейсов с помощью ключевого слова `Event`, как показано в следующем примере:  
  
 [!code-vb[VbVbalrEvents#24](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrEvents/VB/Class1.vb#24)]  
  
### <a name="raising-events"></a>Вызов событий  

 Событие действует как сообщение о том, что произошло нечто важное. Рассылка такого сообщения называется *созданием* события. В Visual Basic события инициируются с помощью `RaiseEvent` инструкции, как показано в следующем примере:  
  
 [!code-vb[VbVbalrEvents#25](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrEvents/VB/Class1.vb#25)]  
  
 События должны создаваться в пределах области действия класса, модуля или структуры, в которых они объявлены. Например, производный класс не может создавать события, унаследованные от базового класса.  
  
### <a name="event-senders"></a>Отправители событий  

 Любой объект, способный создать событие, считается *отправителем события* или *источником события*. Например, отправителями событий могут являться формы, элементы управления и пользовательские объекты.  
  
### <a name="event-handlers"></a>Обработчики событий  

 *Обработчики событий* — это процедуры, вызываемые при создании определенного события. В качестве обработчика событий можно использовать любую допустимую подпрограмму с подходящей сигнатурой. Но в качестве обработчика событий нельзя использовать функцию, поскольку она не может возвращать значение источнику события.  
  
 Visual Basic использует стандартное соглашение об именовании для обработчиков событий, объединяющее имя отправителя события, символ подчеркивания и имя события. Например, событие `Click` для кнопки с именем `button1` будет называться `Sub button1_Click`.  
  
> [!NOTE]
> Мы рекомендуем придерживаться этого соглашения об именовании при создании обработчиков событий и для пользовательских событий. Но это не обязательное условие, вы можете использовать любое допустимое имя процедуры.  
  
## <a name="associating-events-with-event-handlers"></a>Связывание событий с обработчиками событий  

 Чтобы обработчик событий мог выполнять свою функцию, его следует связать с соответствующим событием с помощью инструкции `Handles` или `AddHandler`.  
  
### <a name="withevents-and-the-handles-clause"></a>Оператор WithEvents и предложение Handles  

 Инструкция `WithEvents` и предложение `Handles` предоставляют декларативный способ указания обработчиков событий. Если объект объявлен с ключевым словом `WithEvents`, созданные им события могут обрабатываться любой процедурой с инструкцией `Handles` для этого события, как показано в следующем примере:  
  
 [!code-vb[VbVbalrEvents#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrEvents/VB/Class1.vb#1)]  
  
 Инструкция `WithEvents` и предложение `Handles` часто являются наилучшим решением для обработки событий, так как декларативный синтаксис позволяет легко создавать, читать и отлаживать код программы. Но использование переменных `WithEvents` имеет ряд ограничений.  
  
- Нельзя использовать переменную `WithEvents` в качестве переменной объекта. То есть вы не можете объявить ее как `Object`. При объявлении переменной необходимо указать имя класса.  
  
- Так как общие события не привязаны к экземплярам класса, нельзя использовать `WithEvents` для декларативной обработки общих событий. Аналогично, нельзя использовать `WithEvents` или `Handles` для обработки событий от `Structure`. В обоих случаях для обработки таких событий можно использовать инструкцию `AddHandler`.  
  
- Вы не можете создавать массивы переменных типа `WithEvents`.  
  
 Переменные `WithEvents` позволяют одному обработчику событий обрабатывать один или несколько видов событий. Также можно создать несколько обработчиков для одного вида событий.  
  
 Предложение `Handles` является стандартным способом связывания события с обработчиком событий, но оно ограничено тем, что может связывать события с обработчиками событий только во время компиляции.  
  
 В некоторых случаях, например с событиями, связанными с формами или элементами управления, Visual Basic автоматически задействует пустой обработчик событий и связывает его с событием. Например, если дважды щелкнуть кнопку команды в форме в режиме конструктора, Visual Basic создает пустой обработчик событий и `WithEvents` переменную для кнопки Command, как показано в следующем коде:  
  
 [!code-vb[VbVbalrEvents#26](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrEvents/VB/Class1.vb#26)]  
  
### <a name="addhandler-and-removehandler"></a>AddHandler и RemoveHandler  

 Инструкция `AddHandler` похожа на предложение `Handles`, поскольку тоже позволяет задавать обработчик событий. Но `AddHandler` в сочетании с `RemoveHandler` обеспечивает большую гибкость, чем предложение `Handles`. Она позволяет динамически добавлять, удалять и изменять обработчики событий, связанные с событием. Если вы хотите обрабатывать общие события или события от структуры, необходимо использовать `AddHandler`.  
  
 `AddHandler` принимает два аргумента: имя события, которое предоставляет отправитель события, например элемент управления, и выражение, определяющее делегат. Класс делегата при использовании `AddHandler` не обязательно указывать явно, поскольку инструкция `AddressOf` всегда возвращает ссылку на делегат. Следующий пример связывает обработчик событий с событием, создаваемым объектом:  
  
 [!code-vb[VbVbalrEvents#28](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrEvents/VB/Class1.vb#28)]  
  
 Инструкция `RemoveHandler`, которая отсоединяет событие от обработчика событий, использует такой же синтаксис, как `AddHandler`. Пример:  
  
 [!code-vb[VbVbalrEvents#29](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrEvents/VB/Class1.vb#29)]  
  
 В следующем примере обработчик событий связывается с событием, а затем создается событие. Обработчик событий перехватывает это событие и выводит сообщение.  
  
 Затем первый обработчик событий удаляется, а с этим событием связывается другой обработчик событий. Теперь событие создается снова и отображается другое сообщение.  
  
 Наконец, второй обработчик событий удаляется и событие создается в третий раз. Поскольку теперь нет обработчиков событий, связанных с этим событием, никакие действия не выполняются.  
  
 [!code-vb[VbVbalrEvents#38](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrEvents/VB/Class2.vb#38)]  
  
## <a name="handling-events-inherited-from-a-base-class"></a>Обработка событий, наследуемых от базового класса  

 *Производные классы*, которые наследуют характеристики из базового класса, могут обрабатывать события, создаваемые этим базовым классом, используя инструкцию `Handles MyBase`.  
  
### <a name="to-handle-events-from-a-base-class"></a>Обработка событий из базового класса  
  
- Объявите обработчик событий в производном классе, добавив инструкцию `Handles MyBase.`*eventname* в строку объявления процедуры обработчика событий, где *eventname* — это имя события в базовом классе, которое вы хотите обрабатывать. Пример:  
  
     [!code-vb[VbVbalrEvents#12](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrEvents/VB/Class1.vb#12)]  
  
## <a name="related-sections"></a>Связанные разделы  
  
|Заголовок|Описание|  
|-----------|-----------------|  
|[Пошаговое руководство. Объявление и вызов событий](walkthrough-declaring-and-raising-events.md)|Предоставляет пошаговую инструкцию для объявления и создания событий класса.|  
|[Пошаговое руководство. Обработка событий](walkthrough-handling-events.md)|Описывает способ создания процедуры обработчика событий.|  
|[Практическое руководство. Объявление пользовательских событий для предотвращения блокировки](how-to-declare-custom-events-to-avoid-blocking.md)|Показывает, как определить пользовательское событие, которое позволяет асинхронно вызывать обработчики событий.|  
|[Практическое руководство. Объявление пользовательских событий для экономии памяти](how-to-declare-custom-events-to-conserve-memory.md)|Показывает, как определить пользовательское событие, которое использует память только при обработке события.|  
|[Устранение неполадок, связанных с унаследованными обработчиками событий, в Visual Basic](troubleshooting-inherited-event-handlers.md)|Перечисляет распространенные проблемы, возникающие для обработчиков событий в наследуемых компонентах.|  
|[События](../../../../standard/events/index.md)|Обзор модели событий .NET Framework.|  
|[Создание обработчиков событий в Windows Forms](/dotnet/desktop/winforms/creating-event-handlers-in-windows-forms)|Описывает, как работать с событиями, связанными с объектами Windows Forms.|  
|[Делегаты](../delegates/index.md)|Предоставляет обзор делегатов в Visual Basic.|
