---
description: Дополнительные сведения см. в статье как инициализировать переменную массива в Visual Basic
title: Практическое руководство. Инициализация переменной массива
ms.date: 07/20/2015
helpviewer_keywords:
- variables [Visual Basic], initializing
- arrays [Visual Basic], variables
- arrays [Visual Basic], initializing
- arrays [Visual Basic], declaring
ms.assetid: aadd7a60-7ca4-4608-b986-091f19e7fc10
ms.openlocfilehash: 05cca98457a56db52ee99cfc4ac93c860da7a51d
ms.sourcegitcommit: 10e719780594efc781b15295e499c66f316068b8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/14/2021
ms.locfileid: "100427613"
---
# <a name="how-to-initialize-an-array-variable-in-visual-basic"></a>Практическое руководство. Инициализация переменной массива в Visual Basic

Инициализируйте переменную массива, включив литерал массива в `New` предложение и указав начальные значения массива. Можно либо указать тип, либо разрешить вывод его из значений в литерале массива. Дополнительные сведения о выводимом типе см. в разделе «Заполнение массива начальными значениями» в [массивах](index.md).  
  
### <a name="to-initialize-an-array-variable-by-using-an-array-literal"></a>Инициализация переменной массива с помощью литерала массива  
  
- Либо в `New` предложении, либо при присваивании значения массива, укажите значения элементов внутри фигурных скобок ( `{}` ). В следующем примере показано несколько способов объявления, создания и инициализации переменной, содержащей массив с элементами типа `Char` .  
  
     [!code-vb[VbVbalrArrays#16](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#16)]  
  
     После выполнения каждой инструкции создаваемый массив имеет длину 3 и элементы с индексом 0 по индексу 2, содержащие начальные значения. При указании и верхней границы, и значений необходимо включить значение для каждого элемента из индекса 0 через верхнюю границу.  
  
     Обратите внимание, что при указании значений элементов в литерале массива не нужно указывать верхнюю границу индекса. Если верхняя граница не указана, размер массива определяется исходя из числа значений в литерале массива.  
  
### <a name="to-initialize-a-multidimensional-array-variable-by-using-array-literals"></a>Инициализация переменной многомерного массива с помощью литералов массива  
  
- Вложенные значения внутри фигурных скобок ( `{}` ) внутри фигурных скобок. Убедитесь, что все вложенные литералы массива выводятся как массивы одинакового типа и длины. В следующем примере кода показаны несколько примеров инициализации многомерных массивов.  
  
     [!code-vb[VbVbalrArrays#17](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#17)]  
  
- Можно явно указать границы массива или оставить их, чтобы компилятор мог вычислять границы массива на основе значений в литерале массива. При указании обеих верхних границ и значений необходимо включить значение для каждого элемента из индекса 0 через верхнюю границу в каждом измерении. В следующем примере показано несколько способов объявления, создания и инициализации переменной, содержащей двумерный массив с элементами типа `Short`  
  
     [!code-vb[VbVbalrArrays#18](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#18)]  
  
     После выполнения каждой инструкции созданный массив содержит шесть инициализированных элементов, имеющих индексы `(0,0)` ,,, `(0,1)` , `(0,2)` `(1,0)` `(1,1)` и `(1,2)` . Каждое расположение массива содержит значение `10` .  
  
- В следующем примере выполняется итерация по многомерному массиву. В консольном приложении Windows, написанном на Visual Basic, вставьте код в `Sub Main()` метод. Последние комментарии показывают выходные данные.  
  
     [!code-vb[VbVbalrArrays#31](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#31)]  
  
### <a name="to-initialize-a-jagged-array-variable-by-using-array-literals"></a>Инициализация переменной массива массивов с помощью литералов массива  
  
- Вложенные значения объектов в фигурные скобки ( `{}` ). Хотя можно также вкладывать литералы массива, указывающие массивы разной длины, в случае массива массивов убедитесь, что литералы вложенных массивов заключены в круглые скобки ( `()` ). Круглые скобки принудительно выводят вычисление литералов вложенных массивов, а результирующие массивы используются в качестве начальных значений массива массивов. В следующем примере кода показаны два примера инициализации массива массивов.  
  
     [!code-vb[VbVbalrArrays#19](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#19)]  
  
- В следующем примере выполняется перебор массива массивов. В консольном приложении Windows, написанном на Visual Basic, вставьте код в `Sub Main()` метод.  Последние комментарии в коде показывают выходные данные.  
  
     [!code-vb[VbVbalrArrays#32](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#32)]  
  
## <a name="see-also"></a>См. также

- [Массивы](index.md)
- [Устранение неполадок, связанных с массивами](troubleshooting-arrays.md)
