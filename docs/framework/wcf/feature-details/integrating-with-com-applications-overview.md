---
description: 'Подробнее: интеграция с приложениями COM обзор'
title: Общие сведения об интеграции с приложениями COM
ms.date: 03/30/2017
helpviewer_keywords:
- COM [WCF], integration overview
ms.assetid: 02c5697f-6e2e-47d6-b715-f3a28aebfbd5
ms.openlocfilehash: a179fd73c8065fff1e16d3f86202d717df155b81
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/06/2021
ms.locfileid: "99802818"
---
# <a name="integrating-with-com-applications-overview"></a>Общие сведения об интеграции с приложениями COM

Windows Communication Foundation (WCF) предоставляет разработчику управляемого кода обширную среду для создания подключенных приложений. Однако если у вас есть существенные инвестиции в неуправляемый код на основе COM и вы не хотите выполнять миграцию, веб-службы WCF можно интегрировать непосредственно в существующий код с помощью моникера службы WCF. Моникер служб можно использовать в широком наборе сред разработки на базе модели COM, например в Office VBA, Visual Basic 6.0 и Visual C++ 6.0.

> [!NOTE]
> Моникер службы использует канал связи WCF для всего обмена данными. Механизмы безопасности и идентификации для этого канала отличаются от механизмов, используемых в стандартных прокси-средствах COM и DCOM. Кроме того, поскольку моникер службы использует канал связи WCF, время ожидания по умолчанию составляет одну минуту для всех вызовов.

Моникер службы используется с `GetObject` функцией для предоставления неуправляемому разработчику строго типизированного, зависящего от com подхода к вызову веб-служб WCF. Для этого требуется локальное, видимое COM определение контракта веб-службы WCF и используемой привязки. Как и другие клиенты WCF, моникер службы должен создать типизированный канал для службы, хотя эта конструкция канала прозрачна для программиста COM при первом вызове метода.

В общих случаях с другими клиентами WCF при использовании моникера приложения указывают адрес, привязку и контракт для взаимодействия со службой. Контракт можно задать одним из следующих способов.

- Типизированный контракт: контракт регистрируется как видимый для модели COM тип на клиентском компьютере.

- Контракт WSDL: контракт предоставляется в виде документа WSDL.

- Контракт MEX: контракт получается в среде выполнения из конечной точки обмена метаданными (MEX).

## <a name="parameters-supported-by-the-service-moniker"></a>Параметры, поддерживаемые моникером служб

В следующей таблице представлены параметры, поддерживаемые моникером служб.

|Параметр|Описание|
|---------------|-----------------|
|`address`|URL-адрес службы.|
|`binding`|Имя раздела привязки из конфигурации приложения.|
|`bindingConfiguration`|Именованный экземпляр привязки из именованного раздела привязки.|
|`contract`|Идентификатор интерфейса (IID), представляющий контракт службы или имя контракта (из MEX).|
|`wsdl`|Документ WSDL, обеспечивающий альтернативную форму определения контракта.|
|`spnIdentity`|Идентификатор имени участника на уровне сервера (SPN), который должен использоваться для взаимодействия со службой.|
|`upnIdentity`|Идентификатор имени участника-пользователя (UPN), который должен использоваться для взаимодействия со службой.|
|`dnsIdentity`|Идентификатор DNS, который должен использоваться для взаимодействия со службой.|
|`mexAddress`|URL-адрес конечной точки службы для обмена метаданными (MEX).|
|`mexBinding`|Имя раздела привязки из конфигурации приложения для соединения с конечной точкой MEX.|
|`mexBindingConfiguration`|Именованный экземпляр привязки из именованного раздела привязки для соединения с конечной точкой MEX.|
|`bindingNamespace`|Пространство имен для имени раздела привязки, полученное в результате MEX.|
|`contractNamespace`|Пространство имен контракта, полученное в результате MEX.|
|`mexSpnIdentity`|Идентификатор имени участника на уровне сервера (SPN), который должен использоваться для взаимодействия с конечной точкой MEX.|
|`mexUpnIdentity`|Идентификатор имени участника-пользователя (UPN), который должен использоваться для взаимодействия с конечной точкой MEX.|
|`mexDnsIdentity`|Идентификатор DNS, который должен использоваться для взаимодействия с конечной точкой MEX.|
|`serializer`|Позволяет задать использование сериализатора "xml" или "datacontract".|

> [!NOTE]
> Даже при использовании с полностью основанными на COM клиентами для моникера службы требуется WCF, а на клиентском компьютере должна быть установлена поддержка платформа .NET Framework 2,0. Также важно, чтобы в клиентские приложения, использующие моникер служб, была загружена соответствующая версия среды выполнения платформы .NET Framework. При использовании моникера в приложениях Office может потребоваться файл конфигурации, чтобы обеспечить загрузку надлежащей версии .NET Framework. Например, при использовании Excel файл Excel.exe.config, расположенный в том же каталоге, что и файл Excel.exe, должен содержать следующий текст:
>
> `<?xml version="1.0" encoding="utf-8"?>`
>
> `<configuration xmlns=` `http://schemas.microsoft.com/.NetConfiguration/v2.0` `>`
>
> `<startup>`
>
> `<requiredRuntime version="v2.0.50727" />`
>
> `</startup>`
>
> `</configuration>`

## <a name="see-also"></a>См. также

- [Практическое руководство. Регистрация и настройка моникера службы](how-to-register-and-configure-a-service-moniker.md)
