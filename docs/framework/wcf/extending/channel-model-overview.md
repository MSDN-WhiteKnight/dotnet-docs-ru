---
description: 'Дополнительные сведения: Общие сведения о модели каналов'
title: Общие сведения о модели каналов
ms.date: 03/30/2017
helpviewer_keywords:
- channel model [WCF]
ms.assetid: 07a81e11-3911-4632-90d2-cca99825b5bd
ms.openlocfilehash: 8b22c2b957eec6e3b52a84c7a30d4a17c41293e6
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/06/2021
ms.locfileid: "99685885"
---
# <a name="channel-model-overview"></a>Общие сведения о модели каналов

Стек каналов Windows Communication Foundation (WCF) — это многоуровневый стек связи с одним или несколькими каналами, которые обрабатывают сообщения. В нижней части стека находится канал транспорта, отвечающий за адаптацию стека каналов к используемому транспорту (например, TCP, HTTP, SMTP и другим типам транспорта). Каналы обеспечивают модель низкоуровневого программирования для передачи и приема сообщений. Эта модель программирования основывается на нескольких интерфейсах и других типах, которые совместно называются моделью WCF Channel. В данном разделе рассматриваются формы каналов, создание базового прослушивателя каналов (в службе) и фабрики каналов (на клиенте).  
  
## <a name="channel-stack"></a>Стек каналов  

 Конечные точки WCF взаимодействуют с миром с помощью стека связи, который называется стеком каналов. На следующем рисунке стек каналов сравнивается с другими стеками связи, например TCP/IP.  
  
 ![Модель канала](./media/wcfc-channelstackhighlevelc.gif "wcfc_ChannelStackHighLevelc")  
  
 Сначала отметим сходства. В обоих случаях каждый уровень стека обеспечивает некоторое абстрактное представление среды, находящейся под ним, и предоставляет это абстрактное представление только уровню, расположенному непосредственно над ним. Каждый уровень использует абстрактное представление только уровня, расположенного непосредственно под ним. Кроме того, в обоих случаях при взаимодействии двух стеков каждый уровень взаимодействует с соответствующим уровнем другого стека, например уровень IP взаимодействует с уровнем IP, уровень TCP - с уровнем TCP и т. д.  
  
 Теперь отметим различия. Стек TCP был разработан для обеспечения абстрактного представления физической сети, а стек каналов - для обеспечения абстрактного представления не только способа доставки сообщения, т. е. транспорта, но и других особенностей, например содержимого сообщения, протокола, используемого для взаимодействия, включая транспорт, но не только его. Например, элемент привязки надежного сеанса является частью стека каналов, но не находится ниже транспорта и не представляет сам транспорт. Эта абстракция достигается посредством предъявления нижнему каналу в стеке требования адаптировать базовый транспортный протокол к архитектуре стека каналов и последующего расчета на то, что вышестоящие каналы в стеке должны обеспечивать такие функции связи, как предоставление гарантий надежности и безопасности.  
  
 Сообщения проходят через стек связи в виде объектов <xref:System.ServiceModel.Channels.Message>. Как показано на представленном выше рисунке, нижний канал называется каналом транспорта. Этот канал отвечает за передачу сообщений другим участникам и прием сообщений от них, в том числе несет ответственность за преобразование объекта <xref:System.ServiceModel.Channels.Message> в формат, используемый для связи с другими участниками, и за обратное преобразование. Над каналом транспорта может находиться любое число протокольных каналов, каждый из которых отвечает за обеспечение такой функции связи, как предоставление гарантий надежной доставки. Протокольные каналы оперируют с сообщениями, проходящими через них в виде объекта <xref:System.ServiceModel.Channels.Message>. Они обычно либо преобразуют сообщение, например добавляя заголовки или шифруя тело сообщения, либо передают и принимают свои собственные управляющие сообщения протокола, например подтверждения приема.  
  
## <a name="channel-shapes"></a>Формы каналов  

 Каждый канал реализует один или несколько интерфейсов, называемых интерфейсами форм каналов, или формами каналов. Эти формы каналов обеспечивают такие ориентированные на взаимодействие методы, как передача и прием или запрос и ответ, которые реализуются каналом и вызываются пользователем канала. В основе фигур канала находится <xref:System.ServiceModel.Channels.IChannel> интерфейс, который предоставляет `GetProperty` \<T> метод, предназначенный для использования в качестве многоуровневого механизма для доступа к произвольным функциям, предоставляемым каналами в стеке. Ниже перечислены пять форм каналов, расширяющих интерфейс <xref:System.ServiceModel.Channels.IChannel>.  
  
- <xref:System.ServiceModel.Channels.IInputChannel>  
  
- <xref:System.ServiceModel.Channels.IOutputChannel>  
  
- <xref:System.ServiceModel.Channels.IRequestChannel>  
  
- <xref:System.ServiceModel.Channels.IReplyChannel>  
  
- <xref:System.ServiceModel.Channels.IDuplexChannel>  
  
 Каждая из этих форм имеет эквивалент, который расширяет <xref:System.ServiceModel.Channels.ISessionChannel%601?displayProperty=nameWithType> для поддержки сеансов. Эти особые значения приведены ниже.  
  
- <xref:System.ServiceModel.Channels.IInputSessionChannel>  
  
- <xref:System.ServiceModel.Channels.IOutputSessionChannel>  
  
- <xref:System.ServiceModel.Channels.IRequestSessionChannel>  
  
- <xref:System.ServiceModel.Channels.IReplySessionChannel>  
  
- <xref:System.ServiceModel.Channels.IDuplexSessionChannel>  
  
 Формы каналов создаются в соответствии с некоторыми базовыми шаблонами обмена сообщениями, поддерживаемыми существующими транспортными протоколами. Например, односторонняя обмен сообщениями соответствует <xref:System.ServiceModel.Channels.IInputChannel> / <xref:System.ServiceModel.Channels.IOutputChannel> паре, "запрос-ответ <xref:System.ServiceModel.Channels.IRequestChannel> / <xref:System.ServiceModel.Channels.IReplyChannel> " соответствует парам, а двусторонняя дуплексная связь соответствует <xref:System.ServiceModel.Channels.IDuplexChannel> (которая расширяет <xref:System.ServiceModel.Channels.IInputChannel> и, и <xref:System.ServiceModel.Channels.IOutputChannel> ).  
  
## <a name="programming-with-the-channel-stack"></a>Программирование со стеком каналов  

 Стеки каналов обычно создаются с помощью шаблона фабрики, где привязка создает стек каналов. На стороне передачи привязка используется для создания фабрики <xref:System.ServiceModel.ChannelFactory>, которая, в свою очередь, создает стек каналов и возвращает ссылку на верхний канал в стеке. Затем приложение может использовать этот канал для передачи сообщений. Дополнительные сведения см. в разделе [программирование клиентских Channel-Level](client-channel-level-programming.md).  
  
 На стороне приема привязка используется для создания прослушивателя <xref:System.ServiceModel.Channels.IChannelListener>, который прослушивает входящие сообщения. <xref:System.ServiceModel.Channels.IChannelListener> предоставляет сообщения прослушивающему приложению, создавая стеки каналов и обрабатывая ссылку приложения на верхний канал. Затем приложение использует этот канал для приема входящих сообщений. Дополнительные сведения см. в статье [Программирование служб Channel-Level](service-channel-level-programming.md).  
  
## <a name="the-channel-object-model"></a>Объектная модель каналов  

 Объектная модель каналов - это базовый набор интерфейсов, необходимых для реализации каналов, прослушивателей каналов и фабрик каналов. Существуют также некоторые базовые классы, предусмотренные для содействия в обеспечении пользовательских реализаций.  
  
 Прослушиватели каналов отвечают за прослушивание входящих сообщений и их доставку вышестоящему уровню по созданным ими каналам.  
  
 Фабрики каналов отвечают за создание каналов, используемых для передачи сообщений, и за закрытие всех созданных ими каналов, когда эти фабрики закрываются.  
  
 <xref:System.ServiceModel.ICommunicationObject> - это базовый интерфейс, определяющий основной конечный автомат, который реализуют все объекты, обменивающиеся сообщениями. <xref:System.ServiceModel.Channels.CommunicationObject> предоставляет реализацию этого базового интерфейса, от которого можно наследовать другие классы каналов, что позволяет избежать повторной реализации интерфейса. Однако это необязательно: пользовательский канал может реализовать интерфейс <xref:System.ServiceModel.ICommunicationObject> непосредственно, а не наследовать его от <xref:System.ServiceModel.Channels.CommunicationObject>. Ни один из классов, показанных на рис. 3, не считается частью модели каналов; это вспомогательные классы, доступные тем, кто занимается реализацией пользовательских каналов и нуждается в средствах создания каналов.  
  
 ![Модель канала](./media/wcfc-wcfcchannelsigure3omumtreec.gif "wcfc_WCFCChannelsigure3OMUMTreec")  
  
 В следующих разделах описываются объектная модель каналов, а также различные области разработки, помогающие создавать пользовательские каналы.  
  
|Раздел|Описание|  
|-----------|-----------------|  
|[Служба: прослушиватели каналов и каналы](service-channel-listeners-and-channels.md)|Описываются прослушиватели каналов, ожидающие передачи данных по входящим каналам в приложении службы.|  
|[Клиент: Фабрики каналов и каналы](client-channel-factories-and-channels.md)|Описываются фабрики каналов, которые создают каналы для подключения к приложению службы.|  
|[Основные сведения об изменении состояния](understanding-state-changes.md)|Описывается, как модели интерфейса <xref:System.ServiceModel.ICommunicationObject?displayProperty=nameWithType> изменяют состояния в каналах.|  
|[Выбор шаблона обмена сообщениями](choosing-a-message-exchange-pattern.md)|Описываются шесть базовых шаблонов обмена сообщениями, которые могут поддерживаться каналами.|  
|[Обработка исключений и сбоев](handling-exceptions-and-faults.md)|Описываются способы обработки сбоев и исключений в пользовательских каналах.|  
|[Конфигурация и поддержка метаданных](configuration-and-metadata-support.md)|Описываются поддержка использования пользовательских каналов из модели приложения, а также экспорт и импорт метаданных с использованием привязок и элементов привязок.|
