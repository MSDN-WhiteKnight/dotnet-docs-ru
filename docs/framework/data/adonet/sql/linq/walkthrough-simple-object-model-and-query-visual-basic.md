---
description: Дополнительные сведения см. в разделе Пошаговое руководство. простая модель объектов и запрос (Visual Basic)
title: Пошаговое руководство. Простая модель объекта и запрос (Visual Basic)
ms.date: 03/30/2017
dev_langs:
- vb
ms.assetid: c878e457-f715-46e4-a136-ff14d6c86018
ms.openlocfilehash: def2fecf0d6d97841ebd47a1d675f85341053d39
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/06/2021
ms.locfileid: "99791807"
---
# <a name="walkthrough-simple-object-model-and-query-visual-basic"></a>Пошаговое руководство. Простая модель объекта и запрос (Visual Basic)

В данном пошаговом руководстве представлен основной и полный сценарий [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] с подробным объяснением выполняемых действий. В нем создается класс сущностей, который моделирует таблицу Customers в учебной базе данных Northwind. После этого создается простой запрос на получение списка клиентов, находящихся в Лондоне.

Данное руководство ориентировано на создание кода, чтобы продемонстрировать основные понятия технологии [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]. Как правило, для создания объектной модели следует использовать реляционный конструктор объектов.

[!INCLUDE[note_settings_general](../../../../../../includes/note-settings-general-md.md)]

Это пошаговое руководство было написано с помощью параметров разработки Visual Basic.

## <a name="prerequisites"></a>Предварительные требования

- Для хранения файлов используется выделенная папка ("c:\linqtest"). Прежде чем приступить к выполнению задач, создайте такую папку.

- В данном пошаговом руководстве требуется доступ к учебной базе данных Northwind. Если база данных не установлена на компьютере разработчика, загрузите ее с веб-узла Центра загрузки Майкрософт. Инструкции см. в разделе [Загрузка образцов баз данных](downloading-sample-databases.md). После загрузки базы данных скопируйте полученный файл в папку c:\linqtest.

## <a name="overview"></a>Обзор

Данное пошаговое руководство состоит из шести основных задач.

- Создание [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] решения в Visual Studio.

- Сопоставление класса с таблицей базы данных.

- Назначение свойств классу для представления столбцов базы данных.

- Указание подключения к базе данных Northwind.

- Создание простого запроса к базе данных.

- Выполнение запроса и просмотр результатов.

## <a name="creating-a-linq-to-sql-solution"></a>Создание решения LINQ to SQL

В этой первой задаче вы создадите решение Visual Studio, содержащее необходимые ссылки для сборки и запуска [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] проекта.

### <a name="to-create-a-linq-to-sql-solution"></a>Создание решения LINQ to SQL

1. В меню **Файл** выберите пункт **Создать проект**.

2. На панели **типы проектов** диалогового окна **Новый проект** нажмите кнопку **Visual Basic**.

3. В области **Шаблоны** щелкните **Консольное приложение**.

4. В поле **имя** введите **линкконсолеапп**.

5. Нажмите кнопку **OK**.

## <a name="adding-linq-references-and-directives"></a>Добавление ссылок и директив LINQ

В этом пошаговом руководстве используются сборки, которые могут быть не установлены по умолчанию в проект. Если `System.Data.Linq` в проекте нет списка (щелкните **Показывать все файлы** в **Обозреватель решений** и разверните узел **ссылки** ), добавьте его, как описано в следующих шагах.

### <a name="to-add-systemdatalinq"></a>Добавление сборки System.Data.Linq

1. В **Обозреватель решений** щелкните правой кнопкой мыши элемент **ссылки** и выберите команду **Добавить ссылку**.

2. В диалоговом окне **Добавление ссылки** щелкните **.NET**, выберите сборку System. Data. LINQ и нажмите кнопку **ОК**.

     Сборка будет добавлена в проект.

3. Кроме того, в диалоговом окне **Добавление ссылки** щелкните **.NET**, прокрутите до и щелкните System. Windows. Forms, а затем нажмите кнопку **ОК**.

     Эта сборка, которая поддерживает окно сообщений в данном пошаговом руководстве, будет добавлена в проект.

4. Добавьте следующие директивы перед `Module1`.

     [!code-vb[DLinqWalk1VB#1](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1VB/vb/Module1.vb#1)]

## <a name="mapping-a-class-to-a-database-table"></a>Сопоставление класса с таблицей базы данных

На этом этапе создается класс, который сопоставляется с таблицей базы данных. Такой класс называется *классом сущностей*. Обратите внимание, что сопоставление осуществляется простым добавлением атрибута <xref:System.Data.Linq.Mapping.TableAttribute>. Свойство <xref:System.Data.Linq.Mapping.TableAttribute.Name%2A> задает имя таблицы в базе данных.

### <a name="to-create-an-entity-class-and-map-it-to-a-database-table"></a>Создание класса сущностей и его сопоставление с таблицей базы данных

- Введите или вставьте следующий код в файл Module1.vb непосредственно перед методом `Sub Main`.

     [!code-vb[DLinqWalk1VB#2](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1VB/vb/Module1.vb#2)]

## <a name="designating-properties-on-the-class-to-represent-database-columns"></a>Назначение свойств классу для представления столбцов базы данных.

На этом этапе выполняется несколько задач.

- Используется атрибут <xref:System.Data.Linq.Mapping.ColumnAttribute> для назначения классу сущностей свойств `CustomerID` и `City`, представляющих столбцы в таблице базы данных.

- Назначается свойство `CustomerID`, представляющее столбец первичного ключа в базе данных.

- Назначаются поля `_CustomerID` и `_City` для закрытого хранения. После этого [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] сможет напрямую сохранять и извлекать значения, вместо вызова открытых методов доступа, которые могут содержать бизнес-логику.

### <a name="to-represent-characteristics-of-two-database-columns"></a>Представление характеристик двух столбцов базы данных

- Введите или вставьте следующий код в файл Module1.vb непосредственно перед методом `End Class`.

     [!code-vb[DLinqWalk1VB#3](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1VB/vb/Module1.vb#3)]

## <a name="specifying-the-connection-to-the-northwind-database"></a>Указание подключения к базе данных Northwind

На этом этапе для установки подключения между основанными на коде структурами данных и самой базой данных используется объект <xref:System.Data.Linq.DataContext>. Основным каналом, через который извлекаются объекты из базы данных и отправляются изменения, является класс <xref:System.Data.Linq.DataContext>.

Также объявляется объект `Table(Of Customer)`, который действует как логическая типизированная таблица для запросов к таблице Customers в базе данных. Эти запросы создаются и выполняются в последующих действиях.

### <a name="to-specify-the-database-connection"></a>Указание подключения к базе данных

- Введите или вставьте следующий код в метод `Sub Main`.

     Обратите внимание: предполагается, что файл `northwnd.mdf` находится в папке "linqtest". Дополнительные сведения см. в разделе "Предварительные требования" ранее в этом руководстве.

     [!code-vb[DLinqWalk1VB#4](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1VB/vb/Module1.vb#4)]

## <a name="creating-a-simple-query"></a>Создание простого запроса

На этом этапе создается запрос для поиска клиентов из таблицы Customers базы данных, находящихся в Лондоне. Код запроса, создаваемый на этом шаге, только описывает запрос. но не выполняет его. Этот подход называется *отложенным выполнением*. Дополнительные сведения см. в разделе [Введение в запросы LINQ (C#)](../../../../../csharp/programming-guide/concepts/linq/introduction-to-linq-queries.md).

Можно также записать выходные данные в журнал, чтобы продемонстрировать команды SQL, создаваемые технологией [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]. Возможность ведения журнала (которая использует метод <xref:System.Data.Linq.DataContext.Log%2A>) очень полезна при отладке, а также при проверке того, что команды, отправляемые в базу данных, точно соответствуют запросу.

### <a name="to-create-a-simple-query"></a>Создание простого запроса

- Введите или вставьте следующий код в метод `Sub Main` после объявления `Table(Of Customer)`.

     [!code-vb[DLinqWalk1AVB#5](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1AVB/vb/Module1.vb#5)]

## <a name="executing-the-query"></a>Выполнение запроса

На этом шаге производится фактическое выполнение запроса. Выражения запроса, созданные на предыдущем этапе, не оцениваются до тех пор, пока не понадобятся результаты. После начала итерации `For Each` выполняется команда SQL для базы данных и материализуются объекты.

### <a name="to-execute-the-query"></a>Порядок выполнения запроса

1. Введите или вставьте следующий код в конце метода `Sub Main` (после описания запроса).

     [!code-vb[DLinqWalk1AVB#6](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1AVB/vb/Module1.vb#6)]

2. Нажмите клавишу F5, чтобы начать отладку приложения.

    > [!NOTE]
    > Если приложение создает ошибку во время выполнения, см. [Пошаговые руководства](learning-by-walkthroughs.md)в разделе Устранение неполадок.

     В окне сообщения отображается список из шести клиентов. В окне консоли отображается созданный код SQL.

3. Нажмите кнопку **ОК**, чтобы закрыть окно сообщения.

     Приложение закрывается.

4. В меню **File** (Файл) выберите команду **Save All** (Сохранить все).

     Это приложение потребуется при выполнении следующего пошагового руководства.

## <a name="next-steps"></a>Следующие шаги

Раздел [Пошаговое руководство. запрос по связям (Visual Basic)](walkthrough-querying-across-relationships-visual-basic.md) продолжит работу в этом пошаговом руководстве. В пошаговом руководстве «запросы между связями [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] » показано, как можно выполнять запросы к нескольким таблицам, как и к *объединениям* в реляционной базе данных.

Если требуется выполнить пошаговое руководство "Выполнение запросов в связях", необходимо сохранить решение, созданное в процессе только что завершенного пошагового руководства. Это обязательное условие.

## <a name="see-also"></a>См. также

- [Обучение с использованием пошаговых руководств](learning-by-walkthroughs.md)
