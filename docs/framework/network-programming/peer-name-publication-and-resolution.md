---
description: 'Узнайте подробнее о: Публикация и разрешение имени однорангового узла'
title: Публикация и разрешение имени однорангового узла
ms.date: 03/30/2017
ms.assetid: f0370e08-9fa6-4ee5-ab78-9a58a20a7da2
ms.openlocfilehash: cd1d3358c212b1618548422715329eea57452ac3
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/06/2021
ms.locfileid: "99747430"
---
# <a name="peer-name-publication-and-resolution"></a>Публикация и разрешение имени однорангового узла

## <a name="publishing-a-peer-name"></a>Публикация имени однорангового узла  

 Чтобы опубликовать новый идентификатор PNRP, одноранговый узел выполняет следующие операции:  
  
- Отправляет сообщения публикации PNRP своим соседям по кэшу (одноранговые узлы с зарегистрированными идентификаторами PNRP на самом низком уровне кэша) для инициализации соответствующих кэшей.  
  
- Выбирает случайные узлы в облаке, которые не являются его соседями, и отправляет запросы разрешения имен PNRP для своего собственного идентификатора P2P. Результирующий процесс определения конечной точки инициализирует кэши случайных узлов в облаке, используя идентификатор PNRP публикующего однорангового узла.  
  
Узлы PNRP версии 2 не публикуют идентификаторы PNRP в том случае, если они разрешают только другие идентификаторы P2P. Параметр реестра HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\PeerNet\PNRP\IPV6-Global\SearchOnly=1 (REG_DWORD type) указывает, что одноранговый узел использует PNRP только для разрешения имен и никогда не использует его для публикации имен. Этот параметр реестра также можно настроить с помощью групповой политики.  
  
## <a name="resolving-a-peer-name"></a>Разрешение имени однорангового узла

 Поиск других одноранговых узлов в сети PNRP или облаке состоит из двух этапов:  
  
1. Определение конечной точки  
  
2. Разрешение идентификатора PNRP  
  
 На этапе определения конечной точки одноранговый узел, который пытается разрешить идентификатор PNRP службы на другом компьютере, определяет IPv6-адрес этого удаленного однорангового узла.  В качестве удаленного однорангового узла выступает узел, который опубликован или связан с идентификатором PNRP компьютера или службы.  
  
 После подтверждения регистрации удаленной конечной точки в облаке PNRP запрашивающий одноранговый узел на этапе разрешения идентификатора PNRP отправляет запрос к этой конечной точке однорангового узла для получения идентификатора PNRP требуемой службы. Конечная точка отправляет ответ с подтверждением идентификатора PNRP службы, комментарий, а также до 4 КБ дополнительной информации, которую запрашивающий одноранговый узел может использовать для обмена данными в дальнейшем. Например, если требуемая конечная точка является игровым сервером, в дополнительных данных записи с именем однорангового узла могут содержаться сведения об игре, достигнутом уровне, а также текущем количестве игроков.  
  
 На этапе определения конечной точки PNRP использует итеративный процесс для поиска узла, который опубликовал идентификатор PNRP. В этом случае выполняющий разрешение узел отвечает за обращение к узлам, которые максимально близки к целевому идентификатору PNRP.  
  
 Чтобы выполнить разрешение имен в PNRP, одноранговый узел анализирует записи в собственном кэше на наличие записи, которая соответствует целевому идентификатору PNRP. Если такая запись найдена, одноранговый узел отправляет сообщение запроса PNRP к одноранговому узлу и ожидает ответа. Если запись для идентификатора PNRP не найдена, одноранговый узел отправляет сообщение запроса PNRP к одноранговому узлу, который соответствует записи с идентификатором PNRP, наиболее полно соответствующим целевому идентификатору PNRP. Узел, получающий сообщение запроса PNRP, анализирует собственный кэш и выполняет следующие действия:  
  
- Если идентификатор PNRP найден, запрошенный одноранговый узел конечной точки отвечает непосредственно запрашивающему одноранговому узлу.  
  
- Если идентификатор PNRP не найден, а идентификатор PNRP близок к целевому, запрошенный одноранговый узел отправляет запрашивающему узлу ответ, содержащий IPv6-адрес однорангового узла, который представляет запись с идентификатором PNRP, наиболее близко соответствующим целевому идентификатору PNRP. Используя IP-адрес в ответе, запрашивающий узел отправляет другое сообщение запроса PNRP по этому IPv6-адресу, чтобы дать ответ или проанализировать свой кэш.  
  
- Если идентификатор PNRP не найден и близкий к конечному идентификатор PNRP отсутствует в кэше, запрошенный одноранговый узел отправляет запрашивающему узлу ответ, указывающий на это состояние. После этого запрашивающий одноранговый узел выбирает идентификатор PNRP следующего ближайшего узла.  
  
Запрашивающий узел продолжает этот процесс, повторяя итерации, пока не будет найден узел, зарегистрировавший идентификатор PNRP.  
  
 В пространстве имен <xref:System.Net.PeerToPeer> определено отношение "многие ко многим" между записями <xref:System.Net.PeerToPeer.PeerName>, содержащими конечные точки, и одноранговыми сетями или облаками PNRP, в которых они осуществляют обмен данными. При наличии повторяющихся или устаревших записей или нескольких узлов с одинаковыми именами однорангового узла узлы PNRP могут получать актуальную информацию с помощью класса <xref:System.Net.PeerToPeer.PeerNameResolver>. Методы <xref:System.Net.PeerToPeer.PeerNameResolver> используют одно имя однорангового узла, упрощая соотношение между именами одноранговых узлов и записями или облаками до "один ко многим". Это поведение аналогично выполнению запроса с использованием соединения реляционной таблицы. В случае успешного выполнения объект Resolver возвращает <xref:System.Net.PeerToPeer.PeerNameRecordCollection> для заданного имени однорангового узла.  Например, имя однорангового узла может встречаться во всех записях имен одноранговых узлов в коллекции с упорядочением по облаку. Для этих экземпляров имен одноранговых узлов приложение на основе протокола PNRP сможет запрашивать вспомогательные данные.  
  
## <a name="see-also"></a>См. также раздел

- <xref:System.Net.PeerToPeer>
