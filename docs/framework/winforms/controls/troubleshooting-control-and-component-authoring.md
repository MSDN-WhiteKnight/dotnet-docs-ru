---
title: Разрешение вопросов, связанных с созданием элементов управления и компонентов
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- troubleshooting components
- troubleshooting controls [Windows Forms]
- controls [Windows Forms], troubleshooting
- components [Windows Forms], troubleshooting
- Windows Forms controls, debugging
ms.assetid: e9c8c099-2271-4737-882f-50f336c7a55e
ms.openlocfilehash: 3ae8a889bf69913d234e31804335ddb08560c30c
ms.sourcegitcommit: 558d78d2a68acd4c95ef23231c8b4e4c7bac3902
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/09/2019
ms.locfileid: "59343419"
---
# <a name="troubleshooting-control-and-component-authoring"></a>Разрешение вопросов, связанных с созданием элементов управления и компонентов
В этом разделе перечислены распространенные проблемы, возникающие при разработке компонентов и элементов управления. Дополнительные сведения см. в разделе [Программирование с использованием компонентов](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/0ffkdtkf(v=vs.120)).  
  
-   Не удается добавить элемент управления на панель элементов  
  
-   Не удается выполнить отладку пользовательского элемента управления или компонента Windows Forms  
  
-   Событие в производном элементе управления или компоненте вызывается дважды  
  
-   Ошибка во время разработки. «Не удалось создать компонент "*имя компонента*"»  
  
-   STAThreadAttribute  
  
-   Значок компонента не отображается на панели элементов  
  
## <a name="cannot-add-control-to-toolbox"></a>Не удается добавить элемент управления на панель элементов  
 Если вы хотите добавить на **панель элементов** настраиваемый элемент управления, созданный в другом проекте, или сторонний элемент управления, это необходимо сделать вручную. Если ваш элемент управления или компонент уже находится в текущем проекте, он отобразится на **панели элементов** автоматически. Дополнительные сведения см. в разделе [Пошаговое руководство: Автоматическое заполнение панели элементов пользовательскими компонентами](walkthrough-automatically-populating-the-toolbox-with-custom-components.md).  
  
#### <a name="to-add-a-control-to-the-toolbox"></a>Добавление элемента управления на панель элементов  
  
1. Щелкните **панель инструментов** правой кнопкой мыши и выберите команду **Выбрать элементы**.  
  
2. Добавьте компонент в диалоговом окне **Выбор элементов панели элементов**.  
  
    -   Чтобы добавить компонент или элемент управления .NET Framework, откройте вкладку **Компоненты .NET Framework**.  
  
         — или —  
  
    -   Чтобы добавить COM-компонент или элемент управления ActiveX, откройте вкладку **COM-компоненты**.  
  
3. Если элемент управления указан в диалоговом окне, выделите его и нажмите кнопку **ОК**.  
  
     Элемент управления будет добавлен на **панель элементов**.  
  
4. Если элемент управления не указан в диалоговом окне, выполните следующие действия.  
  
    1.  Нажмите кнопку **Обзор**.  
  
    2.  Найдите папку с DLL-файлом, содержащим ваш элемент управления.  
  
    3.  Выберите этот DLL-файл и нажмите кнопку **Открыть**.  
  
         Элемент управления отобразится в диалоговом окне.  
  
    4.  Выберите элемент управления и нажмите кнопку **ОК**.  
  
         Элемент управления будет добавлен на **панель элементов**.  
  
## <a name="cannot-debug-the-windows-forms-user-control-or-component"></a>Не удается выполнить отладку пользовательского элемента управления или компонента Windows Forms  
 Если элемент управления является производным от <xref:System.Windows.Forms.UserControl> класса, можно отлаживать его поведение во время выполнения с использованием тестового контейнера. Дополнительные сведения см. в разделе [Как Тестирование во время выполнения поведения элемента UserControl](how-to-test-the-run-time-behavior-of-a-usercontrol.md).  
  
 Другие настраиваемые элементы управления и компоненты не являются автономными проектами и должны размещаться в приложении, таком как проект Windows Forms. Для выполнения отладки элемент управления или компонент необходимо добавить в проект Windows Forms.  
  
#### <a name="to-debug-a-control-or-component"></a>Отладка элемента управления или компонента  
  
1. В меню **Сборка** выберите пункт **Сборка решения**, чтобы создать решение.  
  
2. В меню **Файл** выберите пункт **Добавить**, и затем **Новый проект**, чтобы добавить в приложение тестовый проект.  
  
3. В диалоговом окне **Добавление нового проекта** выберите в качестве типа проекта **Приложение Windows**.  
  
4. В **обозревателе решений** щелкните узел **Ссылки** для своего нового проекта правой кнопкой мыши. В контекстном меню выберите пункт **Добавить ссылку**, чтобы добавить ссылку на проект, содержащий элемент управления или компонент.  
  
5. Создайте экземпляр элемента управления или компонента в тестовом проекте. Если компонент находится на **панели элементов**, его можно перетащить в область конструктора или создать экземпляр программными средствами, как показано в следующем примере кода.  
  
    ```vb  
    Dim Component1 As New MyNeatComponent()  
    ```  
  
    ```csharp  
    MyNeatComponent Component1 = new MyNeatComponent();  
    ```  
  
     После этого отладку элемента управления или компонента можно выполнить в обычном режиме.  
  
 Дополнительные сведения об отладке см. в разделе [отладки в Visual Studio](/visualstudio/debugger/debugging-in-visual-studio) и [Пошаговое руководство: Отладка пользовательских Windows Forms элементы управления во время разработки](walkthrough-debugging-custom-windows-forms-controls-at-design-time.md).  
  
## <a name="event-is-raised-twice-in-inherited-control-or-component"></a>Событие в производном элементе управления или компоненте вызывается дважды  
 Это может быть связано с дублированием предложения `Handles`. Дополнительные сведения см. в разделе [Устранение неполадок, связанных с унаследованными обработчиками событий в Visual Basic](~/docs/visual-basic/programming-guide/language-features/events/troubleshooting-inherited-event-handlers.md).  
  
## <a name="design-time-error-failed-to-create-component-component-name"></a>Ошибка во время разработки. «Не удалось создать компонент 'Имя компонента'»  
 Компонент или элемент управления должен предоставлять конструктор по умолчанию без параметров. Если в среде разработки создается экземпляр компонента или элемента управления, он не пытается предоставить какие-либо параметры для перегрузок конструктора, принимающих параметры.  
  
## <a name="stathreadattribute"></a>STAThreadAttribute  
 <xref:System.STAThreadAttribute> Информирует общеязыковой среды выполнения (CLR) о том, что Windows Forms использует модель однопотокового подразделения. Если не применить этот атрибут к методу `Main` приложения Windows Forms, может возникнуть непредусмотренное поведение. Например, фоновые изображения может отображаться для элементов управления, например <xref:System.Windows.Forms.ListView>. Некоторым элементам управления этот атрибут может требоваться также для правильного выполнения операций автозаполнения и перетаскивания.  
  
## <a name="component-icon-does-not-appear-in-toolbox"></a>Значок компонента не отображается на панели элементов  
 При использовании <xref:System.Drawing.ToolboxBitmapAttribute> для сопоставления значка с настраиваемым, растровое изображение не отображается в панели элементов для автоматически созданных компонентов. Чтобы увидеть растровое изображение, перезагрузите элемент управления с помощью диалогового окна **Выбор элементов панели элементов**. Дополнительные сведения см. в разделе [Как Предоставление точечного рисунка панели элементов для элемента управления](how-to-provide-a-toolbox-bitmap-for-a-control.md).  
  
## <a name="see-also"></a>См. также

- [Создание элементов управления Windows Forms во время разработки](developing-windows-forms-controls-at-design-time.md)
- [Пошаговое руководство. Автоматическое заполнение панели элементов пользовательскими компонентами](walkthrough-automatically-populating-the-toolbox-with-custom-components.md)
- [Практическое руководство. Тестирование поведения элемента UserControl во время выполнения](how-to-test-the-run-time-behavior-of-a-usercontrol.md)
- [Пошаговое руководство. Отладка пользовательских элементов управления Windows Forms во время разработки](walkthrough-debugging-custom-windows-forms-controls-at-design-time.md)
- [Создание компонентов](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/5dya64wy(v=vs.120))
- [Устранение неполадок, возникающих в режиме разработки](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/ms171843(v=vs.120))
