---
description: 'Дополнительные сведения: <msmqIntegrationBinding>'
title: <msmqIntegrationBinding>
ms.date: 03/30/2017
helpviewer_keywords:
- msmqIntegrationBinding Element
ms.assetid: edf277f3-e3bf-4ed8-9f55-83b5788430a7
ms.openlocfilehash: 2745fdf1576d66e3e7c0c74d9b7d6f008fac88b8
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/06/2021
ms.locfileid: "99684247"
---
# \<msmqIntegrationBinding>

Определяет привязку, предоставляющую поддержку очередей путем маршрутизации сообщений с помощью MSMQ.  
  
[**\<configuration>**](../configuration-element.md)\
&nbsp;&nbsp;[**\<system.serviceModel>**](system-servicemodel.md)\
&nbsp;&nbsp;&nbsp;&nbsp;[**\<bindings>**](bindings.md)\
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[**\<customBinding>**](custombinding.md)\
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**\<binding>**\
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**\<msmqIntegrationBinding>**  
  
## <a name="syntax"></a>Синтаксис  
  
```xml  
<msmqIntegrationBinding>
  <binding closeTimeout="TimeSpan"
           customDeadLetterQueue="Uri"
           deadLetterQueue="Uri"
           durable="Boolean"
           exactlyOnce="Boolean"
           maxReceivedMessageSize="Integer"
           maxRetryCycles="Integer"
           name="String"
           openTimeout="TimeSpan"
           receiveContextEnabled="Boolean"
           receiveErrorHandling="Drop/Fault/Move/Reject"
           receiveTimeout="TimeSpan"
           receiveRetryCount="Integer"
           retryCycleDelay="TimeSpan"
           sendTimeout="TimeSpan"
           serializationFormat="XML/Binary/ActiveX/ByteArray/Stream"
           timeToLive="TimeSpan"
           useMsmqTracing="Boolean"
           useSourceJournal="Boolean">
  </binding>
</msmqIntegrationBinding>
```  
  
## <a name="attributes-and-elements"></a>Атрибуты и элементы  

 В следующих разделах описываются атрибуты, дочерние и родительские элементы.  
  
### <a name="attributes"></a>Атрибуты  
  
|Атрибут|Описание|  
|---------------|-----------------|  
|closeTimeout|Значение <xref:System.TimeSpan>, которое задает длительность времени ожидания для завершения операции закрытия. Это значение должно быть больше или равно <xref:System.TimeSpan.Zero>. Значение по умолчанию - 00:01:00.|  
|customDeadLetterQueue|Универсальный код ресурса (URI), который указывает местоположение очереди недоставленных сообщений для каждого приложения, куда помещаются сообщения с истекшим сроком или сообщения, которые не удалось передать или доставить.<br /><br /> Очередью недоставленных сообщений является очередь в диспетчере очередей отправившего приложения для сообщений с истекшим сроком, которые не удалось доставить.<br /><br /> Универсальный код ресурса (URI), определяемый свойством <xref:System.ServiceModel.MsmqBindingBase.CustomDeadLetterQueue%2A>, должен использовать схему net.msmq.|  
|deadLetterQueue|Значение <xref:System.ServiceModel.MsmqBindingBase.DeadLetterQueue%2A>, определяющее, какую очередь недоставленных сообщений следует использовать, если таковые имеются.<br /><br /> Очередь недоставленных сообщений - это расположение, в которое пересылаются сообщения, которые не удалось доставить приложению.<br /><br /> Для сообщений, которым требуется гарантия exactlyOnce (то есть атрибут `exactlyOnce` имеет значение `true`), этот атрибут по умолчанию указывает на транзакционную очередь недоставленных сообщений MSMQ для всей системы.<br /><br /> Для сообщений, которые не требуют гарантии, по умолчанию этот атрибут имеет значение `null`.|  
|durable|Логическое значение, указывающее, является ли сообщение в очереди постоянным или переменным. Постоянное сообщение сохраняется после сбоя диспетчера очередей, а переменное сообщение — нет. Переменные сообщения используются, если для приложений требуются небольшие задержки, и приложения допускают периодические потери сообщений. Если атрибут `exactlyOnce` имеет значение `true`, сообщения должны быть постоянными. Значение по умолчанию — `true`.|  
|exactlyOnce|Логическое значение, указывающее, доставляется ли каждое сообщение только один раз. Затем отправитель оповещается об ошибках доставки. Если `durable` имеет значение `false`, этот атрибут не учитывается и сообщения пересылаются без гарантии доставки. Значение по умолчанию — `true`. Для получения дополнительной информации см. <xref:System.ServiceModel.MsmqBindingBase.ExactlyOnce%2A>.|  
|maxReceivedMessageSize|Положительное целое число, определяющее максимальный размер сообщения (в байтах), включая заголовки, которое обрабатывается этой привязкой. Отправитель сообщения, превышающего это ограничение, получит ошибку SOAP. Получатель отклоняет сообщение и создает запись о событии в журнале трассировки. Значение по умолчанию — 65536. Это ограничение размера сообщения предназначено для уменьшения уязвимости к атакам типа «отказ в обслуживании» (DoS).|  
|maxRetryCycles|Целое число, указывающее количество циклов повтора, используемых возможностью обнаружения подозрительных сообщений. Сообщение становится подозрительным, если попытки доставки во всех циклах закончились неудачей. Значение по умолчанию — 2 Для получения дополнительной информации см. <xref:System.ServiceModel.MsmqBindingBase.MaxRetryCycles%2A>.|  
|name|Строка, содержащая имя конфигурации привязки. Это значение должно быть уникальным, поскольку оно используется в качестве идентификатора привязки. Начиная с платформа .NET Framework 4, привязки и поведения не обязательно должны иметь имя. Дополнительные сведения о конфигурации по умолчанию и привязках и поведении, которые не имеют имен, см. в разделе [упрощенная конфигурация](../../../wcf/simplified-configuration.md) и [упрощенная конфигурация для служб WCF](../../../wcf/samples/simplified-configuration-for-wcf-services.md).|  
|openTimeout|Значение <xref:System.TimeSpan>, которое задает длительность времени ожидания для завершения операции открытия. Это значение должно быть больше или равно <xref:System.TimeSpan.Zero>. Значение по умолчанию - 00:01:00.|  
|receiveErrorHandling|Значение <xref:System.ServiceModel.ReceiveErrorHandling>, указывающее, каким образом будут обрабатываться подозрительные сообщения и сообщения, которые не удалось доставить.|  
|receiveRetryCount|Целое число, задающее максимальное число немедленных повторных попыток, которые должен выполнить диспетчер очереди, если не удается выполнить передачу сообщения из очереди приложения в приложение.<br /><br /> Если выполнено максимальное количество попыток доставки, а приложение не имеет доступа к сообщению, сообщение помещается в очередь повторного выполнения для повторной доставки через некоторое время. Время до повторного помещения сообщения в очередь отправки указывается в свойстве `retryCycleDelay`. Если число повторных попыток достигает значения `maxRetryCycles`, то сообщение отправляется в очередь подозрительных сообщений или отправителю отсылается уведомление о том, что сообщение не может быть доставлено.|  
|receiveTimeout|Значение <xref:System.TimeSpan>, которое задает длительность времени ожидания для завершения операции получения. Это значение должно быть больше или равно <xref:System.TimeSpan.Zero>. Значение по умолчанию - 00:10:00.|  
|receiveContextEnabled|Логическое значение, указывающее, включен ли контекст получения для обработки сообщений в очередях. Если задано значение `true` , служба может "Просмотреть" сообщение в очереди, чтобы начать его обработку, и, если что-то пойдет не так и исключение будет создано, оно останется в очереди. Службы также могут "блокировать" сообщения для повторной обработки в более поздний момент времени. Объект ReceiveContext предоставляет механизм для «завершения» сообщения после обработки, чтобы его можно было удалить из очереди. Сообщения больше не считываются и не переписываются в очереди по сети, а отдельные сообщения не переносятся между разными экземплярами службы во время обработки.|  
|retryCycleDelay|Значение TimeSpan, которое задает временную задержку между циклами повторов при попытке доставить сообщение, которое не удалось доставить сразу. Значение определяет только минимальное время ожидания, поскольку фактическое время ожидания может быть больше. Значение по умолчанию - 00:30:00. Для получения дополнительной информации см. <xref:System.ServiceModel.MsmqBindingBase.RetryCycleDelay%2A>.|  
|sendTimeout|Значение <xref:System.TimeSpan>, которое задает длительность времени ожидания для завершения операции отправки. Это значение должно быть больше или равно <xref:System.TimeSpan.Zero>. Значение по умолчанию - 00:01:00.|  
|serializationFormat|Определяет формат, используемый для сериализации текста сообщения. Это атрибут типа <xref:System.ServiceModel.MsmqIntegration.MsmqMessageSerializationFormat>.|  
|timeToLive|Значение TimeSpan, указывающее, как долго сообщения остаются действительными до истечения их срока, после чего они переводятся в очередь недоставленных сообщений. Значение по умолчанию - 1.00:00:00.<br /><br /> Этот атрибут устанавливается для предотвращения устаревания срочных сообщений до их обработки получающими приложениями. Сообщение в очереди, которое не поступает в принимающее приложение в пределах заданного интервала времени, считается устаревшим. Устаревшие сообщения отправляются в специальную очередь, называемую очередью недоставленных сообщений. Расположение очереди недоставленных сообщений задается атрибутом `DeadLetterQueue`, или оно устанавливается на основании гарантий в соответствующее значение по умолчанию.|  
|useMsmqTracing|Логическое значение, указывающее, должна ли выполняться трассировка сообщений, обрабатываемых этой привязкой. Значение по умолчанию — `false`. Если трассировка включена, каждый раз, когда сообщение отправляется с компьютера службы очередей или поступает на этот компьютер, создаются сообщения-отчеты, которые затем отправляются в очередь отчетов.|  
|useSourceJournal|Логическое значение, которое указывает, должны ли копии сообщений, обрабатываемых этой привязкой, храниться в журнале источников. Значение по умолчанию — `false`.<br /><br /> Использующие очереди приложения, которым нужно хранить запись сообщений, покинувших очередь исходящих сообщений компьютера, могут копировать сообщения в журнал компьютера. После того как сообщение покинуло очередь исходящих сообщений, и появилось подтверждение приема сообщения конечным компьютером, в очереди системного журнала компьютера-отправителя сохраняется копия сообщения.|  
  
## <a name="serializationformat-attribute"></a>Атрибут {serializationFormat}  
  
|Значение|Описание|  
|-----------|-----------------|  
|Xml|Формат XML|  
|Двоичные данные|Двоичный формат|  
|ActiveX|Формат ActiveX|  
|ByteArray|Сериализует объект в массив байтов.|  
|Поток|Текст в формате потока|  
  
### <a name="child-elements"></a>Дочерние элементы  
  
|Элемент|Описание|  
|-------------|-----------------|  
|[\<security>](security-of-msmqintegrationbinding.md)|Определяет параметры безопасности привязки. Это элемент типа <xref:System.ServiceModel.Configuration.MsmqIntegrationSecurityElement>.|  
  
### <a name="parent-elements"></a>Родительские элементы  
  
|Элемент|Описание|  
|-------------|-----------------|  
|[\<bindings>](bindings.md)|Этот элемент содержит коллекцию стандартных и пользовательских привязок.|  
  
## <a name="remarks"></a>Remarks  

 Этот элемент привязки можно использовать для того, чтобы приложения Windows Communication Foundation (WCF) могли отправлять сообщения и получать сообщения из существующих приложений MSMQ, использующих COM, собственные API MSMQ или типы, определенные в <xref:System.Messaging?displayProperty=nameWithType> пространстве имен. Этот элемент конфигурации можно использовать для указания способов адресации очереди, передачи данных о том, должны ли надежно храниться сообщения и как сообщения должны быть защищены и проверены. Дополнительные сведения см. [в разделе как обмениваться сообщениями с конечными точками WCF и приложениями очереди сообщений](../../../wcf/feature-details/how-to-exchange-messages-with-wcf-endpoints-and-message-queuing-applications.md).  
  
## <a name="example"></a>Пример  
  
```xml  
<configuration>
  <system.ServiceModel>
    <bindings>
      <msmqIntegrationBinding>
        <binding closeTimeout="00:00:10"
                 openTimeout="00:00:20"
                 receiveTimeout="00:00:30"
                 sendTimeout="00:00:40"
                 deadLetterQueue="net.msmq://localhost/blah"
                 durable="true"
                 exactlyOnce="true"
                 maxReceivedMessageSize="1000"
                 maxImmediateRetries="11"
                 maxRetryCycles="12"
                 poisonMessageHandling="Disabled"
                 rejectAfterLastRetry="false"
                 retryCycleDelay="00:05:55"
                 timeToLive="00:11:11"
                 useSourceJournal="true"
                 useMsmqTracing="true"
                 serializationFormat="Binary">
          <security mode="None" />
        </binding>
      </msmqIntegrationBinding>
    </bindings>
  </system.ServiceModel>
</configuration>
```  
  
## <a name="see-also"></a>См. также

- <xref:System.ServiceModel.Configuration.MsmqIntegrationBindingElement>
- <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding>
- <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBindingElement>
- [\<binding>](bindings.md)
- [Привязки](../../../wcf/bindings.md)
- [Настройка привязок, предоставляемых системой](../../../wcf/feature-details/configuring-system-provided-bindings.md)
- [Использование привязок для настройки служб и клиентов](../../../wcf/using-bindings-to-configure-services-and-clients.md)
- [Очереди в WCF](../../../wcf/feature-details/queues-in-wcf.md)
