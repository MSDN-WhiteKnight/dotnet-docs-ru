---
title: Практическое руководство. Условная компиляция с использованием атрибутов Trace и Debug
description: Узнайте, как выполнять условную компиляцию с помощью условных атрибутов TRACE и DEBUG при компиляции приложения .NET.
ms.date: 03/30/2017
helpviewer_keywords:
- trace compiler options
- trace statements
- compiling source code, trace statements
- tracing [.NET Framework], enabling or disabling
- tracing [.NET Framework], compiling conditionally
- TRACE directive
- conditional compilation, tracing code
ms.assetid: 56d051c3-012c-42c1-9a58-7270edc624aa
ms.openlocfilehash: 90c989bcf21e24cf7ccf410c9a18a44cde81233e
ms.sourcegitcommit: 0bb8074d524e0dcf165430b744bb143461f17026
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/15/2021
ms.locfileid: "103478218"
---
# <a name="how-to-compile-conditionally-with-trace-and-debug"></a>Практическое руководство. Условная компиляция с использованием атрибутов Trace и Debug

При отладке приложения во время разработки выходные данные трассировки и отладки отображаются в окне «Вывод» Visual Studio. Однако чтобы включить возможности трассировки в развернутом приложении, необходимо скомпилировать инструментированные приложения с включенной директивой компилятора **TRACE**. Это позволяет компилировать код трассировки в выпускаемой версии приложения. Если не включить директиву **TRACE**, весь код трассировки игнорируется во время компиляции и не включается в исполняемый код, который будет развернут.  
  
 Методы трассировки и отладки имеют связанные условные атрибуты. Например, если условный атрибут трассировки имеет значение **true**, все операторы трассировки включаются в сборку (компилированные файлы .exe или .dll); если условный атрибут **Trace** имеет значение **false**, операторы трассировки не включаются.  
  
 Для сборки можно включить условный атрибут **Trace** или **Debug**, оба эти атрибута одновременно или ни один из них. Следовательно, существует четыре типа сборки: **Debug**, **Trace**, обе или ни одной. Некоторые сборки выпуска для продуктивного развертывания могут не содержать ни одну из них, однако большинство сборок отладки содержат обе.  
  
 Можно задать параметры компилятора для вашего приложения несколькими способами.  
  
- Страницы свойств  
  
- Командная строка  
  
- Оператор **#CONST** (для Visual Basic) и **#define** (для C#)  
  
### <a name="to-change-compile-settings-from-the-property-pages-dialog-box"></a>Изменить параметры компиляции можно в диалоговом окне «Страницы свойств».  
  
1. В **обозревателе решений** щелкните узел проекта правой кнопкой.  
  
2. Выберите в контекстном меню команду **Свойства**.  
  
    - В Visual Basic щелкните вкладку **Компиляция** в левой области страницы свойств, затем щелкните **Дополнительные параметры компиляции**, чтобы отобразить диалоговое окно **Дополнительные параметры компилятора**. Установите флажки для параметров компилятора, которые необходимо включить. Снимите флажки для параметров, которые необходимо отключить.  
  
    - В C# выберите **Построить** в левой области страницы свойств, а затем установите флажки для параметров компилятора, которые нужно включить. Снимите флажки для параметров, которые необходимо отключить.  
  
### <a name="to-compile-instrumented-code-using-the-command-line"></a>Компиляция инструментированного кода с помощью командной строки  
  
1. Задайте условный параметр компилятора в командной строке. Компилятор включит код трассировки или отладки в исполняемый файл.  
  
     Например, следующая инструкция компилятора, введенная в командной строке, включит код трассировки в компилируемый исполняемый файл.  
  
     Для Visual Basic: **vbc -r:System.dll-д:траце = true-д:дебуг = false MyApplication. vb**  
  
     Для C#: **csc -r:System.dll-д:траце-д:дебуг = FALSE MyApplication.CS**  
  
    > [!TIP]
    > Чтобы скомпилировать несколько файлов приложений, оставьте пробел между именами файлов, например **MyApplication1.vb MyApplication2.vb MyApplication3.vb** или **MyApplication1.cs MyApplication2.cs MyApplication3.cs**.  
  
     Директивы условной компиляции, используемые в приведенных выше примерах, имеют следующие значения.  
  
    |Директива|Значение|  
    |---------------|-------------|  
    |`vbc`|компилятор Visual Basic|  
    |`csc`|Компилятор C#|  
    |`-r:`|Ссылка на внешнюю сборку (EXE или DLL)|  
    |`-d:`|Определяет символ условной компиляции|  
  
    > [!NOTE]
    > Необходимо ввести команды TRACE или DEBUG буквами верхнего регистра. Для получения дополнительных сведений о командах условной компиляции введите `vbc /?` (для Visual Basic) или `csc /?` (для C#) в командной строке. Дополнительные сведения см. в разделах [Построение из командной строки](../../csharp/language-reference/compiler-options/index.md) (C#) или [Вызов компилятора командной строки](../../visual-basic/reference/command-line-compiler/how-to-invoke-the-command-line-compiler.md) (Visual Basic).  
  
### <a name="to-perform-conditional-compilation-using-const-or-define"></a>Выполнение условной компиляции с помощью #CONST или #define  
  
1. Введите соответствующую инструкцию для используемого языка программирования в верхней части файла исходного кода.  
  
    |Язык|Инструкция|Result|  
    |--------------|---------------|------------|  
    |**Visual Basic**|**#CONST TRACE = true**|Включает трассировку|  
    ||**#CONST TRACE = false**|Отключает трассировку|  
    ||**#CONST DEBUG = true**|Включает отладку|  
    ||**#CONST DEBUG = false**|Отключает отладку|  
    |**C#**|**#define TRACE**|Включает трассировку|  
    ||**#undef TRACE**|Отключает трассировку|  
    ||**#define DEBUG**|Включает отладку|  
    ||**#undef DEBUG**|Отключает отладку|  
  
### <a name="to-disable-tracing-or-debugging"></a>Отключение трассировки или отладки  
  
Удалите директиву компилятора из исходного кода.  
  
\- или -  
  
Удалите комментарий к директиве компилятора.  
  
> [!NOTE]
> Когда все готово для компиляции, можно выбрать команду **Построить** из меню **Сборка** или использовать метод командной строки (но без ввода **d:**), чтобы определить символы условной компиляции.  
  
## <a name="see-also"></a>См. также раздел

- [Трассировка и инструментирование приложений](tracing-and-instrumenting-applications.md)
- [Практическое руководство. Создание, инициализация и настройка переключателей трассировки](how-to-create-initialize-and-configure-trace-switches.md)
- [Переключатели трассировки](trace-switches.md)
- [Прослушиватели трассировки](trace-listeners.md)
- [Практическое руководство. Добавление операторов трассировки в код приложения](how-to-add-trace-statements-to-application-code.md)
- [Практическое руководство. Настройка переменных среды для командной строки Visual Studio](../../csharp/language-reference/compiler-options/index.md)
- [Практическое руководство. Вызов компилятора командной строки](../../visual-basic/reference/command-line-compiler/how-to-invoke-the-command-line-compiler.md)
