---
description: 'Подробнее: определение области определения действия и видимость'
title: Определение области и видимости действия
ms.date: 03/30/2017
ms.assetid: ccdffa07-9503-4eea-a61b-17f1564368b7
ms.openlocfilehash: ab779fe36473a8888ee0fb0c1b94f1ea6324f991
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/06/2021
ms.locfileid: "99787972"
---
# <a name="activity-definition-scoping-and-visibility"></a>Определение области и видимости действия

Определение области и видимость определения действия, как и область и видимость объекта, ― это возможность других объектов или действий работать с элементами этого действия. Определение действия выполняется следующими реализациями.  
  
1. Определение элементов (объектов <xref:System.Activities.Argument>, <xref:System.Activities.Variable> и <xref:System.Activities.ActivityDelegate>, а также дочерних действий), доступ к которым действие предоставляет для других пользователей.  
  
2. Реализация логики выполнения действия  
  
 Эта реализация может включать элементы, доступ к которым не предоставляется получателями действия, но которые скорее являются деталями реализации.  Так же как и в определении типа, модель действия позволяет автору квалифицировать видимость элемента действия в отношении создаваемого определения действия.  Эта видимость управляет аспектами использования элемента, например областями определения данных.  
  
## <a name="scope"></a>Область  

 Помимо определения области данных, с помощью видимости модели действия можно ограничить доступ к другим аспектам действия, например проверке, отладке, отслеживанию или трассировке. С помощью видимости и определения области свойства выполнения ограничивают характеристики выполнения конкретной областью определения. Вторичные корни используют видимость и определение области для ограничения состояния, записываемого действием <xref:System.Activities.Statements.CompensableActivity> областью определения, в которой применяются подлежащие компенсации действия.  
  
## <a name="definition-and-usage"></a>Определение и использование  

 Рабочий процесс создается путем создания новых действий путем наследования от базовых классов действий, а также с помощью действий из [встроенной библиотеки действий](net-framework-4-5-built-in-activity-library.md). Чтобы использовать действие, автор действия должен настроить видимость каждого компонента его определения.  
  
### <a name="activity-members"></a>Элементы действия  

 Модель действия определяет аргументы, переменные, делегаты и дочерние действия, доступ к которым действие предоставляет получателям. Каждый из этих элементов может быть объявлен как `public` или `private`. Элементы public настраиваются объектом-получателем действия, а элементы `private` используют реализацию, назначенную действию автором. Существуют следующие правила видимости для определения области данных.  
  
1. Открытые элементы и открытые элементы открытых дочерних действий могут ссылаться на открытые переменные.  
  
2. Закрытые элементы и открытые элементы открытых дочерних действий могут ссылаться на аргументы и закрытые переменные.  
  
 Элемент, который может задаваться объектом-получателем действия, нельзя делать закрытым.  
  
### <a name="authoring-models"></a>Режимы разработки  

 Настраиваемые действия определяются с помощью действия <xref:System.Activities.NativeActivity>, <xref:System.Activities.Activity>, <xref:System.Activities.CodeActivity> или <xref:System.Activities.AsyncCodeActivity>. Действия, которые наследуют от этих классов, могут предоставлять доступ к элементам разных типов с различной видимостью.  
  
#### <a name="nativeactivity"></a>NativeActivity  

 Действия, которые наследуют от действия <xref:System.Activities.NativeActivity>, имеют режим, написанный с помощью императивного кода, их также можно определять с помощью существующих действий. При создании действий на основе действия <xref:System.Activities.NativeActivity> предоставляется доступ ко всем возможностям среды выполнения. Любой элемент такого действия можно определить с помощью открытой или закрытой видимости. Исключениями являются аргументы, которые можно объявлять только как `public`.  
  
 Элементы классов, которые наследуют от действия <xref:System.Activities.NativeActivity>, объявляются в среде выполнения с помощью структуры <xref:System.Activities.NativeActivityMetadata>, которая передается методу <xref:System.Activities.NativeActivity.CacheMetadata%2A>.  
  
#### <a name="activity"></a>Действие  

 Действия, создаваемые с помощью действия <xref:System.Activities.Activity>, имеют режим, который сконструирован исключительно путем составления других действий. Класс <xref:System.Activities.Activity> имеет одно дочернее действие реализации, получаемое средой выполнения с помощью реализации <xref:System.Activities.Activity.Implementation%2A>. Действие, наследующее от действия <xref:System.Activities.Activity>, может определять открытые аргументы, открытые переменные, импортируемые ActivityDelegates и импортируемые Activities.  
  
 Импортируемые ActivityDelegates и Activities объявляются как открытые дочки действия, при этом действие не может планировать их напрямую. Эти данные используются во время проверки во избежание выполнения проверок с использованием родителя в тех местах, где действие никогда не будет выполняться. Кроме того, импортируемые дочерние действия, как и открытые дочерние действия, могут указываться по ссылке и планироваться реализацией действия. Это означает, что действие, которое импортирует действие Activity1, может содержать в своей реализации <xref:System.Activities.Statements.Sequence>, которая планирует Activity1.  
  
#### <a name="codeactivity-asynccodeactivity"></a>CodeActivity/ AsyncCodeActivity  

 Этот базовый класс используется для создания режима на императивном коде. Действия, наследуемые от этого класса, имеют доступ только к предоставляемым ими аргументам. Это означает, что эти действия могут предоставлять только открытые аргументы. Другие элементы или видимости к этим действиям не применяются.  
  
#### <a name="summary-of-visibilities"></a>Сводка видимостей  

 В следующей таблице кратко суммированы данные, приведенные в этом разделе.  
  
|Тип члена|NativeActivity|Действие|CodeActivity/ AsyncCodeActivity|  
|-----------------|--------------------|--------------|--------------------------------------|  
|Аргументы|Открытый/закрытый|Открытый|Неприменимо|  
|Переменные|Открытый/закрытый|Открытый|Неприменимо|  
|Дочерние действия|Открытый/закрытый|Открытый, один фиксированный закрытый дочерний элемент, определенный в реализации.|Неприменимо|  
|ActivityDelegates|Открытый/закрытый|Открытый|Неприменимо|  
  
 В общем, элемент, который не может задаваться объектом-получателем действия, нельзя делать открытым.  
  
### <a name="execution-properties"></a>Свойства выполнения  

 В некоторых сценариях полезно ограничить область конкретного свойства выполнения открытыми дочками действия. Коллекция <xref:System.Activities.ExecutionProperties> предоставляет эту возможность с помощью метода <xref:System.Activities.ExecutionProperties.Add%2A>. У этого метода есть логический параметр, указывающий, ограничено ли данное свойство всеми дочерними элементами или только открытыми дочерними элементами. Если этому параметру задано значение `true`, то свойство будет видимо только открытым элементам, а также открытым элементам открытых дочерних элементов этих элементов.  
  
### <a name="secondary-roots"></a>Вторичные корни  

 Вторичный корень ― это внутренний механизм среды выполнения для сопоставления состояния для действий компенсации. Когда действие <xref:System.Activities.Statements.CompensableActivity> завершило работу, его состояние не очищается немедленно. Вместо этого среда выполнения сохраняет состояние во вторичном корне до завершения компенсации. Среды местоположения, записываемые с помощью вторичного корня, соответствуют области определения, в которой используется компенсируемое действие.
