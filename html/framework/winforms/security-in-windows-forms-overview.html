<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>&#1054;&#1073;&#1097;&#1080;&#1077; &#1089;&#1074;&#1077;&#1076;&#1077;&#1085;&#1080;&#1103; &#1086; &#1073;&#1077;&#1079;&#1086;&#1087;&#1072;&#1089;&#1085;&#1086;&#1089;&#1090;&#1080; &#1074; Windows Forms | &#1053;&#1077;&#1086;&#1092;&#1080;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1072;&#1103; &#1076;&#1086;&#1082;&#1091;&#1084;&#1077;&#1085;&#1090;&#1072;&#1094;&#1080;&#1103; .NET </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="&#1054;&#1073;&#1097;&#1080;&#1077; &#1089;&#1074;&#1077;&#1076;&#1077;&#1085;&#1080;&#1103; &#1086; &#1073;&#1077;&#1079;&#1086;&#1087;&#1072;&#1089;&#1085;&#1086;&#1089;&#1090;&#1080; &#1074; Windows Forms | &#1053;&#1077;&#1086;&#1092;&#1080;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1072;&#1103; &#1076;&#1086;&#1082;&#1091;&#1084;&#1077;&#1085;&#1090;&#1072;&#1094;&#1080;&#1103; .NET ">
    <meta name="generator" content="docfx 2.40.12.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="security-in-windows-forms-overview">Общие сведения о безопасности в Windows Forms</h1>

<p>До выпуска .NET Framework весь код, выполняемый на компьютере пользователя, имел те же права и разрешения на доступ к ресурсам, которыми обладал пользователь компьютера. Например, если пользователю был разрешен доступ к файловой системе, то код также получал доступ к файловой системе Если пользователю был разрешен доступ к базе данных, то и коду предоставлялся доступ к ней. Наличие таких прав или разрешений может быть допустимо для кода в исполняемых файлах, которые пользователь собственноручно установил на локальном компьютере, но оно неприемлемо в тех случаях, когда речь идет о потенциально вредоносном коде, поступившем из Интернета или локальной интрасети. Такой код не должен получать доступ к ресурсам компьютера пользователя без его разрешения.</p>
<p>В .NET Framework появилась инфраструктура, которая называется управлением доступом для кода. Она позволяет разграничивать права и разрешения, которыми обладает пользователь и код. По умолчанию код, поступающий из Интернета или интрасети, может выполняться только в режиме частичного доверия. В режиме частичного доверия приложение подвергается ряду ограничений: помимо всего прочего, приложению отказано в доступе к локальным жестким дискам, и оно не может запускать неуправляемый код. Платформа .NET Framework управляет ресурсами, к которым код может получить доступ, на основе идентификатора этого кода: его происхождения, имеет ли он <a href="../app-domains/strong-named-assemblies.md">сборки со строгими именами</a>, подписан ли он с помощью сертификата и т. д.</p>
<p>ClickOnce Технология, используемая для развертывания приложений Windows Forms, помогает упростить разработку приложений, работающих в режиме частичного доверия, с полным доверием или с частичным доверием с повышенным уровнем разрешений. ClickOnce предоставляет функции, такие как повышение уровня разрешений и развертывание доверенного приложения, чтобы приложение может запросить полное доверие или повышенный уровень разрешений у локального пользователя подобающим образом.</p>
<h2 id="understanding-security-in-the-net-framework">Общее представление о безопасности в .NET Framework</h2>
<p>Управление доступом для кода позволяет считать код надежным в той или иной степени в зависимости от происхождения кода и других аспектов его удостоверения. Подробнее о данных, на основании которых среда CLR определяет политику безопасности, см. в разделе <a href="https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/7y5x1hcd(v=vs.100)">Свидетельство</a>. Это помогает защитить компьютеры от вредоносного кода, а доверенный код — от умышленного или случайного нарушения безопасности. Управление доступом для кода также позволяет лучше контролировать действия, которые может выполнять приложение, так как вы можете указать только те разрешения, которые необходимы для работы приложения. Управление доступом для кода влияет на весь управляемый код, который предназначен для среды CLR, даже если этот код не производит ни одной проверки разрешений, предоставленных посредством управления доступом для кода. Подробнее о безопасности в .NET Framework см. в разделах <a href="../../standard/security/key-security-concepts.md">Основные понятия безопасности</a> и <a href="../misc/code-access-security-basics.md">Основы управления доступом для кода</a>.</p>
<p>Если пользователь запускает исполняемый файл Windows Forms непосредственно с веб-сервера или из общей папки, то степень доверия, предоставляемая приложению, зависит от того, где размещается код и как он запущен. При запуске приложения происходит его автоматическая оценка, после которой приложение получает именованный набор разрешений от среды CLR. По умолчанию код на локальном компьютере получает набор разрешений полного доверия, код из локальной сети — набор разрешений локальной интрасети, а код из Интернета — набор разрешений Интернета.</p>
<div class="NOTE">
<h5>Note</h5>
<p>В .NET Framework версии 1.0 с пакетами обновления 1 (SP1) и 2 (SP2) код из Интернета получает набор разрешений Nothing. Во всех остальных выпусках .NET Framework код из Интернета получает набор разрешений Интернета.</p>
<p>Разрешения по умолчанию, которые содержатся в этих наборах, приведены в разделе <a href="https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/03kwzyfc(v=vs.100)">Политика безопасности по умолчанию</a>. В зависимости от разрешений, которые получает приложение, оно выполняется правильно либо вызывает исключение безопасности.</p>
<p>Многие приложения Windows Forms развертываются с помощью ClickOnce. Уровни безопасности по умолчанию средств, используемых для реализации развертывания ClickOnce, отличаются от тех, которые обсуждались ранее. Подробнее см. далее в этом разделе.</p>
</div>
<p>Разрешения, предоставленные приложению, могут отличаться от разрешений по умолчанию, потому что политика безопасности может быть изменена. Это означает, что приложение может иметь некоторые разрешения на одном компьютере, но не иметь их на другом.</p>
<h2 id="developing-a-more-secure-windows-forms-application">Разработка более безопасных приложений Windows Forms</h2>
<p>Безопасность важна на всех этапах разработки приложения. Начните с анализа и выполнения <a href="../../standard/security/secure-coding-guidelines.md">правил написания безопасного кода</a>.</p>
<p>Далее необходимо решить, будет ли приложение выполняться в режиме полного или частичного доверия. Выполнение приложения в режиме полного доверия облегчает доступ к ресурсам на локальном компьютере, но подвергает приложение и его пользователей высокому риску нарушения безопасности, если приложение проектировалось и разрабатывалось без строгого соблюдения правил написания безопасного кода. Выполнение приложения в режиме частичного доверия облегчает разработку более безопасных приложений и сокращает риски, но требует более тщательного планирования реализации некоторых возможностей.</p>
<p>Если используется частичное доверие (т. е. наборы разрешений &quot;Интернет&quot; или &quot;Локальная интрасеть&quot;), определите, как должно вести себя приложение в этой среде. Windows Forms предоставляет более безопасные альтернативные способы реализации возможностей приложения в среде с частичным доверием. Определенные части приложения, например отвечающие за доступ к данным, могут быть разработаны и написаны по-разному для среды с частичным доверием и среды с полным доверием. Некоторые возможности Windows Forms, такие как параметры приложения, предназначены для работы в среде с частичным доверием. Подробнее см. в разделе <a href="advanced/application-settings-overview.html">Общие сведения о параметрах приложений</a>.</p>
<p>Если приложению требуется больше разрешений, чем позволяет среда с частичным доверием, однако предоставлять ему разрешения полного доверия нежелательно, можно работать в режиме частичного доверия, запросив только необходимые дополнительные разрешения. Например, если требуется работать в режиме частичного доверия, но необходимо предоставить приложению доступ только для чтения к каталогу в файловой системе пользователя, можно запросить разрешение <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.security.permissions.fileiopermission">FileIOPermission</a> только для этого каталога. При правильном применении этот подход может расширять функциональные возможности приложения и снижать угрозу безопасности для пользователей.</p>
<p>При разработке приложения, которое будет выполняться в среде с частичным доверием, отслеживайте, какие разрешения обязательны для его работы и какие могут использоваться им дополнительно. Когда известны все разрешения, необходимо подать декларативный запрос на разрешения на уровне приложения. Запрос разрешений уведомляет среду времени выполнения .NET Framework о необходимых разрешениях и тех разрешениях, предоставлять которые не требуется. Дополнительные сведения о запросе разрешений см. в разделе <a href="https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/yd267cce(v=vs.100)">Запрос разрешений</a>.</p>
<p>При запросе необязательных разрешений необходимо обработать исключения безопасности, которые могут возникнуть, если приложение выполнит действие, требующее разрешений, которые не были предоставлены. Корректная обработка исключения <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.security.securityexception">SecurityException</a> гарантирует, что приложение будет продолжать работать. Приложение может использовать исключения для определения того, следует ли отключить ту или иную возможность для пользователя. Например, приложение может отключить команду меню <strong>Сохранить</strong>, если не предоставлено соответствующее разрешение.</p>
<p>Иногда трудно определить, запрошены ли все необходимые разрешения. Например, вызов метода, который на первый взгляд выглядит вполне безобидно, может во время выполнения в какой-то момент обращаться к файловой системе. Если не выполнить развертывание приложения со всеми требуемыми разрешениями, оно может работать корректно при отладке, но отказать при развертывании. Оба .NET Framework 2.0 SDK и Visual Studio 2005 имеются средства для определения разрешений, необходимых приложению: MT.exe командной строки и функция вычисления разрешений Visual Studio, соответственно.</p>
<p>Дополнительные функции обеспечения безопасности Windows Forms описаны в представленных ниже разделах.</p>
<table>
<thead>
<tr>
<th>Раздел</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>-   <a href="more-secure-file-and-data-access-in-windows-forms.html">Более безопасный доступ к файлам и данным в Windows Forms</a></td>
<td>Описание доступа к файлам и данным в среде с частичным доверием.</td>
</tr>
<tr>
<td>-   <a href="more-secure-printing-in-windows-forms.html">Более безопасная печать в Windows Forms</a></td>
<td>Описание доступа к возможностям печати в среде с частичным доверием.</td>
</tr>
<tr>
<td>-   <a href="additional-security-considerations-in-windows-forms.html">Дополнительные вопросы безопасности в формах Windows Forms</a></td>
<td>Описание способов работы с окнами с помощью буфера обмена и вызова неуправляемого кода в среде с частичным доверием.</td>
</tr>
</tbody>
</table>
<p>-</p>
<h3 id="deploying-an-application-with-the-appropriate-permissions">Развертывание приложения с соответствующими разрешениями</h3>
<p>Чаще всего приложение Windows Forms развертывается на клиентском компьютере с использованием ClickOnce — технологии развертывания, которая описывает все компоненты, необходимые для запуска приложения. ClickOnce используются XML-файлы, называемые манифестами для описания сборок и файлов, входящих в состав приложения, а также разрешения приложения.</p>
<p>ClickOnce имеет две технологии запроса повышенного уровня разрешений на клиентском компьютере. Обе технологии основаны на использовании сертификатов Authenticode. Сертификаты предоставляют пользователям некоторые гарантии того, что приложение поступило из надежного источника.</p>
<p>Эти технологии описаны в приведенной ниже таблице.</p>
<table>
<thead>
<tr>
<th>Технология повышения уровня разрешений</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>Повышение уровня разрешений</td>
<td>Запрашивает пользователя с помощью диалогового окна безопасности при первом запуске приложения. Диалоговое окно <strong>Повышение разрешений</strong> информирует пользователя об издателе приложения, чтобы пользователь мог принять обоснованное решение в отношении того, следует ли предоставлять приложению дополнительное доверие.</td>
</tr>
<tr>
<td>Развертывание надежных приложений</td>
<td>Предусматривает однократную установку сертификата Authenticode издателя на клиентском компьютере, выполняемую системным администратором. С этого момента любые приложения, подписанные этим сертификатом, будут рассматриваться как надежные, и их можно будет запускать с полным доверием на локальном компьютере без дополнительных запросов.</td>
</tr>
</tbody>
</table>
<p>Выбор технологии зависит от среды развертывания. Подробнее см. в разделе <a href="/visualstudio/deployment/choosing-a-clickonce-deployment-strategy">Выбор стратегии развертывания ClickOnce</a>.</p>
<p>По умолчанию ClickOnce приложений, развернутых с помощью Visual Studio или .NET Framework 2.0 средств SDK (Mage.exe и MageUI.exe), настроенных для запуска на клиентском компьютере с полным доверием. При развертывании приложения с помощью частичного доверия или с помощью только некоторых дополнительных разрешений необходимо изменить эту настройку по умолчанию. Это можно сделать с помощью Visual Studio или .NET Framework 2.0 SDK средства MageUI.exe при настройке развертывания. Дополнительные сведения об использовании MageUI.exe см. пошаговое руководство: Развертывание приложения ClickOnce из командной строки.  Также см. раздел <a href="https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2012/hafybdaa(v=vs.110)">Как Установка пользовательских разрешений для ClickOnce-приложения</a> или <a href="/visualstudio/deployment/how-to-set-custom-permissions-for-a-clickonce-application">как: Установка пользовательских разрешений для ClickOnce-приложения</a>.</p>
<p>Подробнее об аспектах безопасности ClickOnce и повышении уровня разрешений см. в разделе <a href="/visualstudio/deployment/securing-clickonce-applications">Развертывание и защита приложений ClickOnce</a>. Подробнее о развертывании доверенных приложений см. в разделе <a href="/visualstudio/deployment/trusted-application-deployment-overview">Общие сведения о развертывании доверенных приложений</a>.</p>
<h3 id="testing-the-application">Тестирование приложения</h3>
<p>Если вы развернули приложение Windows Forms с помощью Visual Studio, вы можете включить отладку в режиме частичного доверия или с ограниченным набором разрешений из среды разработки.  Также см. раздел <a href="/visualstudio/deployment/how-to-debug-a-clickonce-application-with-restricted-permissions">Как отладить приложение ClickOnce с ограниченными разрешениями</a>.</p>
<h2 id="see-also">См. также</h2>
<ul>
<li><a href="windows-forms-security.html">Безопасность Windows Forms</a></li>
<li><a href="../misc/code-access-security-basics.md">Основы управления доступом для кода</a></li>
<li><a href="/visualstudio/deployment/clickonce-security-and-deployment">Развертывание и безопасность технологии ClickOnce</a></li>
<li><a href="/visualstudio/deployment/trusted-application-deployment-overview">Общие сведения о развертывании доверенных приложений</a></li>
<li><a href="../tools/mage-exe-manifest-generation-and-editing-tool.md">Mage.exe (средство создания и редактирования манифеста)</a></li>
<li><a href="../tools/mageui-exe-manifest-generation-and-editing-tool-graphical-client.md">MageUI.exe (средство создания и редактирования манифестов, графический клиент)</a></li>
</ul>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span><a href="https://github.com/MSDN-WhiteKnight/dotnet-docs-ru">Неофициальная документация по .NET на русском языке</a>. Лицензия: <a href="https://github.com/MSDN-WhiteKnight/dotnet-docs-ru/blob/main/LICENSE">CC-BY 4.0</a>. Основано на <a href="https://docs.microsoft.com/ru-ru/dotnet/">документации по .NET с Microsoft Docs</a><br>Generated by <strong>DocFX</strong></span><script type="text/javascript">(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(65150713, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/65150713" style="position:absolute; left:-9999px;" alt=""></div></noscript>
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
