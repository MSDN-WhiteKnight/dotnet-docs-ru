<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>&#1055;&#1088;&#1072;&#1082;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1086;&#1077; &#1088;&#1091;&#1082;&#1086;&#1074;&#1086;&#1076;&#1089;&#1090;&#1074;&#1086;. &#1041;&#1083;&#1086;&#1082;&#1080;&#1088;&#1086;&#1074;&#1082;&#1072; &#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1072; &#1082;&#1086; &#1074;&#1082;&#1083;&#1072;&#1076;&#1082;&#1072;&#1084; | &#1053;&#1077;&#1086;&#1092;&#1080;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1072;&#1103; &#1076;&#1086;&#1082;&#1091;&#1084;&#1077;&#1085;&#1090;&#1072;&#1094;&#1080;&#1103; .NET </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="&#1055;&#1088;&#1072;&#1082;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1086;&#1077; &#1088;&#1091;&#1082;&#1086;&#1074;&#1086;&#1076;&#1089;&#1090;&#1074;&#1086;. &#1041;&#1083;&#1086;&#1082;&#1080;&#1088;&#1086;&#1074;&#1082;&#1072; &#1076;&#1086;&#1089;&#1090;&#1091;&#1087;&#1072; &#1082;&#1086; &#1074;&#1082;&#1083;&#1072;&#1076;&#1082;&#1072;&#1084; | &#1053;&#1077;&#1086;&#1092;&#1080;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1072;&#1103; &#1076;&#1086;&#1082;&#1091;&#1084;&#1077;&#1085;&#1090;&#1072;&#1094;&#1080;&#1103; .NET ">
    <meta name="generator" content="docfx 2.40.12.0">
    
    <link rel="shortcut icon" href="../../../favicon.ico">
    <link rel="stylesheet" href="../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../styles/main.css">
    <meta property="docfx:navrel" content="../../../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../index.html">
                <img id="logo" class="svg" src="../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="how-to-disable-tab-pages">Практическое руководство. Блокировка доступа ко вкладкам</h1>

<p>В некоторых случаях требуется ограничить доступ к данным, которые можно использовать в приложении Windows Forms. Примером этого могут быть, когда у вас есть данные, отображаемые на страницах вкладок элемента управления вкладки; Администраторы могут иметь сведения на странице вкладки, который требуется запретить гостей или пользователей более низкого уровня.</p>
<h3 id="to-disable-tab-pages-programmatically">Чтобы отключить страницы вкладок программными средствами</h3>
<ol>
<li><p>Написание кода для обработки элемента управления вкладка <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.tabcontrol.selectedindexchanged">SelectedIndexChanged</a> событий. Это событие, возникающее, когда пользователь переходит с одной вкладки к следующему.</p>
</li>
<li><p>Проверьте учетные данные. В зависимости от представленной здесь информации, вы можете проверить имя пользователя, который пользователь вошел в систему или другие формы учетные данные перед предоставлением пользователю для просмотра на вкладке.</p>
</li>
<li><p>Если пользователь имеет соответствующие учетные данные, отобразите вкладку, которая была нажата. Если пользователь не имеет соответствующие учетные данные, отобразить окно сообщения, или другой элемент пользовательского интерфейса, указывающий, что они не имеют доступ и вернуться на исходную вкладку.</p>
<div class="NOTE">
<h5>Note</h5>
<p>При реализации этой функции в приложении, можно выполнять проверку учетных данных во время формы <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.form.load">Load</a> событий. Это дает возможность скрыть вкладку до отображения пользовательского интерфейса, который является более понятную для программирования. Используемые ниже методы (проверка учетных данных и отключение вкладки в <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.tabcontrol.selectedindexchanged">SelectedIndexChanged</a> событий) для иллюстративных целей.</p>
</div>
</li>
<li><p>При необходимости при наличии более двух страниц вкладок, отображения страницы вкладки, отличной от первоначальной.</p>
<p>В следующем примере <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.checkbox">CheckBox</a> элемент управления используется вместо проверки учетных данных, в качестве критерия для доступа к вкладке зависит от приложения. Когда <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.tabcontrol.selectedindexchanged">SelectedIndexChanged</a> событие возникает, если проверка учетных данных имеет значение true (то есть флажок установлен) и выбрана вкладка <code>TabPage2</code> (вкладка с конфиденциальными данными, в этом примере), затем <code>TabPage2</code> отображается. В противном случае <code>TabPage3</code> отображается и отображается окно сообщения об отсутствии необходимых прав доступа. В приведенном ниже коде предполагается, что форма <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.checkbox">CheckBox</a> управления (<code>CredentialCheck</code>) и <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.tabcontrol">TabControl</a> элемента управления с тремя вкладками.</p>
<pre><code class="lang-vb">Private Sub TabControl1_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles TabControl1.SelectedIndexChanged  
   ' Check Credentials Here  

   If CredentialCheck.Checked = True And _   
   TabControl1.SelectedTab Is TabPage2 Then  
      TabControl1.SelectedTab = TabPage2  
   ElseIf CredentialCheck.Checked = False _   
   And TabControl1.SelectedTab Is TabPage2 Then  
      MessageBox.Show _   
     (&quot;Unable to load tab. You have insufficient access privileges.&quot;)  
      TabControl1.SelectedTab = TabPage3  
   End If  
End Sub  
</code></pre>
<pre><code class="lang-csharp">private void tabControl1_SelectedIndexChanged(object sender, System.EventArgs e)  
{  
    // Check Credentials Here  

    if ((CredentialCheck.Checked == true) &amp;&amp; (tabControl1.SelectedTab == tabPage2))   
    {  
        tabControl1.SelectedTab = tabPage2;  
    }  
    else if ((CredentialCheck.Checked == false) &amp;&amp; (tabControl1.SelectedTab == tabPage2))  
    {  
        MessageBox.Show(&quot;Unable to load tab. You have insufficient access privileges.&quot;);  
        tabControl1.SelectedTab = tabPage3;  
    }  
}  
</code></pre>
<pre><code class="lang-cpp">private:  
   System::Void tabControl1_SelectedIndexChanged(  
      System::Object ^ sender,  
      System::EventArgs ^  e)  
   {  
      // Check Credentials Here  
      if ((CredentialCheck-&gt;Checked == true) &amp;&amp;  
          (tabControl1-&gt;SelectedTab == tabPage2))  
      {  
         tabControl1-&gt;SelectedTab = tabPage2;  
      }  
      else if ((CredentialCheck-&gt;Checked == false) &amp;&amp;  
               (tabControl1-&gt;SelectedTab == tabPage2))  
      {  
         MessageBox::Show(String::Concat(&quot;Unable to load tab. &quot;,  
            &quot;You have insufficient access privileges.&quot;));  
         tabControl1-&gt;SelectedTab = tabPage3;  
      }  
   }  
</code></pre>
<p>(Visual C#, Visual C++) Поместите следующий код в конструктор формы для регистрации обработчика событий.</p>
<pre><code class="lang-csharp">this.tabControl1.SelectedIndexChanged +=   
   new System.EventHandler(this.tabControl1_SelectedIndexChanged);  
</code></pre>
<pre><code class="lang-cpp">this-&gt;tabControl1-&gt;SelectedIndexChanged +=  
   gcnew System::EventHandler(this, &amp;Form1::tabControl1_SelectedIndexChanged);  
</code></pre>
</li>
</ol>
<h2 id="see-also">См. также</h2>
<ul>
<li><a href="tabcontrol-control-overview-windows-forms.html">Общие сведения об элементе управления TabControl</a></li>
<li><a href="how-to-add-a-control-to-a-tab-page.html">Практическое руководство. Добавление элемента управления на вкладку</a></li>
<li><a href="how-to-add-and-remove-tabs-with-the-windows-forms-tabcontrol.html">Практическое руководство. Добавление и удаление вкладок с помощью элемента управления TabControl в Windows Forms</a></li>
<li><a href="how-to-change-the-appearance-of-the-windows-forms-tabcontrol.html">Практическое руководство. Изменение внешнего вида элемента управления TabControl в Windows Forms</a></li>
</ul>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span><a href="https://github.com/MSDN-WhiteKnight/dotnet-docs-ru">Неофициальная документация по .NET на русском языке</a>. Лицензия: <a href="https://github.com/MSDN-WhiteKnight/dotnet-docs-ru/blob/main/LICENSE">CC-BY 4.0</a>. Основано на <a href="https://docs.microsoft.com/ru-ru/dotnet/">документации по .NET с Microsoft Docs</a><br>Generated by <strong>DocFX</strong></span><script type="text/javascript">(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(65150713, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/65150713" style="position:absolute; left:-9999px;" alt=""></div></noscript>
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>
  </body>
</html>
