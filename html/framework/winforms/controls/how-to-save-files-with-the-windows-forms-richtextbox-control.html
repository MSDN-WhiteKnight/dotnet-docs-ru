<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>&#1055;&#1088;&#1072;&#1082;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1086;&#1077; &#1088;&#1091;&#1082;&#1086;&#1074;&#1086;&#1076;&#1089;&#1090;&#1074;&#1086;. &#1057;&#1086;&#1093;&#1088;&#1072;&#1085;&#1077;&#1085;&#1080;&#1077; &#1092;&#1072;&#1081;&#1083;&#1086;&#1074; &#1089; &#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102; &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1072; &#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103; RichTextBox &#1074; Windows Forms | &#1053;&#1077;&#1086;&#1092;&#1080;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1072;&#1103; &#1076;&#1086;&#1082;&#1091;&#1084;&#1077;&#1085;&#1090;&#1072;&#1094;&#1080;&#1103; .NET </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="&#1055;&#1088;&#1072;&#1082;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1086;&#1077; &#1088;&#1091;&#1082;&#1086;&#1074;&#1086;&#1076;&#1089;&#1090;&#1074;&#1086;. &#1057;&#1086;&#1093;&#1088;&#1072;&#1085;&#1077;&#1085;&#1080;&#1077; &#1092;&#1072;&#1081;&#1083;&#1086;&#1074; &#1089; &#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102; &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1072; &#1091;&#1087;&#1088;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103; RichTextBox &#1074; Windows Forms | &#1053;&#1077;&#1086;&#1092;&#1080;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1072;&#1103; &#1076;&#1086;&#1082;&#1091;&#1084;&#1077;&#1085;&#1090;&#1072;&#1094;&#1080;&#1103; .NET ">
    <meta name="generator" content="docfx 2.40.12.0">
    
    <link rel="shortcut icon" href="../../../favicon.ico">
    <link rel="stylesheet" href="../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../styles/main.css">
    <meta property="docfx:navrel" content="../../../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../index.html">
                <img id="logo" class="svg" src="../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="how-to-save-files-with-the-windows-forms-richtextbox-control">Практическое руководство. Сохранение файлов с помощью элемента управления RichTextBox в Windows Forms</h1>

<p>Windows Forms <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.richtextbox">RichTextBox</a> управления может записывать сведения, которые отображаются в одном из следующих форматов:</p>
<ul>
<li><p>Обычный текст</p>
</li>
<li><p>Текст в Юникоде</p>
</li>
<li><p>Rich Text Format (RTF)</p>
</li>
<li><p>Формат RTF с пробелами вместо объектов OLE</p>
</li>
<li><p>Обычный текст с текстовым представлением объектов OLE</p>
</li>
</ul>
<p>Чтобы сохранить файл, вызовите <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.richtextbox.savefile">SaveFile</a> метод. Можно также использовать <strong>SaveFile</strong> метод для сохранения данных в поток. Дополнительные сведения см. в разделе <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.richtextbox.savefile#System_Windows_Forms_RichTextBox_SaveFile_System_IO_Stream_System_Windows_Forms_RichTextBoxStreamType_">SaveFile(Stream, RichTextBoxStreamType)</a>.</p>
<h3 id="to-save-the-contents-of-the-control-to-a-file">Чтобы сохранить содержимое элемента управления в файл</h3>
<ol>
<li><p>Определите путь к файлу должен быть сохранен.</p>
<p>Для этого в реальном приложении обычно используется <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.savefiledialog">SaveFileDialog</a> компонента. Дополнительные сведения см. в разделе <a href="savefiledialog-component-overview-windows-forms.html">Общие сведения о компоненте SaveFileDialog</a>.</p>
</li>
<li><p>Вызовите <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.richtextbox.savefile">SaveFile</a> метод <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.richtextbox">RichTextBox</a> управления, указав имя файла для сохранения и при необходимости тип файла. Если вызвать метод с именем файла в качестве единственного аргумента, файл будет сохранен как RTF. Чтобы указать другой тип файла, вызовите метод со значением перечисления <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.richtextboxstreamtype">RichTextBoxStreamType</a> в качестве второго аргумента.</p>
<p>В приведенном ниже примере путь задан для — расположение файла RTF- <strong>Мои документы</strong> папки. Это расположение используется в том случае, так как можно предположить, что большинство компьютеров под управлением ОС Windows будет включать эту папку. Эта папка также пользователи со систему с минимальным уровнем доступа могут безопасно запускать приложение. В приведенном ниже примере предполагается, что форма <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.richtextbox">RichTextBox</a> управления уже добавлен.</p>
<pre><code class="lang-vb">Public Sub SaveFile()  
   ' You should replace the bold file name in the   
   ' sample below with a file name of your own choosing.  
   RichTextBox1.SaveFile(System.Environment.GetFolderPath _  
   (System.Environment.SpecialFolder.Personal) _  
   &amp; &quot;\Testdoc.rtf&quot;, _  
      RichTextBoxStreamType.RichNoOleObjs)  
End Sub  
</code></pre>
<pre><code class="lang-csharp">public void SaveFile()  
{  
   // You should replace the bold file name in the   
   // sample below with a file name of your own choosing.  
   // Note the escape character used (@) when specifying the path.  
   richTextBox1.SaveFile(System.Environment.GetFolderPath  
   (System.Environment.SpecialFolder.Personal)  
   + @&quot;\Testdoc.rtf&quot;,  
      RichTextBoxStreamType.RichNoOleObjs);  
}  
</code></pre>
<pre><code class="lang-cpp">public:  
   void SaveFile()  
   {  
      // You should replace the bold file name in the   
      // sample below with a file name of your own choosing.  
      richTextBox1-&gt;SaveFile(String::Concat  
         (System::Environment::GetFolderPath  
         (System::Environment::SpecialFolder::Personal),  
         &quot;\\Testdoc.rtf&quot;), RichTextBoxStreamType::RichNoOleObjs);  
   }  
</code></pre>
<div class="IMPORTANT">
<h5>Important</h5>
<p>В этом примере создается файл (если файл отсутствует). Если приложению требуется для создания файла, что ему необходимо иметь доступ для папки. Для задания разрешений используются списки управления доступом. Если файл уже существует, приложению требуется только доступ на запись, более низким уровнем. Где это возможно, безопаснее создать файл во время развертывания и только предоставить доступ на чтение к одному файлу, чем на доступ к папке. По тем же соображениям рекомендуется записывать данные в пользовательские папки, а не в коревую папку или папку Program Files.</p>
</div>
</li>
</ol>
<h2 id="see-also">См. также</h2>
<ul>
<li><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.richtextbox.savefile">RichTextBox.SaveFile</a></li>
<li><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.richtextbox">RichTextBox</a></li>
<li><a href="richtextbox-control-windows-forms.html">Элемент управления RichTextBox</a></li>
<li><a href="controls-to-use-on-windows-forms.html">Элементы управления для использования в формах Windows Forms</a></li>
</ul>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span><a href="https://github.com/MSDN-WhiteKnight/dotnet-docs-ru">Неофициальная документация по .NET на русском языке</a>. Лицензия: <a href="https://github.com/MSDN-WhiteKnight/dotnet-docs-ru/blob/main/LICENSE">CC-BY 4.0</a>. Основано на <a href="https://docs.microsoft.com/ru-ru/dotnet/">документации по .NET с Microsoft Docs</a><br>Generated by <strong>DocFX</strong></span><script type="text/javascript">(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(65150713, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/65150713" style="position:absolute; left:-9999px;" alt=""></div></noscript>
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>
  </body>
</html>
