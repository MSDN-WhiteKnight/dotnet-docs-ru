<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>&#1055;&#1088;&#1072;&#1082;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1086;&#1077; &#1088;&#1091;&#1082;&#1086;&#1074;&#1086;&#1076;&#1089;&#1090;&#1074;&#1086;. &#1042;&#1099;&#1087;&#1086;&#1083;&#1085;&#1077;&#1085;&#1080;&#1077; &#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1081; &#1089; &#1079;&#1072;&#1076;&#1072;&#1085;&#1085;&#1086;&#1081; &#1087;&#1077;&#1088;&#1080;&#1086;&#1076;&#1080;&#1095;&#1085;&#1086;&#1089;&#1090;&#1100;&#1102; &#1089; &#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102; &#1082;&#1086;&#1084;&#1087;&#1086;&#1085;&#1077;&#1085;&#1090;&#1072; Timer &#1074; Windows Forms | &#1053;&#1077;&#1086;&#1092;&#1080;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1072;&#1103; &#1076;&#1086;&#1082;&#1091;&#1084;&#1077;&#1085;&#1090;&#1072;&#1094;&#1080;&#1103; .NET </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="&#1055;&#1088;&#1072;&#1082;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1086;&#1077; &#1088;&#1091;&#1082;&#1086;&#1074;&#1086;&#1076;&#1089;&#1090;&#1074;&#1086;. &#1042;&#1099;&#1087;&#1086;&#1083;&#1085;&#1077;&#1085;&#1080;&#1077; &#1086;&#1087;&#1077;&#1088;&#1072;&#1094;&#1080;&#1081; &#1089; &#1079;&#1072;&#1076;&#1072;&#1085;&#1085;&#1086;&#1081; &#1087;&#1077;&#1088;&#1080;&#1086;&#1076;&#1080;&#1095;&#1085;&#1086;&#1089;&#1090;&#1100;&#1102; &#1089; &#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102; &#1082;&#1086;&#1084;&#1087;&#1086;&#1085;&#1077;&#1085;&#1090;&#1072; Timer &#1074; Windows Forms | &#1053;&#1077;&#1086;&#1092;&#1080;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1072;&#1103; &#1076;&#1086;&#1082;&#1091;&#1084;&#1077;&#1085;&#1090;&#1072;&#1094;&#1080;&#1103; .NET ">
    <meta name="generator" content="docfx 2.40.12.0">
    
    <link rel="shortcut icon" href="../../../favicon.ico">
    <link rel="stylesheet" href="../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../styles/main.css">
    <meta property="docfx:navrel" content="../../../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../index.html">
                <img id="logo" class="svg" src="../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="how-to-run-procedures-at-set-intervals-with-the-windows-forms-timer-component">Практическое руководство. Выполнение операций с заданной периодичностью с помощью компонента Timer в Windows Forms</h1>

<p>Иногда может потребоваться создать процедуру, которая выполняется через определенные интервалы времени до окончания цикла или запускается по истечении установленного интервала. Создание такой процедуры возможно благодаря компоненту <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.timer">Timer</a>.</p>
<p>Этот компонент предназначен для работы в среде Windows Forms. Если вам требуется таймер, подходящий для серверной среды, см. раздел <a href="https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/tb9yt5e6(v=vs.90)">Общие сведения о серверных таймерах</a>.</p>
<div class="NOTE">
<h5>Note</h5>
<p>Существуют некоторые ограничения при использовании компонента <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.timer">Timer</a>. Дополнительные сведения см. в разделе <a href="limitations-of-the-timer-component-interval-property.html">ограничения свойства Interval компонента Timer Windows Forms</a>.</p>
</div>
<h2 id="to-run-a-procedure-at-set-intervals-with-the-timer-component">Выполнение процедуры через заданные интервалы времени с помощью компонента Timer</h2>
<ol>
<li><p>Добавьте элемент <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.timer">Timer</a> в форму. В следующем разделе &quot;Пример&quot; показано, как сделать это программным путем. Visual Studio также поддерживает добавление компонентов в форму. Также см. раздел <a href="how-to-add-controls-without-a-user-interface-to-windows-forms.html">Как Добавление элементов управления без пользовательского интерфейса в Windows Forms</a>.</p>
</li>
<li><p>Задайте значение свойства <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.timer.interval">Interval</a> (в миллисекундах) для таймера. Это свойство определяет, сколько времени пройдет до момента повторного запуска процедуры.</p>
<div class="NOTE">
<h5>Note</h5>
<p>Чем чаще происходит событие таймера, тем выше загрузка процессора при ответе на событие. Это может снизить общую производительность. Не устанавливайте значение интервала меньше, чем необходимо.</p>
</div>
</li>
<li><p>Напишите соответствующий код в обработчике событий <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.timer.tick">Tick</a>. Код, написанный в этом событии, будет выполняться с интервалом, указанным в свойстве <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.timer.interval">Interval</a>.</p>
</li>
<li><p>Задайте для свойства <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.timer.enabled">Enabled</a> значение <code>true</code>, чтобы запустить таймер. Событие <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.timer.tick">Tick</a> начнет возникать, запуская процедуру с заданным интервалом.</p>
</li>
<li><p>В соответствующее время задайте для свойства <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.timer.enabled">Enabled</a> значение <code>false</code>, чтобы остановить повторный запуск процедуры. Установка интервала <code>0</code> не приводит к остановке таймера.</p>
</li>
</ol>
<h2 id="example">Пример</h2>
<p>В первом примере кода отслеживается время дня с шагом в одну секунду. В нем используются <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.button">Button</a>, <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.label">Label</a> и компонент <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.timer">Timer</a> в форме. Свойству <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.timer.interval">Interval</a> присваивается значение 1000 (эквивалентно одной секунде). В событии <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.timer.tick">Tick</a> для подписи метки задается текущее время. При нажатии кнопки свойству <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.timer.enabled">Enabled</a> присваивается значение <code>false</code>, после чего таймер перестает обновлять подпись метки. В следующем примере кода требуется наличие формы с помощью <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.button">Button</a> управления с именем <code>Button1</code>, <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.timer">Timer</a> управления с именем <code>Timer1</code>и <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.label">Label</a> управления с именем <code>Label1</code>.</p>
<pre><code class="lang-vb">Private Sub InitializeTimer()  
   ' Run this procedure in an appropriate event.  
   ' Set to 1 second.  
   Timer1.Interval = 1000  
   ' Enable timer.  
   Timer1.Enabled = True  
   Button1.Text = &quot;Enabled&quot;  
End Sub  
x  
Private Sub Timer1_Tick(ByVal Sender As Object, ByVal e As EventArgs) Handles Timer1.Tick  
' Set the caption to the current time.  
   Label1.Text = DateTime.Now  
End Sub  
  
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click  
      If Button1.Text = &quot;Stop&quot; Then  
         Button1.Text = &quot;Start&quot;  
         Timer1.Enabled = False  
      Else  
         Button1.Text = &quot;Stop&quot;  
         Timer1.Enabled = True  
      End If  
End Sub  
</code></pre>
<pre><code class="lang-csharp">private void InitializeTimer()  
{  
    // Call this procedure when the application starts.  
    // Set to 1 second.  
    Timer1.Interval = 1000;  
    Timer1.Tick += new EventHandler(Timer1_Tick);  
  
    // Enable timer.  
    Timer1.Enabled = true;  
  
    Button1.Text = &quot;Stop&quot;;  
    Button1.Click += new EventHandler(Button1_Click);  
}  
  
private void Timer1_Tick(object Sender, EventArgs e)     
{  
   // Set the caption to the current time.  
   Label1.Text = DateTime.Now.ToString();  
}  
  
private void Button1_Click(object sender, EventArgs e)  
{  
  if ( Button1.Text == &quot;Stop&quot; )  
  {  
    Button1.Text = &quot;Start&quot;;  
    Timer1.Enabled = false;  
  }  
  else  
  {  
    Button1.Text = &quot;Stop&quot;;  
    Timer1.Enabled = true;  
  }  
}  
</code></pre>
<pre><code class="lang-cpp">private:  
   void InitializeTimer()  
   {  
      // Run this procedure in an appropriate event.  
      // Set to 1 second.  
      timer1-&gt;Interval = 1000;  
      // Enable timer.  
      timer1-&gt;Enabled = true;  
      this-&gt;timer1-&gt;Tick += gcnew System::EventHandler(this,    
                               &amp;Form1::timer1_Tick);  
  
      button1-&gt;Text = S&quot;Stop&quot;;  
      this-&gt;button1-&gt;Click += gcnew System::EventHandler(this,   
                               &amp;Form1::button1_Click);  
   }  
  
   void timer1_Tick(System::Object ^ sender,  
      System::EventArgs ^ e)  
   {  
      // Set the caption to the current time.  
      label1-&gt;Text = DateTime::Now.ToString();  
   }  
  
   void button1_Click(System::Object ^ sender,  
      System::EventArgs ^ e)  
   {  
      if ( button1-&gt;Text == &quot;Stop&quot; )  
      {  
         button1-&gt;Text = &quot;Start&quot;;  
         timer1-&gt;Enabled = false;  
      }  
      else  
      {  
         button1-&gt;Text = &quot;Stop&quot;;  
         timer1-&gt;Enabled = true;  
      }  
   }  
</code></pre>
<h2 id="example">Пример</h2>
<p>Во втором примере кода процедура выполняется каждые 600 миллисекунд до завершения цикла. В следующем примере кода требуется наличие формы с помощью <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.button">Button</a> управления с именем <code>Button1</code>, <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.timer">Timer</a> управления с именем <code>Timer1</code>и <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.label">Label</a> управления с именем <code>Label1</code>.</p>
<pre><code class="lang-vb">' This variable will be the loop counter.  
Private counter As Integer  
  
Private Sub InitializeTimer()  
   ' Run this procedure in an appropriate event.  
   counter = 0  
   Timer1.Interval = 600  
   Timer1.Enabled = True  
End Sub  
  
Private Sub Timer1_Tick(ByVal sender As Object, ByVal e As System.EventArgs) Handles Timer1.Tick  
   If counter =&gt; 10 Then  
      ' Exit loop code.  
      Timer1.Enabled = False  
      counter = 0  
   Else  
      ' Run your procedure here.  
      ' Increment counter.  
      counter = counter + 1  
      Label1.Text = &quot;Procedures Run: &quot; &amp; counter.ToString  
   End If  
End Sub  
</code></pre>
<pre><code class="lang-csharp">// This variable will be the loop counter.  
private int counter;  
  
private void InitializeTimer()  
{  
   // Run this procedure in an appropriate event.  
   counter = 0;  
   timer1.Interval = 600;  
   timer1.Enabled = true;  
   // Hook up timer's tick event handler.  
   this.timer1.Tick += new System.EventHandler(this.timer1_Tick);  
}  
  
private void timer1_Tick(object sender, System.EventArgs e)     
{  
   if (counter &gt;= 10)   
   {  
      // Exit loop code.  
      timer1.Enabled = false;  
      counter = 0;  
   }  
   else  
   {  
      // Run your procedure here.  
      // Increment counter.  
      counter = counter + 1;  
      label1.Text = &quot;Procedures Run: &quot; + counter.ToString();  
      }  
}  
</code></pre>
<pre><code class="lang-cpp">private:  
   int counter;  
  
   void InitializeTimer()  
   {  
      // Run this procedure in an appropriate event.  
      counter = 0;  
      timer1-&gt;Interval = 600;  
      timer1-&gt;Enabled = true;  
      // Hook up timer's tick event handler.  
      this-&gt;timer1-&gt;Tick += gcnew System::EventHandler(this, &amp;Form1::timer1_Tick);  
   }  
  
   void timer1_Tick(System::Object ^ sender,  
      System::EventArgs ^ e)  
   {  
      if (counter &gt;= 10)   
      {  
         // Exit loop code.  
         timer1-&gt;Enabled = false;  
         counter = 0;  
      }  
      else  
      {  
         // Run your procedure here.  
         // Increment counter.  
         counter = counter + 1;  
         label1-&gt;Text = String::Concat(&quot;Procedures Run: &quot;,  
            counter.ToString());  
      }  
   }  
</code></pre>
<h2 id="see-also">См. также</h2>
<ul>
<li><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.timer">Timer</a></li>
<li><a href="timer-component-windows-forms.html">Компонент Timer</a></li>
<li><a href="timer-component-overview-windows-forms.html">Общие сведения о компоненте Timer</a></li>
</ul>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span><a href="https://github.com/MSDN-WhiteKnight/dotnet-docs-ru">Неофициальная документация по .NET на русском языке</a>. Лицензия: <a href="https://github.com/MSDN-WhiteKnight/dotnet-docs-ru/blob/main/LICENSE">CC-BY 4.0</a>. Основано на <a href="https://docs.microsoft.com/ru-ru/dotnet/">документации по .NET с Microsoft Docs</a><br>Generated by <strong>DocFX</strong></span><script type="text/javascript">(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(65150713, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/65150713" style="position:absolute; left:-9999px;" alt=""></div></noscript>
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>
  </body>
</html>
