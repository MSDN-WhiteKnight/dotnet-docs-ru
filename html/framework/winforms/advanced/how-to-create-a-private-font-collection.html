<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>&#1055;&#1088;&#1072;&#1082;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1086;&#1077; &#1088;&#1091;&#1082;&#1086;&#1074;&#1086;&#1076;&#1089;&#1090;&#1074;&#1086;. &#1057;&#1086;&#1079;&#1076;&#1072;&#1085;&#1080;&#1077; &#1095;&#1072;&#1089;&#1090;&#1085;&#1086;&#1081; &#1082;&#1086;&#1083;&#1083;&#1077;&#1082;&#1094;&#1080;&#1080; &#1096;&#1088;&#1080;&#1092;&#1090;&#1086;&#1074; | &#1053;&#1077;&#1086;&#1092;&#1080;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1072;&#1103; &#1076;&#1086;&#1082;&#1091;&#1084;&#1077;&#1085;&#1090;&#1072;&#1094;&#1080;&#1103; .NET </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="&#1055;&#1088;&#1072;&#1082;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1086;&#1077; &#1088;&#1091;&#1082;&#1086;&#1074;&#1086;&#1076;&#1089;&#1090;&#1074;&#1086;. &#1057;&#1086;&#1079;&#1076;&#1072;&#1085;&#1080;&#1077; &#1095;&#1072;&#1089;&#1090;&#1085;&#1086;&#1081; &#1082;&#1086;&#1083;&#1083;&#1077;&#1082;&#1094;&#1080;&#1080; &#1096;&#1088;&#1080;&#1092;&#1090;&#1086;&#1074; | &#1053;&#1077;&#1086;&#1092;&#1080;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1072;&#1103; &#1076;&#1086;&#1082;&#1091;&#1084;&#1077;&#1085;&#1090;&#1072;&#1094;&#1080;&#1103; .NET ">
    <meta name="generator" content="docfx 2.40.12.0">
    
    <link rel="shortcut icon" href="../../../favicon.ico">
    <link rel="stylesheet" href="../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../styles/main.css">
    <meta property="docfx:navrel" content="../../../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../index.html">
                <img id="logo" class="svg" src="../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="how-to-create-a-private-font-collection">Практическое руководство. Создание частной коллекции шрифтов</h1>

<p><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.drawing.text.privatefontcollection">PrivateFontCollection</a> Класс наследует от <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.drawing.text.fontcollection">FontCollection</a> абстрактного базового класса. Можно использовать <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.drawing.text.privatefontcollection">PrivateFontCollection</a> объект для сохранения набора шрифты, специально для вашего приложения. Частной коллекции может включать установленных системных шрифтов, а также шрифты, которые не были установлены на компьютере. Чтобы добавить файл шрифта частной коллекции, вызовите <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.drawing.text.privatefontcollection.addfontfile">AddFontFile</a> метод <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.drawing.text.privatefontcollection">PrivateFontCollection</a> объекта.</p>
<p><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.drawing.text.fontcollection.families">Families</a> Свойство <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.drawing.text.privatefontcollection">PrivateFontCollection</a> объект содержит массив <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.drawing.fontfamily">FontFamily</a> объектов.</p>
<p>Количество семейств шрифтов в частной коллекции не обязательно совпадает с количеством файлов шрифтов, которые были добавлены в коллекцию. Например предположим, что файлы, ArialBd.tff Times.tff и TimesBd.tff, добавленные в коллекцию. Будет существовать три файла, но только два семейства в коллекции, так как Times.tff и TimesBd.tff относятся к одному семейству.</p>
<h2 id="example">Пример</h2>
<p>В следующем примере добавляется следующих трех шрифта файлов <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.drawing.text.privatefontcollection">PrivateFontCollection</a> объекта:</p>
<ul>
<li><p>C:\<em>systemroot</em>\Fonts\Arial.tff (Arial, обычный)</p>
</li>
<li><p>C:\<em>systemroot</em>\Fonts\CourBI.tff (Courier New, полужирный курсив)</p>
</li>
<li><p>C:\<em>systemroot</em>\Fonts\TimesBd.tff (Times New Roman, полужирным шрифтом)</p>
</li>
</ul>
<p>Код извлекает массив <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.drawing.fontfamily">FontFamily</a> объектов из <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.drawing.text.fontcollection.families">Families</a> свойство <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.drawing.text.privatefontcollection">PrivateFontCollection</a> объекта.</p>
<p>Для каждого <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.drawing.fontfamily">FontFamily</a> объекта в коллекции, этот код вызывает <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.drawing.fontfamily.isstyleavailable">IsStyleAvailable</a> метод, чтобы определить, будут ли доступны различные стили (обычный, полужирный, курсив, полужирный курсив, подчеркнутый и зачеркнутый). Аргументы, передаваемые <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.drawing.fontfamily.isstyleavailable">IsStyleAvailable</a> метод являются членами <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.drawing.fontstyle">FontStyle</a> перечисления.</p>
<p>Если сочетание заданного семейства/стиля, <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.drawing.font">Font</a> создается с помощью этого и начертанием. Первый аргумент, переданный <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.drawing.font.-ctor">Font</a> конструктор является имя семейства шрифтов (не <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.drawing.fontfamily">FontFamily</a> объекта, как в случае других вариантах <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.drawing.font.-ctor">Font</a> конструктор). После <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.drawing.font">Font</a> объект создан, он передается <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.drawing.graphics.drawstring">DrawString</a> метод <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.drawing.graphics">Graphics</a> класса, чтобы отобразить имя семейства, а также имя стиля.</p>
<p>Выходные данные следующий код аналогичен результат, показанный на следующем рисунке:</p>
<p><img src="media/how-to-create-a-private-font-collection/various-fonts-text-output.png" alt="Снимок экрана: текст в различные шрифты."></p>
<p>Arial.tff (который был добавлен в частную коллекцию шрифтов в следующем примере кода) — это файл шрифта Arial обычного стиля. Обратите внимание, что выходные данные программы показано несколько доступные стили, кроме обычных шрифт Arial семейства. Это потому, что GDI+ может имитировать полужирный, курсив и полужирный курсив обычного начертания. GDI+ Можно также создавать, зачеркивание и подчеркивание обычного начертания.</p>
<p>Аналогичным образом GDI+ можно имитировать полужирным курсивом стиль из полужирный стиль или курсивное начертание. Выходные данные программы показано, что полужирным курсивом стиля для семейства раз несмотря на то, что TimesBd.tff (Times New Roman, полужирный) является единственным файлом раз в коллекции.</p>
<pre><code class="lang-csharp" name="System.Drawing.FontsAndText#51">PointF pointF = new PointF(10, 0);
SolidBrush solidBrush = new SolidBrush(Color.Black);

int count = 0;
string familyName = &quot;&quot;;
string familyNameAndStyle;
FontFamily[] fontFamilies;
PrivateFontCollection privateFontCollection = new PrivateFontCollection();

// Add three font files to the private collection.
privateFontCollection.AddFontFile(&quot;D:\\systemroot\\Fonts\\Arial.ttf&quot;);
privateFontCollection.AddFontFile(&quot;D:\\systemroot\\Fonts\\CourBI.ttf&quot;);
privateFontCollection.AddFontFile(&quot;D:\\systemroot\\Fonts\\TimesBD.ttf&quot;);

// Get the array of FontFamily objects.
fontFamilies = privateFontCollection.Families;

// How many objects in the fontFamilies array?
count = fontFamilies.Length;

// Display the name of each font family in the private collection
// along with the available styles for that font family.
for (int j = 0; j &lt; count; ++j)
{
    // Get the font family name.
    familyName = fontFamilies[j].Name;

    // Is the regular style available?
    if (fontFamilies[j].IsStyleAvailable(FontStyle.Regular))
    {
        familyNameAndStyle = &quot;&quot;;
        familyNameAndStyle = familyNameAndStyle + familyName;
        familyNameAndStyle = familyNameAndStyle + &quot; Regular&quot;;

        Font regFont = new Font(
           familyName,
           16,
           FontStyle.Regular,
           GraphicsUnit.Pixel);

        e.Graphics.DrawString(
           familyNameAndStyle,
           regFont,
           solidBrush,
           pointF);

        pointF.Y += regFont.Height;
    }

    // Is the bold style available?
    if (fontFamilies[j].IsStyleAvailable(FontStyle.Bold))
    {
        familyNameAndStyle = &quot;&quot;;
        familyNameAndStyle = familyNameAndStyle + familyName;
        familyNameAndStyle = familyNameAndStyle + &quot; Bold&quot;;

        Font boldFont = new Font(
           familyName,
           16,
           FontStyle.Bold,
           GraphicsUnit.Pixel);

        e.Graphics.DrawString(familyNameAndStyle, boldFont, solidBrush, pointF);

        pointF.Y += boldFont.Height;
    }
    // Is the italic style available?
    if (fontFamilies[j].IsStyleAvailable(FontStyle.Italic))
    {
        familyNameAndStyle = &quot;&quot;;
        familyNameAndStyle = familyNameAndStyle + familyName;
        familyNameAndStyle = familyNameAndStyle + &quot; Italic&quot;;

        Font italicFont = new Font(
           familyName,
           16,
           FontStyle.Italic,
           GraphicsUnit.Pixel);

        e.Graphics.DrawString(
           familyNameAndStyle,
           italicFont,
           solidBrush,
           pointF);

        pointF.Y += italicFont.Height;
    }

    // Is the bold italic style available?
    if (fontFamilies[j].IsStyleAvailable(FontStyle.Italic) &amp;&amp;
    fontFamilies[j].IsStyleAvailable(FontStyle.Bold))
    {
        familyNameAndStyle = &quot;&quot;;
        familyNameAndStyle = familyNameAndStyle + familyName;
        familyNameAndStyle = familyNameAndStyle + &quot;BoldItalic&quot;;

        Font italicFont = new Font(
           familyName,
           16,
           FontStyle.Italic | FontStyle.Bold,
           GraphicsUnit.Pixel);

        e.Graphics.DrawString(
           familyNameAndStyle,
           italicFont,
           solidBrush,
           pointF);

        pointF.Y += italicFont.Height;
    }
    // Is the underline style available?
    if (fontFamilies[j].IsStyleAvailable(FontStyle.Underline))
    {
        familyNameAndStyle = &quot;&quot;;
        familyNameAndStyle = familyNameAndStyle + familyName;
        familyNameAndStyle = familyNameAndStyle + &quot; Underline&quot;;

        Font underlineFont = new Font(
           familyName,
           16,
           FontStyle.Underline,
           GraphicsUnit.Pixel);

        e.Graphics.DrawString(
           familyNameAndStyle,
           underlineFont,
           solidBrush,
           pointF);

        pointF.Y += underlineFont.Height;
    }

    // Is the strikeout style available?
    if (fontFamilies[j].IsStyleAvailable(FontStyle.Strikeout))
    {
        familyNameAndStyle = &quot;&quot;;
        familyNameAndStyle = familyNameAndStyle + familyName;
        familyNameAndStyle = familyNameAndStyle + &quot; Strikeout&quot;;

        Font strikeFont = new Font(
           familyName,
           16,
           FontStyle.Strikeout,
           GraphicsUnit.Pixel);

        e.Graphics.DrawString(
           familyNameAndStyle,
           strikeFont,
           solidBrush,
           pointF);

        pointF.Y += strikeFont.Height;
    }

    // Separate the families with white space.
    pointF.Y += 10;

} // for
</code></pre><h2 id="compiling-the-code">Компиляция кода</h2>
<p>Предыдущий пример предназначен для работы с Windows Forms и требует <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.painteventargs">PaintEventArgs</a> <code>e</code>, который является параметром <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.painteventhandler">PaintEventHandler</a>.</p>
<h2 id="see-also">См. также</h2>
<ul>
<li><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.drawing.text.privatefontcollection">PrivateFontCollection</a></li>
<li><a href="using-fonts-and-text.html">Шрифты и текст</a></li>
</ul>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span><a href="https://github.com/MSDN-WhiteKnight/dotnet-docs-ru">Неофициальная документация по .NET на русском языке</a>. Лицензия: <a href="https://github.com/MSDN-WhiteKnight/dotnet-docs-ru/blob/main/LICENSE">CC-BY 4.0</a>. Основано на <a href="https://docs.microsoft.com/ru-ru/dotnet/">документации по .NET с Microsoft Docs</a><br>Generated by <strong>DocFX</strong></span><script type="text/javascript">(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(65150713, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/65150713" style="position:absolute; left:-9999px;" alt=""></div></noscript>
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>
  </body>
</html>
