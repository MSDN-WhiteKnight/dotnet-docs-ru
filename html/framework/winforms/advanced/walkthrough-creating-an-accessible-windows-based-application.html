<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>&#1055;&#1086;&#1096;&#1072;&#1075;&#1086;&#1074;&#1086;&#1077; &#1088;&#1091;&#1082;&#1086;&#1074;&#1086;&#1076;&#1089;&#1090;&#1074;&#1086;. &#1057;&#1086;&#1079;&#1076;&#1072;&#1085;&#1080;&#1077; &#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1103; Windows &#1089; &#1087;&#1086;&#1076;&#1076;&#1077;&#1088;&#1078;&#1082;&#1086;&#1081; &#1089;&#1087;&#1077;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1099;&#1093; &#1074;&#1086;&#1079;&#1084;&#1086;&#1078;&#1085;&#1086;&#1089;&#1090;&#1077;&#1081; | &#1053;&#1077;&#1086;&#1092;&#1080;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1072;&#1103; &#1076;&#1086;&#1082;&#1091;&#1084;&#1077;&#1085;&#1090;&#1072;&#1094;&#1080;&#1103; .NET </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="&#1055;&#1086;&#1096;&#1072;&#1075;&#1086;&#1074;&#1086;&#1077; &#1088;&#1091;&#1082;&#1086;&#1074;&#1086;&#1076;&#1089;&#1090;&#1074;&#1086;. &#1057;&#1086;&#1079;&#1076;&#1072;&#1085;&#1080;&#1077; &#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1103; Windows &#1089; &#1087;&#1086;&#1076;&#1076;&#1077;&#1088;&#1078;&#1082;&#1086;&#1081; &#1089;&#1087;&#1077;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1099;&#1093; &#1074;&#1086;&#1079;&#1084;&#1086;&#1078;&#1085;&#1086;&#1089;&#1090;&#1077;&#1081; | &#1053;&#1077;&#1086;&#1092;&#1080;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1072;&#1103; &#1076;&#1086;&#1082;&#1091;&#1084;&#1077;&#1085;&#1090;&#1072;&#1094;&#1080;&#1103; .NET ">
    <meta name="generator" content="docfx 2.40.12.0">
    
    <link rel="shortcut icon" href="../../../favicon.ico">
    <link rel="stylesheet" href="../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../styles/main.css">
    <meta property="docfx:navrel" content="../../../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../index.html">
                <img id="logo" class="svg" src="../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="walkthrough-creating-an-accessible-windows-based-application">Пошаговое руководство. Создание приложения Windows с поддержкой специальных возможностей</h1>

<p>Создание приложений со специальными возможностями необходимо по деловым соображениям. Во многих странах для продаваемого программного обеспечения существуют правительственные требования в отношении специальных возможностей. Логотип &quot;Сертифицировано для Windows&quot; предполагает соответствие продукта требованиям в отношении специальных возможностей. По предварительным оценкам, только в США 30 миллионов пользователей нуждаются в программном обеспечении со специальными возможностями. Многие из них являются потенциальными клиентами.</p>
<p>В этом пошаговом руководстве рассматриваются пять требований в отношении специальных возможностей, выполнение которых необходимо для использования эмблемы &quot;Сертифицировано для Windows&quot;. Согласно этим требованиям в приложении со специальными возможностями обеспечиваются:</p>
<ul>
<li><p>поддержка настройки размера, цвета, шрифта и параметров ввода с панели управления; изменение размеров строк меню, строк заголовков, границ и строки состояния при изменении соответствующих параметров на панели управления (дополнительные изменения элементов управления или кода в приложении не требуются);</p>
</li>
<li><p>поддержка режима высокой контрастности;</p>
</li>
<li><p>документированный доступ с клавиатуры ко всем возможностям;</p>
</li>
<li><p>наглядное и программное представление фокуса клавиатуры;</p>
</li>
<li><p>предоставление важной информации не только с помощью звукового сигнала.</p>
</li>
</ul>
<p>Подробнее см. в разделе <a href="/visualstudio/ide/reference/resources-for-designing-accessible-applications">Ресурсы для создания приложений со специальными возможностями</a>.</p>
<p>Информацию о поддержке различных раскладок клавиатуры см. в разделе <a href="../../../standard/globalization-localization/best-practices-for-developing-world-ready-apps.md">Рекомендации по разработке международных приложений</a>.</p>
<h2 id="creating-the-project">Создание проекта</h2>
<p>В этом пошаговом руководстве создается пользовательский интерфейс для приложения, принимающего заказы на пиццу. Оно содержит поле (<a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.textbox">TextBox</a>) для имени заказчика, группу переключателей (<a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.radiobutton">RadioButton</a>) для выбора размера пиццы, флажки (<a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.checkedlistbox">CheckedListBox</a>) для выбора начинки, две кнопки с надписями &quot;Заказать&quot; и &quot;Отмена&quot;, а также меню с командой &quot;Выход&quot;.</p>
<p>Пользователь вводит имя заказчика, размер пиццы и выбранную начинку. Когда пользователь нажимает кнопку &quot;Заказать&quot;, сводка заказа и его цена выводятся в окне сообщения, а элементы управления очищаются и становятся готовыми к приему следующего заказа. Когда пользователь нажимает кнопку &quot;Отмена&quot;, элементы управления очищаются и становятся готовыми к приему следующего заказа. Когда пользователь выбирает в меню команду &quot;Выход&quot;, программа закрывается.</p>
<p>Основное внимание в этом пошаговом руководстве уделяется не коду для системы розничной продажи, а специальным возможностям пользовательского интерфейса. В примере демонстрируются специальные возможности для некоторых часто используемых элементов управления, таких как кнопки, переключатели, поля и метки.</p>
<h4 id="to-begin-making-the-application">Начало разработки приложения</h4>
<ul>
<li>Создайте новое приложение Windows в Visual Basic или Visual C#. Назовите проект <strong>PizzaOrder</strong>. (Подробнее см. в разделе <a href="/visualstudio/ide/creating-solutions-and-projects">Создание решений и проектов</a>.)</li>
</ul>
<h2 id="adding-the-controls-to-the-form">Добавление элементов управления в форму</h2>
<p>При добавлении элементов управления в форму придерживайтесь приведенных ниже правил для того, чтобы приложение было доступным для пользователей с физическими ограничениями.</p>
<ul>
<li><p>Задайте свойства <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.control.accessibledescription">AccessibleDescription</a> и <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.control.accessiblename">AccessibleName</a>. В этом примере для свойства <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.control.accessiblerole">AccessibleRole</a> достаточным является значение Default. Подробнее о свойствах специальных возможностей см. в разделе <a href="../controls/providing-accessibility-information-for-controls-on-a-windows-form.html">Определение сведений, связанных со специальными возможностями, для элементов управления в Windows Forms</a>.</p>
</li>
<li><p>Задайте размер шрифта 10 пунктов или выше.</p>
<div class="NOTE">
<h5>Note</h5>
<p>Если задать для формы размер шрифта 10 в начале работы, то все элементы управления, добавляемые в форму после этого, также будут иметь размер шрифта 10.</p>
</div>
</li>
<li><p>Убедитесь в том, что любой элемент управления Label, относящийся к элементу TextBox, непосредственно предшествует элементу TextBox в последовательности табуляции.</p>
</li>
<li><p>Добавьте клавишу доступа, с помощью символа «&amp;», в <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.control.text">Text</a> свойства любого элемента управления, пользователь может потребоваться перейти.</p>
</li>
<li><p>Добавьте клавишу доступа, с помощью символа «&amp;», в <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.control.text">Text</a> метки, которая предшествует элементу управления, который пользователь может потребоваться перейти. Задайте для свойства <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.label.usemnemonic">UseMnemonic</a> метки значение <code>true</code>, чтобы при нажатии клавиши доступа фокус переводился на следующий элемент управления в последовательности табуляции.</p>
</li>
<li><p>Добавьте клавиши доступа для всех элементов меню.</p>
</li>
</ul>
<h4 id="to-make-your-windows-application-accessible">Обеспечение специальных возможностей приложения Windows</h4>
<ul>
<li><p>Добавьте в форму элементы управления и задайте их свойства, как описано ниже. Модель размещения элементов управления в форме см. на рисунке после таблицы.</p>
<table>
<thead>
<tr>
<th>Object</th>
<th>Свойство.</th>
<th>Значение</th>
</tr>
</thead>
<tbody>
<tr>
<td>Form1</td>
<td>AccessibleDescription</td>
<td>Форма заказа</td>
</tr>
<tr>
<td></td>
<td>AccessibleName</td>
<td>Форма заказа</td>
</tr>
<tr>
<td></td>
<td>Размер шрифта</td>
<td>10</td>
</tr>
<tr>
<td></td>
<td>Текста</td>
<td>Форма заказа пиццы</td>
</tr>
<tr>
<td>PictureBox</td>
<td>name</td>
<td>logo</td>
</tr>
<tr>
<td></td>
<td>AccessibleDescription</td>
<td>Порция пиццы</td>
</tr>
<tr>
<td></td>
<td>AccessibleName</td>
<td>Логотип компании</td>
</tr>
<tr>
<td></td>
<td>Изображение</td>
<td>Любой значок или растровое изображение</td>
</tr>
<tr>
<td>Метка</td>
<td>name</td>
<td>companyLabel</td>
</tr>
<tr>
<td></td>
<td>Текста</td>
<td>Вкусная пицца</td>
</tr>
<tr>
<td></td>
<td>TabIndex</td>
<td>1</td>
</tr>
<tr>
<td></td>
<td>AccessibleDescription</td>
<td>Название компании</td>
</tr>
<tr>
<td></td>
<td>AccessibleName</td>
<td>Название компании</td>
</tr>
<tr>
<td></td>
<td>Backcolor</td>
<td>Синий</td>
</tr>
<tr>
<td></td>
<td>Forecolor</td>
<td>Желтый</td>
</tr>
<tr>
<td></td>
<td>Font size</td>
<td>18</td>
</tr>
<tr>
<td>Метка</td>
<td>name</td>
<td>customerLabel</td>
</tr>
<tr>
<td></td>
<td>Текста</td>
<td>&amp;Имя</td>
</tr>
<tr>
<td></td>
<td>TabIndex</td>
<td>2</td>
</tr>
<tr>
<td></td>
<td>AccessibleDescription</td>
<td>Подпись имени заказчика</td>
</tr>
<tr>
<td></td>
<td>AccessibleName</td>
<td>Подпись имени заказчика</td>
</tr>
<tr>
<td></td>
<td>UseMnemonic</td>
<td>True</td>
</tr>
<tr>
<td>TextBox</td>
<td>name</td>
<td>customerName</td>
</tr>
<tr>
<td></td>
<td>Текста</td>
<td>(нет)</td>
</tr>
<tr>
<td></td>
<td>TabIndex</td>
<td>3</td>
</tr>
<tr>
<td></td>
<td>AccessibleDescription</td>
<td>Имя заказчика</td>
</tr>
<tr>
<td></td>
<td>AccessibleName</td>
<td>Имя заказчика</td>
</tr>
<tr>
<td>GroupBox</td>
<td>name</td>
<td>sizeOptions</td>
</tr>
<tr>
<td></td>
<td>AccessibleDescription</td>
<td>Размеры порции пиццы</td>
</tr>
<tr>
<td></td>
<td>AccessibleName</td>
<td>Размеры порции пиццы</td>
</tr>
<tr>
<td></td>
<td>Текста</td>
<td>Размер пиццы</td>
</tr>
<tr>
<td></td>
<td>TabIndex</td>
<td>4</td>
</tr>
<tr>
<td>RadioButton</td>
<td>name</td>
<td>smallPizza</td>
</tr>
<tr>
<td></td>
<td>Текста</td>
<td>&amp;Маленькая 300 р.</td>
</tr>
<tr>
<td></td>
<td>Установлен</td>
<td>True</td>
</tr>
<tr>
<td></td>
<td>TabIndex</td>
<td>0</td>
</tr>
<tr>
<td></td>
<td>AccessibleDescription</td>
<td>Маленькая пицца</td>
</tr>
<tr>
<td></td>
<td>AccessibleName</td>
<td>Маленькая пицца</td>
</tr>
<tr>
<td>RadioButton</td>
<td>name</td>
<td>largePizza</td>
</tr>
<tr>
<td></td>
<td>Текста</td>
<td>&amp;Большая 500 р.</td>
</tr>
<tr>
<td></td>
<td>TabIndex</td>
<td>1</td>
</tr>
<tr>
<td></td>
<td>AccessibleDescription</td>
<td>Большая пицца</td>
</tr>
<tr>
<td></td>
<td>AccessibleName</td>
<td>Большая пицца</td>
</tr>
<tr>
<td>Метка</td>
<td>name</td>
<td>toppingsLabel</td>
</tr>
<tr>
<td></td>
<td>Текста</td>
<td>&amp;Начинки (40 р. за каждую)</td>
</tr>
<tr>
<td></td>
<td>TabIndex</td>
<td>5</td>
</tr>
<tr>
<td></td>
<td>AccessibleDescription</td>
<td>Метка начинки</td>
</tr>
<tr>
<td></td>
<td>AccessibleName</td>
<td>Метка начинки</td>
</tr>
<tr>
<td></td>
<td>UseMnemonic</td>
<td>True</td>
</tr>
<tr>
<td>CheckedListBox</td>
<td>name</td>
<td>toppings</td>
</tr>
<tr>
<td></td>
<td>TabIndex</td>
<td>6</td>
</tr>
<tr>
<td></td>
<td>AccessibleDescription</td>
<td>Выбор начинок</td>
</tr>
<tr>
<td></td>
<td>AccessibleName</td>
<td>Выбор начинок</td>
</tr>
<tr>
<td></td>
<td>Элементы</td>
<td>Пепперони, колбаса, грибы</td>
</tr>
<tr>
<td>Кнопка</td>
<td>name</td>
<td>порядок</td>
</tr>
<tr>
<td></td>
<td>Текста</td>
<td>&amp;Порядок</td>
</tr>
<tr>
<td></td>
<td>TabIndex</td>
<td>7</td>
</tr>
<tr>
<td></td>
<td>AccessibleDescription</td>
<td>Сумма заказа</td>
</tr>
<tr>
<td></td>
<td>AccessibleName</td>
<td>Сумма заказа</td>
</tr>
<tr>
<td>Кнопка</td>
<td>name</td>
<td>cancel</td>
</tr>
<tr>
<td></td>
<td>Текста</td>
<td>О&amp;тмена</td>
</tr>
<tr>
<td></td>
<td>TabIndex</td>
<td>8</td>
</tr>
<tr>
<td></td>
<td>AccessibleDescription</td>
<td>Отмена заказа</td>
</tr>
<tr>
<td></td>
<td>AccessibleName</td>
<td>Отмена заказа</td>
</tr>
<tr>
<td>MainMenu</td>
<td>name</td>
<td>theMainMenu</td>
</tr>
<tr>
<td>MenuItem</td>
<td>name</td>
<td>fileCommands</td>
</tr>
<tr>
<td></td>
<td>Текста</td>
<td>&amp;Файл</td>
</tr>
<tr>
<td>MenuItem</td>
<td>name</td>
<td>exitApp</td>
</tr>
<tr>
<td></td>
<td>Текста</td>
<td>Вы&amp;ход</td>
</tr>
</tbody>
</table>
<p>Форма будет выглядеть примерно как на следующем изображении:</p>
<p><img src="media/walkthrough-creating-an-accessible-windows-based-application/visual-basic-pizza-order-form.gif" alt="Форма заказа пиццы имя текстового поля и размер и начинки выделением."></p>
</li>
</ul>
<h2 id="supporting-high-contrast-mode">Поддержка режима высокой контрастности</h2>
<p>Режим высокой контрастности представляет собой тип системной настройки Windows, при которой удобство чтения текста повышается за счет более контрастных цветов и размеров шрифта, подходящих для пользователей с нарушениями зрения. <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.systeminformation.highcontrast">HighContrast</a> Свойство позволяет определить, установлен ли режим высокой контрастности.</p>
<p>Если свойство SystemInformation.HighContrast имеет значение <code>true</code>, то в приложении происходит следующее:</p>
<ul>
<li><p>Все элементы пользовательского интерфейса отображаются с использованием системной цветовой схемы.</p>
</li>
<li><p>Любая информация, передающаяся цветом, также передается с помощью визуальных или звуковых сигналов. Например, если определенный элемент списка выделен красным шрифтом, можно также отобразить его полужирным шрифтом, чтобы пользователь, не различающий цвета, видел, что элемент выделен.</p>
</li>
<li><p>Опускаются все рисунки или узоры за текстом.</p>
</li>
</ul>
<p>Приложение должно проверять значение свойства <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.systeminformation.highcontrast">HighContrast</a> при запуске и отвечать на системное событие <a class="xref" href="https://docs.microsoft.com/dotnet/api/microsoft.win32.systemevents.userpreferencechanged">UserPreferenceChanged</a>. При изменении значения свойства <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.systeminformation.highcontrast">HighContrast</a> происходит событие <a class="xref" href="https://docs.microsoft.com/dotnet/api/microsoft.win32.systemevents.userpreferencechanged">UserPreferenceChanged</a>.</p>
<p>В этом примере единственным элементом, не использующим системные параметры цвета, является <code>lblCompanyName</code>. <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.drawing.systemcolors">SystemColors</a> Класс используется для замены параметров цвета метки на выбранные пользователем системные цвета.</p>
<h4 id="to-enable-high-contrast-mode-in-an-effective-way">Эффективный способ обеспечения высокой контрастности</h4>
<ol>
<li><p>Создайте метод, задающий для метки системные цвета.</p>
<pre><code>' Visual Basic  
Private Sub SetColorScheme()  
   If SystemInformation.HighContrast Then  
      companyLabel.BackColor = SystemColors.Window  
      companyLabel.ForeColor = SystemColors.WindowText  
   Else  
      companyLabel.BackColor = Color.Blue  
      companyLabel.ForeColor = Color.Yellow  
   End If  
End Sub  

// C#  
private void SetColorScheme()  
{  
   if (SystemInformation.HighContrast)  
   {  
      companyLabel.BackColor = SystemColors.Window;  
      companyLabel.ForeColor = SystemColors.WindowText;  
   }  
   else  
   {  
      companyLabel.BackColor = Color.Blue;  
      companyLabel.ForeColor = Color.Yellow;  
   }  
}  
</code></pre>
</li>
<li><p>Вызовите процедуру <code>SetColorScheme</code> в конструкторе форм (<code>Public Sub New()</code> в Visual Basic; <code>public class Form1</code> в Visual C#). Чтобы получить доступ к конструктору в Visual Basic, необходимо развернуть область с меткой <strong>Код, автоматически созданный конструктором форм Windows</strong>.</p>
<pre><code>' Visual Basic   
Public Sub New()  
   MyBase.New()  
   InitializeComponent()  
   SetColorScheme()  
End Sub  

// C#  
public Form1()  
{  
   InitializeComponent();  
   SetColorScheme();  
}  
</code></pre>
</li>
<li><p>Создайте процедуру обработки события с соответствующей подписью для реагирования на событие <a class="xref" href="https://docs.microsoft.com/dotnet/api/microsoft.win32.systemevents.userpreferencechanged">UserPreferenceChanged</a>.</p>
<pre><code>' Visual Basic  
Protected Sub UserPreferenceChanged(ByVal sender As Object, _  
ByVal e As Microsoft.Win32.UserPreferenceChangedEventArgs)  
   SetColorScheme()  
End Sub  

// C#  
public void UserPreferenceChanged(object sender,   
Microsoft.Win32.UserPreferenceChangedEventArgs e)  
{  
   SetColorScheme();  
}  
</code></pre>
</li>
<li><p>Добавьте код в конструктор форм после вызова метода <code>InitializeComponents</code>, чтобы подключить процедуру обработки событий к системному событию. Этот метод вызывает процедуру <code>SetColorScheme</code>.</p>
<pre><code>' Visual Basic  
Public Sub New()  
   MyBase.New()  
   InitializeComponent()  
   SetColorScheme()  
   AddHandler Microsoft.Win32.SystemEvents.UserPreferenceChanged, _  
      AddressOf Me.UserPreferenceChanged  
End Sub  

// C#  
public Form1()  
{  
   InitializeComponent();  
   SetColorScheme();  
   Microsoft.Win32.SystemEvents.UserPreferenceChanged   
      += new Microsoft.Win32.UserPreferenceChangedEventHandler(  
      this.UserPreferenceChanged);  
}  
</code></pre>
</li>
<li><p>Добавьте код в метод <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.control.dispose">Dispose</a> формы перед вызовом метода <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.control.dispose">Dispose</a> базового класса, чтобы освободить событие при закрытии приложения. Чтобы получить доступ к методу <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.forms.control.dispose">Dispose</a> в Visual Basic, необходимо развернуть область &quot;Код, автоматически созданный конструктором форм Windows&quot;.</p>
<div class="NOTE">
<h5>Note</h5>
<p>Код системного события выполняется в потоке, отдельном от основного приложения. Если не освободить событие, то код, связанный с событием, будет выполняться даже после закрытия программы.</p>
</div>
<pre><code>' Visual Basic  
Protected Overloads Overrides Sub Dispose(ByVal disposing As Boolean)  
   If disposing Then  
      If Not (components Is Nothing) Then  
         components.Dispose()  
      End If  
   End If  
   RemoveHandler Microsoft.Win32.SystemEvents.UserPreferenceChanged, _  
      AddressOf Me.UserPreferenceChanged  
   MyBase.Dispose(disposing)  
End Sub  

// C#  
protected override void Dispose( bool disposing )  
{  
   if( disposing )  
   {  
      if (components != null)   
      {  
         components.Dispose();  
      }  
   }  
   Microsoft.Win32.SystemEvents.UserPreferenceChanged   
      -= new Microsoft.Win32.UserPreferenceChangedEventHandler(  
      this.UserPreferenceChanged);  
   base.Dispose( disposing );  
}  
</code></pre>
</li>
<li><p>Нажмите клавишу F5 для запуска приложения.</p>
</li>
</ol>
<h2 id="conveying-important-information-by-means-other-than-sound">Передача важной информации способами помимо звукового сигнала</h2>
<p>В этом приложении никакая информация не предоставляется только с помощью звукового сигнала. Если вы используете звук в своем приложении, следует также предусмотреть альтернативные способы передачи информации.</p>
<h4 id="to-supply-information-by-some-other-means-than-sound">Обеспечение передачи важной информации способами помимо звукового сигнала</h4>
<ol>
<li><p>Сделайте строку заголовка мигающей с помощью функции FlashWindow интерфейса Windows API. Пример вызова функций Windows API, см. в разделе <a href="../../../visual-basic/programming-guide/com-interop/walkthrough-calling-windows-apis.md">Пошаговое руководство: Вызов Windows API</a>.</p>
<div class="NOTE">
<h5>Note</h5>
<p>У пользователя может быть включена служба визуального оповещения Windows, что также приведет к миганию окна при подаче системных звуковых сигналов через встроенные динамики компьютера.</p>
</div>
</li>
<li><p>Выводите важную информацию в немодальном окне, чтобы пользователь мог реагировать на нее.</p>
</li>
<li><p>При выводе окна сообщения передавайте ему фокус клавиатуры. Этот способ не следует применять в момент, когда пользователь может осуществлять ввод с клавиатуры.</p>
</li>
<li><p>Выводите индикатор состояния в области уведомлений о состоянии панели задач. Подробнее см. в разделе <a href="../controls/app-icons-to-the-taskbar-with-wf-notifyicon.html">Практическое руководство. Добавление значков приложения на панель задач с помощью компонента NotifyIcon в Windows Forms</a>.</p>
</li>
</ol>
<h2 id="testing-the-application">Тестирование приложения</h2>
<p>Перед развертыванием приложения необходимо протестировать реализованные специальные возможности.</p>
<h4 id="to-test-accessibility-features">Тестирование специальных возможностей</h4>
<ol>
<li><p>Для проверки доступа с клавиатуры отключите мышь и перейдите к каждому элемента пользовательского интерфейса, используя только клавиатуру. Убедитесь в том, что все задачи можно выполнить с помощью клавиатуры.</p>
</li>
<li><p>Для проверки режима высокой контрастности используйте компонент &quot;Специальные возможности&quot; на панели управления. Выберите вкладку &quot;Экран&quot; и установите флажок &quot;Высокая контрастность&quot;. Перейдите по всем элементам управления и убедитесь в том, что отражаются изменения цвета и шрифта. Кроме того, убедитесь в том, что отсутствуют рисунки или узоры под текстом.</p>
<div class="NOTE">
<h5>Note</h5>
<p>В Windows NT 4 значок &quot;Специальные возможности&quot; на панели управления отсутствует. Поэтому этот способ изменения значения свойства SystemInformation.HighContrast не работает в Windows NT 4.</p>
</div>
</li>
<li><p>Доступны также другие средства тестирования специальных возможностей приложения.</p>
</li>
<li><p>Для тестирования демонстрации фокуса клавиатуры запустите экранную лупу. (Для этого нажмите кнопку <strong>Пуск</strong>, выберите <strong>Программы</strong>, <strong>Стандартные</strong>, <strong>Специальные возможности</strong>, а затем щелкните <strong>Экранная лупа</strong>.) Выполните переходы по интерфейсу пользователя, используя клавишу TAB и мышь. Убедитесь в том, что все переходы правильно отображаются <strong>экранной лупой</strong>.</p>
</li>
<li><p>Для проверки отображения элементов экрана запустите программу Inspect и перейдите к каждому элементу с помощью мыши и клавиши TAB. Убедитесь в том, что сведения, выводящиеся в полях &quot;Name&quot;, &quot;State&quot;, &quot;Role&quot;, &quot;Location&quot; и &quot;Value&quot; окна программы Inspect для каждого объекта в интерфейсе являются полезными для пользователя.</p>
</li>
</ol>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span><a href="https://github.com/MSDN-WhiteKnight/dotnet-docs-ru">Неофициальная документация по .NET на русском языке</a>. Лицензия: <a href="https://github.com/MSDN-WhiteKnight/dotnet-docs-ru/blob/main/LICENSE">CC-BY 4.0</a>. Основано на <a href="https://docs.microsoft.com/ru-ru/dotnet/">документации по .NET с Microsoft Docs</a><br>Generated by <strong>DocFX</strong></span><script type="text/javascript">(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(65150713, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/65150713" style="position:absolute; left:-9999px;" alt=""></div></noscript>
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>
  </body>
</html>
