<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>&#1052;&#1077;&#1090;&#1072;&#1076;&#1072;&#1085;&#1085;&#1099;&#1077; &#1089;&#1074;&#1086;&#1081;&#1089;&#1090;&#1074; &#1089;&#1088;&#1077;&#1076;&#1099; | &#1053;&#1077;&#1086;&#1092;&#1080;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1072;&#1103; &#1076;&#1086;&#1082;&#1091;&#1084;&#1077;&#1085;&#1090;&#1072;&#1094;&#1080;&#1103; .NET </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="&#1052;&#1077;&#1090;&#1072;&#1076;&#1072;&#1085;&#1085;&#1099;&#1077; &#1089;&#1074;&#1086;&#1081;&#1089;&#1090;&#1074; &#1089;&#1088;&#1077;&#1076;&#1099; | &#1053;&#1077;&#1086;&#1092;&#1080;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1072;&#1103; &#1076;&#1086;&#1082;&#1091;&#1084;&#1077;&#1085;&#1090;&#1072;&#1094;&#1080;&#1103; .NET ">
    <meta name="generator" content="docfx 2.40.12.0">
    
    <link rel="shortcut icon" href="../../../favicon.ico">
    <link rel="stylesheet" href="../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../styles/main.css">
    <meta property="docfx:navrel" content="../../../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../index.html">
                <img id="logo" class="svg" src="../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="framework-property-metadata">Метаданные свойств среды</h1>

<p>Параметры метаданных свойств среды сообщаются для свойств элементов объектов, которые, как считается, в архитектуре Windows Presentation Foundation (WPF) находятся на уровне среды WPF. В целом привязка к уровню среды WPF подразумевает, что такие функции, как отрисовка, привязка данных и уточнение системных свойств, обрабатываются в презентации WPF API и исполняемых файлах. Метаданные свойств среды запрашиваются этими системами для определения функциональных характеристик конкретных свойств элемента.</p>
<p><a name="prerequisites"></a></p>
<h2 id="prerequisites">Предварительные требования</h2>
<p>Предполагается, что вы имеете представление о свойствах зависимостей с точки зрения потребителя существующих свойств зависимостей в классах Windows Presentation Foundation (WPF) и ознакомились с разделом <a href="dependency-properties-overview.html">Общие сведения о свойствах зависимостей</a>. Вам следует также ознакомиться с разделом <a href="dependency-property-metadata.html">Метаданные свойства зависимости</a>.</p>
<p><a name="What_Is_Communicated_by_Framework_Property"></a></p>
<h2 id="what-is-communicated-by-framework-property-metadata">Передаваемые сведения в метаданных свойств среды</h2>
<p>Метаданные свойств среды можно разделить на следующие категории.</p>
<ul>
<li><p>Передающие свойства макета, влияющие на элемент (<a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkpropertymetadata.affectsarrange">AffectsArrange</a>, <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkpropertymetadata.affectsmeasure">AffectsMeasure</a>, <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkpropertymetadata.affectsrender">AffectsRender</a>). Может задать эти флаги в метаданных, если свойство влияет на соответствующие аспекты, а также реализации <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkelement.measureoverride">MeasureOverride</a>  /  <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkelement.arrangeoverride">ArrangeOverride</a> методы в классе для предоставления поведение визуализации и сведения в макет система. Как правило, такая реализация проверяет аннулирование свойств в свойствах зависимости, где любое из этих свойств макета имело в метаданных свойств значение true, и только для таких аннулирований необходимо запросить новый проход макета.</p>
</li>
<li><p>Передающие свойства макета, влияющие на родительский элемент элемента (<a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkpropertymetadata.affectsparentarrange">AffectsParentArrange</a>, <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkpropertymetadata.affectsparentmeasure">AffectsParentMeasure</a>). Некоторые примеры, где эти флаги установлены по умолчанию: <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.documents.fixedpage.left">FixedPage.Left</a> и <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.documents.paragraph.keepwithnext">Paragraph.KeepWithNext</a>.</p>
</li>
<li><p><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkpropertymetadata.inherits">Inherits</a>. По умолчанию свойства зависимости не наследуют значения. <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkpropertymetadata.overridesinheritancebehavior">OverridesInheritanceBehavior</a> позволяет перемещать путь наследования в визуальное дерево, которое необходимо для некоторых сценариев управления.</p>
<div class="NOTE">
<h5>Note</h5>
<p>Термин &quot;наследует&quot; в контексте значений свойств имеет особое значение для свойств зависимостей; это означает, что дочерние элементы могут наследовать фактическое значение свойства зависимости от родительских элементов (это обусловлено возможностью системы свойств WPF на уровне среды WPF). Это не имеет ничего общего непосредственно с типом управляемого кода и наследованием элементов через производные типы. Подробнее см. в разделе <a href="property-value-inheritance.html">Наследование значения свойства</a>.</p>
</div>
</li>
<li><p>Передающие характеристики привязки данных (<a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkpropertymetadata.isnotdatabindable">IsNotDataBindable</a>, <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkpropertymetadata.bindstwowaybydefault">BindsTwoWayByDefault</a>). По умолчанию свойства зависимости в среде поддерживают привязку данных с односторонним поведением привязки. Привязку данных можно было бы отключить, если бы сценарий для нее отсутствовал в принципе (поскольку они должны быть гибкими и расширяемыми, однако примеров таких свойств в WPF API по умолчанию не много). Можно задать привязку для получения двусторонней привязки по умолчанию для свойств, объединяющих поведения элемента управления среди их составляющих (<a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.controls.menuitem.issubmenuopen">IsSubmenuOpen</a> приведен пример) или если двусторонняя привязка является распространенным и ожидаемым сценарием для пользователей (<a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.controls.textbox.text">Text</a> является примером). Изменение метаданных, связанных с привязкой данных, влияет только на значение по умолчанию; на уровне отдельных привязок это значение по умолчанию всегда можно изменить. Сведения о режимах связывания и связывании в целом см. в разделе <a href="../data/data-binding-overview.html">Общие сведения о связывании данных</a>.</p>
</li>
<li><p>Отчеты, должны ли свойства приложения или службы, поддерживающие ведение журнала (<a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkpropertymetadata.journal">Journal</a>). Для общих элементов ведение журнала не включено по умолчанию, но оно выборочно включается для некоторых пользовательских элементов управления вводом. Это свойство предназначено для прочтения службами ведения журнала, включая реализацию WPF ведения журнала, и обычно устанавливается для пользовательских элементов управления, таких как пользовательский выбор в списках, который необходимо сохранять на протяжении нескольких шагов навигации. Сведения о журнале см. в разделе <a href="../app-development/navigation-overview.html">Общие сведения о навигации</a>.</p>
</li>
</ul>
<p><a name="Reading_FrameworkPropertyMetadata"></a></p>
<h2 id="reading-frameworkpropertymetadata">Чтение FrameworkPropertyMetadata</h2>
<p>Каждое из свойств ссылки выше являются специальными свойствами, <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkpropertymetadata">FrameworkPropertyMetadata</a> добавляет в свой непосредственный базовый класс <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.uipropertymetadata">UIPropertyMetadata</a>. Каждое из этих свойств будет иметь значение <code>false</code> по умолчанию. Запрос метаданных для свойства, где важно знать значение этих свойств следует попытаться привести возвращаемые метаданные к <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkpropertymetadata">FrameworkPropertyMetadata</a>, а затем при необходимости проверить значения отдельных свойств.</p>
<p><a name="Specifying_Metadata"></a></p>
<h2 id="specifying-metadata">Задание метаданных</h2>
<p>Создавая новый экземпляр метаданных в целях применения метаданных к новой регистрации свойства зависимостей, вы можете выбрать класс метаданных для использования: базовый <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.propertymetadata">PropertyMetadata</a> или некоторые производного класса, такие как <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkpropertymetadata">FrameworkPropertyMetadata</a>. В общем случае следует использовать <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkpropertymetadata">FrameworkPropertyMetadata</a>, особенно в том случае, если свойство имеет любое взаимодействие с системой свойств и WPF функции, такие как макет и привязка данных. Другой вариант в более сложных сценариях является наследование от <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkpropertymetadata">FrameworkPropertyMetadata</a> для создания собственных метаданных класс, с дополнительными сведениями отчетов они передаются в его члены. Или можно использовать <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.propertymetadata">PropertyMetadata</a> или <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.uipropertymetadata">UIPropertyMetadata</a> для передачи степени поддержки функций вашей реализации.</p>
<p>Для существующих свойств (<a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.dependencyproperty.addowner">AddOwner</a> или <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.dependencyproperty.overridemetadata">OverrideMetadata</a> вызова), необходимо всегда выполнять переопределение с типом метаданных, использованным исходной регистрацией.</p>
<p>Если вы создаете <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkpropertymetadata">FrameworkPropertyMetadata</a> экземпляра, существует два способа заполнения метаданных значениями для определенных свойств, передающих характеристики свойств среды:</p>
<ol>
<li><p>Используйте <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkpropertymetadata">FrameworkPropertyMetadata</a> сигнатура конструктора, который позволяет <code>flags</code> параметра. Этот параметр должен быть заполнен всеми нужными комбинированных значений из <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkpropertymetadataoptions">FrameworkPropertyMetadataOptions</a> флаги перечисления.</p>
</li>
<li><p>Используйте одну из подписей без <code>flags</code> параметра, а затем настройте каждое логическое свойство отчетности на <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkpropertymetadata">FrameworkPropertyMetadata</a> для <code>true</code> для каждого требуемого изменения характеристики. Если сделать это, необходимо настроить эти свойства до создания каких-либо элементов с этим свойством зависимости. Логические свойства доступны для чтения и записи, чтобы разрешить поведение, которое избегает параметра <code>flags</code> и все равно заполняет метаданные, однако метаданные необходимо эффективно паковать, прежде чем использовать свойство. Таким образом, попытка задать свойства после запроса метаданных будет недопустимой операцией.</p>
</li>
</ol>
<p><a name="Framework_Property_Metadata_Merge_Behavior"></a></p>
<h2 id="framework-property-metadata-merge-behavior">Поведение слияния метаданных свойств среды</h2>
<p>При переопределении метаданных свойств среды различные характеристики метаданных объединяются или заменяют друг друга.</p>
<ul>
<li><p><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.propertymetadata.propertychangedcallback">PropertyChangedCallback</a> объединяются. При добавлении нового <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.propertymetadata.propertychangedcallback">PropertyChangedCallback</a>, соответствующий обратный вызов хранится в метаданных. Если вы не укажете <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.propertymetadata.propertychangedcallback">PropertyChangedCallback</a> в переопределении, значение <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.propertymetadata.propertychangedcallback">PropertyChangedCallback</a> переходит в качестве ссылки из ближайшего родительского объекта, указанного в метаданных.</p>
</li>
<li><p>Фактическое поведение системы свойств для <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.propertymetadata.propertychangedcallback">PropertyChangedCallback</a> является то, что реализации для всех владельцев метаданных в иерархии сохраняются и добавляются в таблицу, в порядке выполнения системой свойств, что обратные вызовы наиболее глубоких производных классов Сначала вызывается. Наследуемые обратные вызовы выполняются только один раз и считается, что они принадлежат классу, разместившему их в метаданных.</p>
</li>
<li><p><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.propertymetadata.defaultvalue">DefaultValue</a> заменяется. Если вы не укажете <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.propertymetadata.propertychangedcallback">PropertyChangedCallback</a> в переопределении, значение <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.propertymetadata.defaultvalue">DefaultValue</a> поступают из ближайшего родительского объекта, указанного в метаданных.</p>
</li>
<li><p><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.propertymetadata.coercevaluecallback">CoerceValueCallback</a> реализации заменяются. При добавлении нового <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.propertymetadata.coercevaluecallback">CoerceValueCallback</a>, соответствующий обратный вызов хранится в метаданных. Если вы не укажете <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.propertymetadata.coercevaluecallback">CoerceValueCallback</a> в переопределении, значение <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.propertymetadata.coercevaluecallback">CoerceValueCallback</a> переходит в качестве ссылки из ближайшего родительского объекта, указанного в метаданных.</p>
</li>
<li><p>Поведение системы свойств является только <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.propertymetadata.coercevaluecallback">CoerceValueCallback</a> вызывается в непосредственных метаданных. Ссылки на другие <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.propertymetadata.coercevaluecallback">CoerceValueCallback</a> реализаций в иерархии сохраняются.</p>
</li>
<li><p>Флаги <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkpropertymetadataoptions">FrameworkPropertyMetadataOptions</a> перечисления, объединяются в виде битовой операции OR.  Если указать <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkpropertymetadataoptions">FrameworkPropertyMetadataOptions</a>, исходные параметры не перезаписываются.  Чтобы изменить параметр, задайте соответствующее свойство на <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkpropertymetadata">FrameworkPropertyMetadata</a>. Например если исходный <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkpropertymetadata">FrameworkPropertyMetadata</a> набора объектов <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkpropertymetadataoptions#System_Windows_FrameworkPropertyMetadataOptions_NotDataBindable">FrameworkPropertyMetadataOptions.NotDataBindable</a> флаг, можно изменить, установив <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkpropertymetadata.isnotdatabindable">FrameworkPropertyMetadata.IsNotDataBindable</a> для <code>false</code>.</p>
</li>
</ul>
<p>Это поведение реализуется <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.frameworkpropertymetadata.merge">Merge</a>и могут переопределяться в производных классах метаданных.</p>
<h2 id="see-also">См. также</h2>
<ul>
<li><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.dependencyproperty.getmetadata">GetMetadata</a></li>
<li><a href="dependency-property-metadata.html">Метаданные свойства зависимости</a></li>
<li><a href="dependency-properties-overview.html">Общие сведения о свойствах зависимости</a></li>
<li><a href="custom-dependency-properties.html">Пользовательские свойства зависимостей</a></li>
</ul>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span><a href="https://github.com/MSDN-WhiteKnight/dotnet-docs-ru">Неофициальная документация по .NET на русском языке</a>. Лицензия: <a href="https://github.com/MSDN-WhiteKnight/dotnet-docs-ru/blob/main/LICENSE">CC-BY 4.0</a>. Основано на <a href="https://docs.microsoft.com/ru-ru/dotnet/">документации по .NET с Microsoft Docs</a><br>Generated by <strong>DocFX</strong></span><script type="text/javascript">(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(65150713, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/65150713" style="position:absolute; left:-9999px;" alt=""></div></noscript>
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>
  </body>
</html>
