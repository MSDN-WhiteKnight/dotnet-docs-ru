<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>&#1044;&#1072;&#1085;&#1085;&#1099;&#1077; &#1080; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1099; &#1076;&#1072;&#1085;&#1085;&#1099;&#1093; | &#1053;&#1077;&#1086;&#1092;&#1080;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1072;&#1103; &#1076;&#1086;&#1082;&#1091;&#1084;&#1077;&#1085;&#1090;&#1072;&#1094;&#1080;&#1103; .NET </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="&#1044;&#1072;&#1085;&#1085;&#1099;&#1077; &#1080; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1099; &#1076;&#1072;&#1085;&#1085;&#1099;&#1093; | &#1053;&#1077;&#1086;&#1092;&#1080;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1072;&#1103; &#1076;&#1086;&#1082;&#1091;&#1084;&#1077;&#1085;&#1090;&#1072;&#1094;&#1080;&#1103; .NET ">
    <meta name="generator" content="docfx 2.40.12.0">
    
    <link rel="shortcut icon" href="../../../favicon.ico">
    <link rel="stylesheet" href="../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../styles/main.css">
    <meta property="docfx:navrel" content="../../../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../index.html">
                <img id="logo" class="svg" src="../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="data-and-data-objects">Данные и объекты данных</h1>

<p>Данные, передаваемые как часть операции перетаскивания и вставки хранятся в объекте данных.  Концептуально объект данных состоит из одного или нескольких из следующих пар:</p>
<ul>
<li><p><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.object">Object</a> , Содержит фактические данные.</p>
</li>
<li><p>Соответствующий идентификатор формата данных.</p>
</li>
</ul>
<p>Сами данные могут состоять из всего, который может быть представлен в качестве основы <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.object">Object</a>.  Соответствующий формат данных является строкой или <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.type">Type</a> , предоставляет подсказку о формате в.  Объекты данных поддерживают размещение нескольких пар формат данных/данные; Это позволяет один объект данных для предоставления данных в нескольких форматах.</p>
<p><a name="Data_and_Data_Objects"></a></p>
<h2 id="data-objects">Объекты данных</h2>
<p>Все объекты данных должны реализовывать <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.idataobject">IDataObject</a> интерфейс, который предоставляет следующий стандартный набор методов для включения и упрощения передачи данных.</p>
<table>
<thead>
<tr>
<th>Метод</th>
<th>Сводка</th>
</tr>
</thead>
<tbody>
<tr>
<td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.idataobject.getdata">GetData</a></td>
<td>Извлекает объект данных в указанном формате данных.</td>
</tr>
<tr>
<td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.idataobject.getdatapresent">GetDataPresent</a></td>
<td>Проверяет наличие данных в, или можно преобразовать в указанный формат.</td>
</tr>
<tr>
<td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.idataobject.getformats">GetFormats</a></td>
<td>Возвращает список форматов, которые хранятся в данные в этом объекте данных, или может быть преобразован в.</td>
</tr>
<tr>
<td><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.idataobject.setdata">SetData</a></td>
<td>Сохраняет указанные данные в этом объекте данных.</td>
</tr>
</tbody>
</table>
<p>WPF Предоставляет базовую реализацию <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.idataobject">IDataObject</a> в <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.dataobject">DataObject</a> класса. Акции <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.dataobject">DataObject</a> класс является достаточным для многих распространенных сценариев передачи данных.</p>
<p>Существует несколько предварительно определенных форматов, таких как растровое изображение, CSV, файл, HTML, RTF, строки, текст и аудио. Сведения о преопределенных форматах данных в состав WPF, см. в разделе <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.dataformats">DataFormats</a> класс справочном разделе.</p>
<p>Объекты данных обычно включают средства для автоматического преобразования данных, хранящихся в одного формата в другой формат при извлечении данных; Это средство называется автоматический переход. При запросе форматов данных, доступных в объекте данных, автоматически преобразуемые форматы могут фильтроваться из собственных форматов данных, вызвав <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.dataobject.getformats#System_Windows_DataObject_GetFormats_System_Boolean_">GetFormats(Boolean)</a> или <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.dataobject.getdatapresent#System_Windows_DataObject_GetDataPresent_System_String_System_Boolean_">GetDataPresent(String, Boolean)</a> и задав <code>autoConvert</code> параметра в виде <code>false</code>.  При добавлении данных в объект данных с <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.dataobject.setdata#System_Windows_DataObject_SetData_System_String_System_Object_System_Boolean_">SetData(String, Object, Boolean)</a> метод, автоматическое преобразование данных может быть запрещено, задав <code>autoConvert</code> параметр <code>false</code>.</p>
<p><a name="Working_with_Data_Objects"></a></p>
<h2 id="working-with-data-objects">Работа с объектами данных</h2>
<p>В этом разделе описаны общие методы для создания и работы с объектами данных.</p>
<h3 id="creating-new-data-objects">Создание новых объектов данных</h3>
<p><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.dataobject">DataObject</a> Класс предоставляет несколько перегруженных конструкторов, предназначенных для упрощения заполнение нового <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.dataobject">DataObject</a> экземпляра с парой формат единый данных.</p>
<p>В следующем примере кода создается новый объект данных и использует один из перегруженных конструкторов <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.dataobject.-ctor">DataObject</a>(<a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.dataobject.-ctor#System_Windows_DataObject__ctor_System_String_System_Object_">DataObject(String, Object)</a>) для инициализации объекта данных со строкой и заданного формата данных.  В этом случае формат данных задается строкой. <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.dataformats">DataFormats</a> класс предоставляет набор предопределенных типов строк. По умолчанию разрешен автоматического преобразования хранимых данных.</p>
<pre><code class="lang-csharp" name="DragDrop_DragDropMiscCode#_DragDrop_CreateDataObject_TypeString">string stringData = &quot;Some string data to store...&quot;;
string dataFormat = DataFormats.UnicodeText;
DataObject dataObject = new DataObject(dataFormat, stringData);
</code></pre><div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<p>Дополнительные примеры кода, который создает объект данных, см. в разделе <a href="how-to-create-a-data-object.html">создать объект данных</a>.</p>
<h3 id="storing-data-in-multiple-formats">Хранение данных в нескольких форматах</h3>
<p>Один объект данных имеет возможность хранения данных в нескольких форматах.   Стратегического использования данных в нескольких форматах в одном объекте данных делает объект данных множеством разных мест перетаскивания, чем шире, если только может быть представлен только один формат данных.  Обратите внимание на то, что, как правило, источником перетаскивания не должны зависеть о форматах данных, которые могут использоваться возможные конечные расположения сброса.</p>
<p>В следующем примере показано, как использовать <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.dataobject.setdata#System_Windows_DataObject_SetData_System_String_System_Object_">SetData(String, Object)</a> метод для добавления данных в объект данных в нескольких форматах.</p>
<pre><code class="lang-csharp" name="DragDrop_DragDropMiscCode#_DragDrop_StoreMultipleFormats">DataObject dataObject = new DataObject();
string sourceData = &quot;Some string data to store...&quot;;

// Encode the source string into Unicode byte arrays.
byte[] unicodeText = Encoding.Unicode.GetBytes(sourceData); // UTF-16
byte[] utf8Text = Encoding.UTF8.GetBytes(sourceData);
byte[] utf32Text = Encoding.UTF32.GetBytes(sourceData);

// The DataFormats class does not provide data format fields for denoting
// UTF-32 and UTF-8, which are seldom used in practice; the following strings
// will be used to identify these &quot;custom&quot; data formats.
string utf32DataFormat = &quot;UTF-32&quot;;
string utf8DataFormat  = &quot;UTF-8&quot;;

// Store the text in the data object, letting the data object choose
// the data format (which will be DataFormats.Text in this case).
dataObject.SetData(sourceData);
// Store the Unicode text in the data object.  Text data can be automatically
// converted to Unicode (UTF-16 / UCS-2) format on extraction from the data object;
// Therefore, explicitly converting the source text to Unicode is generally unnecessary, and
// is done here as an exercise only.
dataObject.SetData(DataFormats.UnicodeText, unicodeText);
// Store the UTF-8 text in the data object...
dataObject.SetData(utf8DataFormat, utf8Text);
// Store the UTF-32 text in the data object...
dataObject.SetData(utf32DataFormat, utf32Text);
</code></pre><div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div><h3 id="querying-a-data-object-for-available-formats">Опрашивается объект данных для доступных форматов</h3>
<p>Так как один объект данных может содержать произвольное число форматов данных, объекты данных включают средства для получения списка доступных форматов данных.</p>
<p>В следующем примере кода используется <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.dataobject.getformats">GetFormats</a> перегрузки, чтобы получить массив строк, обозначающих все форматы данных, доступные в объекте данных (собственный и с автоматическим преобразованием).</p>
<pre><code class="lang-csharp" name="DragDrop_DragDropMiscCode#_DragDrop_GetAllDataFormats">DataObject dataObject = new DataObject(&quot;Some string data to store...&quot;);

// Get an array of strings, each string denoting a data format
// that is available in the data object.  This overload of GetDataFormats
// returns all available data formats, native and auto-convertible.
string[] dataFormats = dataObject.GetFormats();

// Get the number of data formats present in the data object, including both
// auto-convertible and native data formats.
int numberOfDataFormats = dataFormats.Length;

// To enumerate the resulting array of data formats, and take some action when
// a particular data format is found, use a code structure similar to the following.
foreach (string dataFormat in dataFormats)
{
    if (dataFormat == DataFormats.Text)
    {
        // Take some action if/when data in the Text data format is found.
        break;
    }
    else if(dataFormat == DataFormats.StringFormat)
    {
        // Take some action if/when data in the string data format is found.
        break;
    }
}
</code></pre><div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<p>Дополнительные примеры кода, который запрашивает объект данных, доступные форматы данных, см. в разделе <a href="how-to-list-the-data-formats-in-a-data-object.html">перечисление форматов данных в объекте данных</a>.  Примеры запросов объектов данных на наличие определенного формата данных, см. в разделе <a href="how-to-determine-if-a-data-format-is-present-in-a-data-object.html">Определение присутствия формата данных в объекте данных</a>.</p>
<h3 id="retrieving-data-from-a-data-object">Извлечение данных из объекта данных</h3>
<p>Извлечение данных из объекта данных в определенном формате необходимо просто вызвать один из <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.dataobject.getdata">GetData</a> методы и указав требуемый формат данных.  Один из <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.dataobject.getdatapresent">GetDataPresent</a> методы могут использоваться для проверки на наличие определенного формата данных.  <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.dataobject.getdata">GetData</a> Возвращает данные в <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.object">Object</a>; в зависимости от формата данных, этот объект может быть приведен к контейнеру определенного типа.</p>
<p>В следующем примере кода используется <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.dataobject.getdatapresent#System_Windows_DataObject_GetDataPresent_System_String_">GetDataPresent(String)</a> перегрузки, чтобы проверить, доступно ли заданного формата данных (встроенный или с автоматическим преобразованием). Если доступен указанный формат, данные извлекаются с помощью <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.dataobject.getdata#System_Windows_DataObject_GetData_System_String_">GetData(String)</a> метод.</p>
<pre><code class="lang-csharp" name="DragDrop_DragDropMiscCode#_DragDrop_GetSpecificDataFormat">DataObject dataObject = new DataObject(&quot;Some string data to store...&quot;);

string desiredFormat = DataFormats.UnicodeText;
byte[] data = null;

// Use the GetDataPresent method to check for the presence of a desired data format.
// This particular overload of GetDataPresent looks for both native and auto-convertible
// data formats.
if (dataObject.GetDataPresent(desiredFormat))
{
    // If the desired data format is present, use one of the GetData methods to retrieve the
    // data from the data object.
    data = dataObject.GetData(desiredFormat) as byte[];
}
</code></pre><div class="WARNING">
<h5>Warning</h5>
<p>It looks like the sample you are looking for does not exist.</p>
</div>
<p>Дополнительные примеры кода, который извлекает данные из объекта данных, см. в разделе <a href="how-to-retrieve-data-in-a-particular-data-format.html">получение данных в определенном формате данных</a>.</p>
<h3 id="removing-data-from-a-data-object">Удаление данных из объекта данных</h3>
<p>Невозможно удалить данные непосредственно из объекта данных.  Для эффективного удаления данных из объекта данных, выполните следующие действия.</p>
<ol>
<li><p>Создайте новый объект данных, который будет содержать только данные, которые вы хотите сохранить.</p>
</li>
<li><p>«Копировать» необходимых данных из старых объектов данных в новый объект данных.  Чтобы скопировать данные, используйте один из <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.dataobject.getdata">GetData</a> методы для получения <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.object">Object</a> содержит необработанные данные и затем воспользуйтесь одним из <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.dataobject.setdata">SetData</a> методы для добавления данных в новый объект данных.</p>
</li>
<li><p>Замените старый объект данных новым.</p>
</li>
</ol>
<div class="NOTE">
<h5>Note</h5>
<p><a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.dataobject.setdata">SetData</a> Методы добавлять только данные в объект данных; они не избавляют данных, даже если в данных и формат данных точно так же, как в предыдущем вызове. Вызов <a class="xref" href="https://docs.microsoft.com/dotnet/api/system.windows.dataobject.setdata">SetData</a> дважды, чтобы те же данные и данные формат приведет к формат данных и данных, они отсутствуют в объекте данных дважды.</p>
</div>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span><a href="https://github.com/MSDN-WhiteKnight/dotnet-docs-ru">Неофициальная документация по .NET на русском языке</a>. Лицензия: <a href="https://github.com/MSDN-WhiteKnight/dotnet-docs-ru/blob/main/LICENSE">CC-BY 4.0</a>. Основано на <a href="https://docs.microsoft.com/ru-ru/dotnet/">документации по .NET с Microsoft Docs</a><br>Generated by <strong>DocFX</strong></span><script type="text/javascript">(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(65150713, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/65150713" style="position:absolute; left:-9999px;" alt=""></div></noscript>
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>
  </body>
</html>
