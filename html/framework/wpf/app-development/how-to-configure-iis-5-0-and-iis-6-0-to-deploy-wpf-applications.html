<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>&#1055;&#1088;&#1072;&#1082;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1086;&#1077; &#1088;&#1091;&#1082;&#1086;&#1074;&#1086;&#1076;&#1089;&#1090;&#1074;&#1086;. &#1053;&#1072;&#1089;&#1090;&#1088;&#1086;&#1081;&#1082;&#1072; &#1089;&#1083;&#1091;&#1078;&#1073; IIS 5.0 &#1080; IIS 6.0 &#1076;&#1083;&#1103; &#1088;&#1072;&#1079;&#1074;&#1077;&#1088;&#1090;&#1099;&#1074;&#1072;&#1085;&#1080;&#1103; &#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1081; WPF | &#1053;&#1077;&#1086;&#1092;&#1080;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1072;&#1103; &#1076;&#1086;&#1082;&#1091;&#1084;&#1077;&#1085;&#1090;&#1072;&#1094;&#1080;&#1103; .NET </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="&#1055;&#1088;&#1072;&#1082;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1086;&#1077; &#1088;&#1091;&#1082;&#1086;&#1074;&#1086;&#1076;&#1089;&#1090;&#1074;&#1086;. &#1053;&#1072;&#1089;&#1090;&#1088;&#1086;&#1081;&#1082;&#1072; &#1089;&#1083;&#1091;&#1078;&#1073; IIS 5.0 &#1080; IIS 6.0 &#1076;&#1083;&#1103; &#1088;&#1072;&#1079;&#1074;&#1077;&#1088;&#1090;&#1099;&#1074;&#1072;&#1085;&#1080;&#1103; &#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1081; WPF | &#1053;&#1077;&#1086;&#1092;&#1080;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1072;&#1103; &#1076;&#1086;&#1082;&#1091;&#1084;&#1077;&#1085;&#1090;&#1072;&#1094;&#1080;&#1103; .NET ">
    <meta name="generator" content="docfx 2.40.12.0">
    
    <link rel="shortcut icon" href="../../../favicon.ico">
    <link rel="stylesheet" href="../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../styles/main.css">
    <meta property="docfx:navrel" content="../../../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../index.html">
                <img id="logo" class="svg" src="../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="how-to-configure-iis-50-and-iis-60-to-deploy-wpf-applications">Практическое руководство. Настройка служб IIS 5.0 и IIS 6.0 для развертывания приложений WPF</h1>

<p>Приложение Windows Presentation Foundation (WPF) можно разворачивать с большинства веб-серверов при условии, что они настроены с соответствующими типами Стандарт MIME (Multipurpose Internet Mail Extensions). По умолчанию Службы Microsoft IIS 7.0 настроена с типами MIME, в отличие от Службы Microsoft IIS 5.0 и Службы Microsoft IIS 6.0.</p>
<p>В этом разделе описывается настройка Службы Microsoft IIS 5.0 и Службы Microsoft IIS 6.0 для развертывания приложений WPF.</p>
<div class="NOTE">
<h5>Note</h5>
<p>Вы можете проверить <em>UserAgent</em> строку в реестре, чтобы определить, имеет ли система установлена платформа .NET Framework. Дополнительные сведения и скрипт, проверяющий <em>UserAgent</em> строку, чтобы определить, установлена ли платформа .NET Framework в системе, см. в разделе <a href="how-to-detect-whether-the-net-framework-3-0-is-installed.html">обнаруживать ли .NET Framework 3.0 устанавливается</a>.</p>
</div>
<p><a name="content_expiration"></a></p>
<h2 id="adjust-the-content-expiration-setting">Настройка параметра срока действия содержимого</h2>
<p>Следует установить параметр срока действия содержимого на 1 минуту. В следующей процедуре показано, как это сделать с помощью IIS.</p>
<ol>
<li><p>Выберите в меню <strong>Пуск</strong> пункт <strong>Администрирование</strong> и щелкните строку <strong>Диспетчер служб IIS</strong>. Кроме этого, приложение можно запустить, набрав в командной строке &quot;%SystemRoot%\system32\inetsrv\iis.msc&quot;.</p>
</li>
<li><p>Разворачивайте дерево IIS, пока не найдете узел <strong>Веб-сайт по умолчанию</strong>.</p>
</li>
<li><p>Щелкните правой кнопкой мыши <strong>Веб-сайт по умолчанию</strong> и выберите в контекстном меню пункт <strong>Свойства</strong>.</p>
</li>
<li><p>Перейдите на вкладку <strong>Заголовки HTTP</strong> и нажмите кнопку &quot;Активировать срок действия содержимого&quot;.</p>
</li>
<li><p>Установите срок действия контента равным одной минуте.</p>
</li>
</ol>
<p><a name="register_mime_types"></a></p>
<h2 id="register-mime-types-and-file-extensions">Регистрация типов MIME и расширений файлов</h2>
<p>Вы должны зарегистрировать несколько типов MIME и расширений файлов, чтобы браузер в клиентской системе мог загрузить правильный обработчик. Необходимо добавить следующие типы.</p>
<table>
<thead>
<tr>
<th>Расширение</th>
<th>Тип MIME</th>
</tr>
</thead>
<tbody>
<tr>
<td>.manifest</td>
<td>application/manifest</td>
</tr>
<tr>
<td>.xaml</td>
<td>application/xaml+xml</td>
</tr>
<tr>
<td>.application</td>
<td>application/x-ms-application</td>
</tr>
<tr>
<td>.xbap</td>
<td>application/x-ms-xbap</td>
</tr>
<tr>
<td>.deploy</td>
<td>application/octet-stream</td>
</tr>
<tr>
<td>.xps</td>
<td>application/vnd.ms-xpsdocument</td>
</tr>
</tbody>
</table>
<div class="NOTE">
<h5>Note</h5>
<p>В клиентских системах регистрация типов MIME или расширений файлов не требуется. Они регистрируются автоматически при установке Microsoft .NET Framework.</p>
</div>
<p>В следующем примере Microsoft Visual Basic Scripting Edition (VBScript) автоматически добавляет необходимые MIME типов IIS. Чтобы использовать скрипт, скопируйте код в VBS-файл на своем сервере. Затем выполните скрипт, запустив файл из командной строки или дважды щелкнув этот файл в Проводник Microsoft Windows.</p>
<pre><code class="lang-vb">' This script adds the necessary Windows Presentation Foundation MIME types
' to an IIS Server.
' To use this script, just double-click or execute it from a command line.
' Running this script multiple times results in multiple entries in the IIS MimeMap.

Dim MimeMapObj, MimeMapArray, MimeTypesToAddArray, WshShell, oExec
Const ADS_PROPERTY_UPDATE = 2

' Set the MIME types to be added
MimeTypesToAddArray = Array(&quot;.manifest&quot;, &quot;application/manifest&quot;, &quot;.xaml&quot;, _
    &quot;application/xaml+xml&quot;, &quot;.application&quot;, &quot;application/x-ms-application&quot;, _
    &quot;.deploy&quot;, &quot;application/octet-stream&quot;, &quot;.xbap&quot;, &quot;application/x-ms-xbap&quot;, _
    &quot;.xps&quot;, &quot;application/vnd.ms-xpsdocument&quot;)

' Get the MimeMap object
Set MimeMapObj = GetObject(&quot;IIS://LocalHost/MimeMap&quot;)

' Call AddMimeType for every pair of extension/MIME type
For counter = 0 to UBound(MimeTypesToAddArray) Step 2
    AddMimeType MimeTypesToAddArray(counter), MimeTypesToAddArray(counter+1)
Next

' Create a Shell object
Set WshShell = CreateObject(&quot;WScript.Shell&quot;)

' Stop and Start the IIS Service
Set oExec = WshShell.Exec(&quot;net stop w3svc&quot;)
Do While oExec.Status = 0
    WScript.Sleep 100
Loop

Set oExec = WshShell.Exec(&quot;net start w3svc&quot;)
Do While oExec.Status = 0
    WScript.Sleep 100
Loop

Set oExec = Nothing

' Report status to user
WScript.Echo &quot;Windows Presentation Foundation MIME types have been registered.&quot;

' AddMimeType Sub
Sub AddMimeType (Ext, MType)

    ' Get the mappings from the MimeMap property.
    MimeMapArray = MimeMapObj.GetEx(&quot;MimeMap&quot;)

    ' Add a new mapping.
    i = UBound(MimeMapArray) + 1
    ReDim Preserve MimeMapArray(i)
    Set MimeMapArray(i) = CreateObject(&quot;MimeMap&quot;)
    MimeMapArray(i).Extension = Ext
    MimeMapArray(i).MimeType = MType
    MimeMapObj.PutEx ADS_PROPERTY_UPDATE, &quot;MimeMap&quot;, MimeMapArray
    MimeMapObj.SetInfo

End Sub
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>При многократном запуске скрипта создастся множество записей сопоставления MIME в метабазе Службы Microsoft IIS 5.0 или Службы Microsoft IIS 6.0.</p>
</div>
<p>После выполнения этого скрипта дополнительные типы MIME могут быть не видны из служб Службы Microsoft IIS 5.0 или Службы Microsoft IIS 6.0 Консоль управления (MMC). Однако эти типы MIME были добавлены в метабазу Службы Microsoft IIS 5.0 или Службы Microsoft IIS 6.0. Следующий скрипт отобразит все типы MIME в метабазе Службы Microsoft IIS 5.0 или Службы Microsoft IIS 6.0.</p>
<pre><code class="lang-vb">' This script lists the MIME types for an IIS Server.
' To use this script, just double-click or execute it from a command line
' by calling cscript.exe

dim mimeMapEntry, allMimeMaps

' Get the MimeMap object.
Set mimeMapEntry = GetObject(&quot;IIS://localhost/MimeMap&quot;)
allMimeMaps = mimeMapEntry.GetEx(&quot;MimeMap&quot;)

' Display the mappings in the table.
For Each mimeMap In allMimeMaps
    WScript.Echo(mimeMap.MimeType &amp; &quot; (&quot; &amp; mimeMap.Extension + &quot;)&quot;)
Next
</code></pre>
<p>Сохраните скрипт в виде файла <code>.vbs</code> (например, <code>DiscoverIISMimeTypes.vbs</code>) и запустите его из командной строки с помощью следующей команды:</p>
<pre><code class="lang-console">cscript DiscoverIISMimeTypes.vbs
</code></pre>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span><a href="https://github.com/MSDN-WhiteKnight/dotnet-docs-ru">Неофициальная документация по .NET на русском языке</a>. Лицензия: <a href="https://github.com/MSDN-WhiteKnight/dotnet-docs-ru/blob/main/LICENSE">CC-BY 4.0</a>. Основано на <a href="https://docs.microsoft.com/ru-ru/dotnet/">документации по .NET с Microsoft Docs</a><br>Generated by <strong>DocFX</strong></span><script type="text/javascript">(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(65150713, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/65150713" style="position:absolute; left:-9999px;" alt=""></div></noscript>
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>
  </body>
</html>
